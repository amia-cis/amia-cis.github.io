(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8031],{6318:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cropping-calendar",function(){return r(4298)}])},3080:function(e,n,r){"use strict";var t=r(5893),i=r(7357),a=r(8456);n.Z=function(e){var n=e.text,r=void 0===n?"":n,c=e.size,o=void 0===c?24:c,l=e.children;return(0,t.jsxs)(i.Z,{sx:{width:"100%",textAlign:"center",height:"20vh"},children:[(0,t.jsxs)(i.Z,{sx:{width:"100%",textAlign:"center",marginTop:function(e){return e.spacing(12)},marginBottom:"32px",display:"flex",justifyContent:"center"},children:[(0,t.jsx)("span",{children:""!==r?r:"Loading..."})," \xa0",(0,t.jsx)(a.Z,{size:o})]}),l]})}},4298:function(e,n,r){"use strict";r.r(n),r.d(n,{__N_SSG:function(){return S},default:function(){return E}});var t=r(4051),i=r.n(t),a=r(5893),c=r(7294),o=r(5861),l=r(8396),s=r(6295),u=r(7357),p=r(6242),d=r(480),f=r(6886),m=r(6872),x=r(2890),h=r(1903),g=r(3080),b=r(7426),v={wrapper:{marginTop:function(e){return e.spacing(8)},marginBottom:function(e){return e.spacing(12)}},autoMuni:{marginTop:function(e){return e.spacing(2)}},card:{height:{xs:"unset",md:"640px !important"},backgroundColor:"rgba(255, 255, 255, 0.8)",boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px !important",minHeight:"640px",minWidth:{xs:"200px",sm:"500px"},marginTop:function(e){return e.spacing(5)},padding:function(e){return e.spacing(2)},borderRadius:function(e){return e.spacing(1)},"& h5, h6":{marginBottom:function(e){return e.spacing(2)}}},calendar:{width:"100%",alignItems:"center","& .cropcal-cropname":{fontSize:{xs:"9px !important",sm:"12px !important",md:"unset !important"},whiteSpace:{xs:"unset",sm:"nowrap"}},"& .calendar-header-csystem":{fontSize:{xs:"12px",md:"16px"},textAlign:"center","& h6":{fontSize:{xs:"11px",sm:"unset"}}},"& .calendar-header-months":{display:"flex",fontSize:{xs:"11px",md:"1rem"},"& div":{width:"100%",textAlign:"center"},"& .monthlabels":{backgroundColor:"#092139",color:"#fff",padding:{xs:"8px 0 8px 0",sm:"8px 8px 8px 8px"}}},"& .cal-mo-container":{height:"32px",display:"flex","& div":{width:"100%",textAlign:"center"}},"& .cropCalprep":{backgroundColor:"#ffd966"},"& .cropCalgrow":{backgroundColor:"#375623"},"& .cropCalharv":{backgroundColor:"#203764"},"& .cropCalplant":{backgroundColor:"#a9d08e"},"& .cropCalnocolor, .cropCalbkank":{backgroundColor:"#f7f7ff"},cellBorderColor:{cropCalprep:"#ffd966",cropCalgrow:"#375623",cropCalharv:"#203764",cropCalplant:"#a9d08e",cropCalnocolor:"#f7f7ff",cropCalbkank:"rgba(0, 0, 0, 0.4)"}},legend:{"& ul":{listStyle:"none","& li":{marginRight:"10px",fontSize:"14px"},span:{border:"1px solid #ccc",float:"left",width:"12px",height:"12px",margin:"4px"}}},errorMsg:{fontSize:"12px"},infoMsg:{fontSize:"12px"}};function y(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function j(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){y(e,n,r[n])}))}return e}var C=function(e){var n=e.state,r=e.subcalendar,t=e.systemCropname,i=e.optsprovinces,c=e.optsmunicipalities,y=e.onSelectItemChange,C=(0,l.Z)("(max-width:600px)");return(0,a.jsxs)(p.Z,{variant:"outlined",sx:v.card,children:[(0,a.jsxs)(f.ZP,{container:!0,maxWidth:"lg",spacing:5,alignItems:"bottom",sx:{marginBottom:"48px"},children:[(0,a.jsx)(f.ZP,{item:!0,xs:12,md:4,children:(0,a.jsxs)(u.Z,{children:[(0,a.jsx)(o.Z,{variant:"h6",children:"Location Selector"}),(0,a.jsx)(s.Z,{disablePortal:!0,id:"province",size:"small",value:n.province,disabled:0===i.length||n.loading,options:i,renderInput:function(e){return(0,a.jsx)(h.Z,j({},e,{label:0===i.length?"Loading...":"Select a province"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},onChange:function(e,n){return y(e,j({},n,{from:"province"}))}}),(0,a.jsx)(s.Z,{disablePortal:!0,id:"municipality",size:"small",value:n.municipality,disabled:0===c.length||n.loading,options:c,sx:v.autoMuni,renderInput:function(e){return(0,a.jsx)(h.Z,j({},e,{label:null===n.municipality?"Select a municipality":"Municipality"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},onChange:function(e,n){return y(e,j({},n,{from:"municipality"}))}})]})}),(0,a.jsx)(f.ZP,{item:!0,xs:12,md:4,children:(0,a.jsxs)(u.Z,{children:[(0,a.jsx)(o.Z,{variant:"h6",children:"Crop Type"}),(0,a.jsxs)(x.Z,{row:!0,"aria-labelledby":"crop-calendar-croptype-selector",name:"crop-calendar-croptype-selector",children:[(0,a.jsx)(d.Z,{value:"rice",control:(0,a.jsx)(m.Z,{onClick:function(e){return y(e,{label:"Rice",from:"rice"})}}),label:"Rice",checked:"rice"===n.crop,disabled:null===n.municipality||n.loading}),(0,a.jsx)(d.Z,{value:"other_crops",control:(0,a.jsx)(m.Z,{onClick:function(e){return y(e,{label:"Other Crops",from:"other_crops"})}}),label:"Other Crops",checked:"other_crops"===n.crop,disabled:null===n.municipality||n.loading})]})]})})]}),n.loading?(0,a.jsx)(g.Z,{text:"Loading data..."}):""!==n.error?(0,a.jsx)(u.Z,{sx:v.errorMsg,children:"Error loading data."}):0===Object.keys(r).length&&null!==n.municipality&&null!==n.province?(0,a.jsx)(u.Z,{sx:v.infoMsg,children:"Data for the requested resource is not yet available."}):Object.keys(r).length>0?(0,a.jsxs)(u.Z,{children:[(0,a.jsxs)(f.ZP,{container:!0,sx:v.calendar,children:[(0,a.jsx)(f.ZP,{item:!0,xs:2,md:3,className:"calendar-header-csystem",children:(0,a.jsx)(o.Z,{variant:"subtitle1",children:(0,a.jsx)("strong",{children:"Crops"})})}),(0,a.jsx)(f.ZP,{item:!0,xs:10,md:9,className:"calendar-header-months",children:Object.values(b.re).map((function(e,n){return(0,a.jsx)(u.Z,{className:"monthlabels",children:C?(0,a.jsx)("span",{children:e.format.substring(0,1)}):(0,a.jsx)("span",{children:e.format.substring(0,3)})},"cal-mo-".concat(n))}))})]}),Object.keys(r).map((function(e,n){return(0,a.jsxs)("div",{children:[(0,a.jsxs)(f.ZP,{container:!0,sx:v.calendar,children:[(0,a.jsx)(f.ZP,{item:!0,xs:2,md:3,className:"calendar-header-csystem"}),(0,a.jsx)(f.ZP,{item:!0,xs:10,md:9,className:"calendar-header-months",children:Object.values(b.re).map((function(e,n){return(0,a.jsx)(u.Z,{className:"cal-mo-container",style:{borderRight:"1px solid rgba(0, 0, 0, 0.4)"},children:(0,a.jsx)("div",{className:"cropCalnocolor"})},"cal-mo-itm-".concat(n,"-1"))}))})]}),(0,a.jsxs)(f.ZP,{container:!0,sx:v.calendar,children:[(0,a.jsx)(f.ZP,{item:!0,xs:2,md:3,className:"calendar-header-csystem cropcal-cropname",children:void 0!==t[e]?t[e][0]:e}),(0,a.jsx)(f.ZP,{item:!0,xs:10,md:9,className:"calendar-header-months",children:Object.values(b.re).map((function(n,t){var i=r[e][n.code].length<=1?"1px solid rgba(0, 0, 0, 0.4)":"",c=v.calendar.cellBorderColor[r[e][n.code][0]],o=v.calendar.cellBorderColor[r[e][n.code][1]];return(0,a.jsxs)(u.Z,{className:"cal-mo-container",style:{borderRight:""!==i?i:o.includes("#f7f7ff")?"1px solid rgba(0, 0, 0, 0.4)":"1px solid ".concat(o)},children:[(0,a.jsx)("div",{style:{backgroundColor:c||"#f7f7ff"}}),(0,a.jsx)("div",{style:{backgroundColor:o||"#f7f7ff"}})]},"cal-mo-itm-".concat(t,"-1"))}))})]},"cal-row-".concat(n))]},"cal-row-".concat(e))})),(0,a.jsxs)(f.ZP,{container:!0,style:{marginTop:"32px"},children:[(0,a.jsx)(f.ZP,{item:!0,xs:2,md:3,className:"calendar-header-csystem"}),(0,a.jsxs)(f.ZP,{item:!0,xs:10,md:9,sx:v.legend,className:"calendar-header-months",children:[(0,a.jsx)("strong",{children:"Legend"}),(0,a.jsxs)("ul",{children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{style:{backgroundColor:"#ffd966"}}),"Land Preparation"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{style:{backgroundColor:"#a9d08e"}}),"Planting"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{style:{backgroundColor:"#375623"}}),"Growing"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{style:{backgroundColor:"#203764"}}),"Harvesting"]})]})]})]})]}):(0,a.jsx)(u.Z,{sx:v.infoMsg,children:"Please select a province and a municipality."})]})},w=r(2848);function k(e,n,r,t,i,a,c){try{var o=e[a](c),l=o.value}catch(s){return void r(s)}o.done?n(l):Promise.resolve(l).then(t,i)}function O(e){return function(){var n=this,r=arguments;return new Promise((function(t,i){var a=e.apply(n,r);function c(e){k(a,t,i,c,o,"next",e)}function o(e){k(a,t,i,c,o,"throw",e)}c(void 0)}))}}function P(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function Z(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){P(e,n,r[n])}))}return e}var _={province:null,municipality:null,crop:"rice",loading:!0,error:""};var S=!0,E=function(e){var n=(0,c.useState)(_),r=n[0],t=n[1],l=(0,c.useState)(e.provinces),s=l[0],u=(l[1],(0,c.useState)([])),p=u[0],d=u[1],f=(0,c.useState)([]),m=f[0],x=f[1],h=(0,c.useState)([]),g=h[0],v=h[1],y=(0,c.useState)([]),j=y[0],k=y[1],S=(0,c.useRef)(!1);(0,c.useEffect)((function(){return S.current=!0,function(){S.current=!1}}),[]),(0,c.useEffect)((function(){var n=function(){var n=O(i().mark((function n(){var r,a;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=[];try{r=e.municipalitliesList.filter((function(e){return e.province===s[2].label})).map((function(e){return{id:e.id,name:e.name}})),S.current&&d((function(e){return r.map((function(e){return{id:e.id,label:e.name}}))}))}catch(i){t((function(e){return Z({},e,{loading:!1,error:i.message})}))}if(!(r.length>0)){n.next=13;break}return n.prev=3,n.next=6,(0,w.OP)(s[2].label,r[0].name);case 6:a=n.sent,S.current&&(t((function(e){return Z({},e,{loading:!1,province:s[2],municipality:{id:r[0].id,label:r[0].name}})})),x((function(e){return a}))),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(3),t((function(e){return Z({},e,{loading:!1,error:n.t0.message})}));case 13:case"end":return n.stop()}}),n,null,[[3,10]])})));return function(){return n.apply(this,arguments)}}();n()}),[s,e.municipalitliesList]),(0,c.useEffect)((function(){m.length>0&&E(null,{label:"Rice",from:"rice"})}),[m]);var E=function(){var n=O(i().mark((function n(a,c){var o,l,s,u,p,f,h,g,y;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=c.label,l=c.from,["rice","other_crops"].includes(l)||x([]),void 0===o){n.next=33;break}n.t0=l,n.next="province"===n.t0?6:"municipality"===n.t0?8:"rice"===n.t0||"other_crops"===n.t0?21:30;break;case 6:try{t(Z({},r,(P(s={loading:!0},l,c),P(s,"municipality",null),s))),v([]),u=e.municipalitliesList.filter((function(e){return e.province===o})).map((function(e){return{id:e.id,label:e.name}})),S.current&&(t((function(e){return Z({},e,{loading:!1})})),d((function(e){return u})))}catch(i){t(Z({},r,{loading:!1,error:i.message}))}return n.abrupt("break",31);case 8:return n.prev=8,t(Z({},r,P({loading:!0},l,c))),v([]),n.next=13,(0,w.OP)(r.province.label,o);case 13:p=n.sent,S.current&&(t((function(e){return Z({},e,{loading:!1})})),x((function(e){return p}))),n.next=20;break;case 17:n.prev=17,n.t1=n.catch(8),t(Z({},r,{loading:!1,error:n.t1.message}));case 20:return n.abrupt("break",31);case 21:return t((function(e){return Z({},e,{crop:l})})),f="rice"===l?["Rainfed Rice","Irrigated Rice","Rice"]:["Cassava","Lowland Vegetable","Corn"],h=m.filter((function(e){return e.province===r.province.label&&e.municipality===r.municipality.label&&f.includes(e.crop)})),g=h.reduce((function(e,n){var r=Object.values(b.re).reduce((function(e,r){var t=""===n[r.code]?[]:2===n[r.code].split(",").length?n[r.code].split(",").map((function(e){return"cropCal".concat(e.length>0?e:"nocolor")})):["cropCal".concat(n[r.code]),"cropCal".concat(n[r.code])];return Z({},e,P({},r.code,t))}),{});return void 0!==e[n.cropping_system]&&Object.values(b.re).forEach((function(t){var i=t.code;e[n.cropping_system][i].every((function(e){return r[i].includes(e)}))||e[n.cropping_system][i].filter((function(e){return!r[i].includes(e)})).forEach((function(e){r[i].push(e)}))})),Z({},e,P({},n.cropping_system,r))}),{}),y={},h.forEach((function(e){void 0===y[e.cropping_system]&&(y[e.cropping_system]=[]),y[e.cropping_system].includes(e.crop)||y[e.cropping_system].push(e.crop)})),k(y),v(g),n.abrupt("break",31);case 30:return n.abrupt("break",31);case 31:n.next=44;break;case 33:n.t2=l,n.next="province"===n.t2?36:"municipality"===n.t2?40:43;break;case 36:return t(Z({},r,{province:null,municipality:null})),d([]),v([]),n.abrupt("break",44);case 40:return t(Z({},r,{municipality:null})),v([]),n.abrupt("break",44);case 43:return n.abrupt("break",44);case 44:case"end":return n.stop()}}),n,null,[[8,17]])})));return function(e,r){return n.apply(this,arguments)}}();return(0,a.jsxs)("div",{id:"bacap-cropping-calendar",children:[(0,a.jsx)(o.Z,{variant:"h4",children:"Cropping Calendar"}),(0,a.jsx)(o.Z,{variant:"label",children:"Cropping Calendar page"}),(0,a.jsx)(C,{state:r,subcalendar:g,systemCropname:j,optsprovinces:s,optsmunicipalities:p,optscroptsURL:e.downloadurl,onSelectItemChange:E})]})}},2848:function(e,n,r){"use strict";r.d(n,{OP:function(){return j}});var t=r(4051),i=r.n(t),a=r(4763);function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o(e,n,r,t,i,a,c){try{var o=e[a](c),l=o.value}catch(s){return void r(s)}o.done?n(l):Promise.resolve(l).then(t,i)}function l(e){return function(){var n=this,r=arguments;return new Promise((function(t,i){var a=e.apply(n,r);function c(e){o(a,t,i,c,l,"next",e)}function l(e){o(a,t,i,c,l,"throw",e)}c(void 0)}))}}function s(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function u(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function d(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){u(e,n,r[n])}))}return e}function f(e,n){return!n||"object"!==x(n)&&"function"!==typeof n?c(e):n}function m(e,n){return m=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},m(e,n)}var x=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function h(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,t=p(e);if(n){var i=p(this).constructor;r=Reflect.construct(t,arguments,i)}else r=t.apply(this,arguments);return f(this,r)}}var g="misc_crop_calendars",b="n_cropping_calendar_merged",v=function(e){!function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&m(e,n)}(r,e);var n=h(r);function r(){var e;s(this,r);var t=c(e=n.apply(this,arguments));u(c(e),"getCropCalendarsHi",l(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getCollectionData(g,"filename");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));var a=c(e);u(c(e),"getCroppingCalendarMerged",l(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getCollectionData(b,"id");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));var o=c(e);return u(c(e),"getCroppingCalendarSimplified",function(){var e=l(i().mark((function e(n,r){var t,a,c,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==n&&void 0!==r){e.next=2;break}return e.abrupt("return");case 2:return t=o.collection(o.db,b),a=o.query(t,o.where("province","==",n),o.where("municipality","==",r)),e.next=6,o.getDocs(a);case 6:return c=e.sent,l=c.docs.map((function(e){return d({},e.data())})),e.abrupt("return",l);case 9:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}()),e}return r}(a.Z),y=new v,j=(y.getCropCalendarsHi.bind(y),y.getCroppingCalendarMerged.bind(y),y.getCroppingCalendarSimplified.bind(y))}},function(e){e.O(0,[9969,9774,2888,179],(function(){return n=6318,e(e.s=n);var n}));var n=e.O();_N_E=n}]);
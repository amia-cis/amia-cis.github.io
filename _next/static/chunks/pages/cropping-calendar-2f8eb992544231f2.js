(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8031],{6318:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cropping-calendar",function(){return r(4298)}])},1033:function(e,n,r){"use strict";r.d(n,{Z:function(){return s}});var t=r(5893),i=r(5675),a=r(7357),c=r(5861),o=r(120),l={container:{textAlign:"center",minHeight:"200px",width:"100%",border:"4px solid rgba(0, 0, 0, 0.11)",borderRadius:function(e){return e.spacing(2)},color:function(e){return e.palette.text.secondary},borderStyle:"dashed",padding:function(e){return e.spacing(2)},marginTop:function(e){return e.spacing(4)}}};var s=function(e){var n=e.message,r=void 0===n?"Failed to load data":n,s=e.style,u=void 0===s?{}:s;return(0,t.jsxs)(a.Z,{sx:l.container,style:u,children:[(0,t.jsx)(i.default,{unoptimized:!0,src:(0,o.assetPrefixer)("images/icons/empty-state-light.svg"),height:120,width:120,loader:o.imageLoader,alt:"Empty data"}),(0,t.jsx)(c.Z,{variant:"subtitle1",children:r})]})}},3080:function(e,n,r){"use strict";var t=r(5893),i=r(7357),a=r(8456);n.Z=function(e){var n=e.text,r=void 0===n?"":n,c=e.size,o=void 0===c?24:c,l=e.children;return(0,t.jsxs)(i.Z,{sx:{width:"100%",textAlign:"center",height:"20vh"},children:[(0,t.jsxs)(i.Z,{sx:{width:"100%",textAlign:"center",marginTop:function(e){return e.spacing(12)},marginBottom:"32px",display:"flex",justifyContent:"center"},children:[(0,t.jsx)("span",{children:""!==r?r:"Loading..."})," \xa0",(0,t.jsx)(a.Z,{size:o})]}),l]})}},4298:function(e,n,r){"use strict";r.r(n),r.d(n,{__N_SSG:function(){return A},default:function(){return B}});var t=r(4051),i=r.n(t),a=r(5893),c=r(7294),o=r(9473),l=r(4822),s=r(3549),u=r(3691),p=r(5635),d=r(901),f=r(5861),m=r(8396),x=r(6295),h=r(7357),g=r(6242),b=r(1033),v=r(480),y=r(6886),j=r(6872),C=r(2890),w=r(1903),O=r(3080),k=r(7426),Z={wrapper:{marginTop:function(e){return e.spacing(8)},marginBottom:function(e){return e.spacing(12)}},autoMuni:{marginTop:function(e){return e.spacing(2)}},card:{height:{xs:"unset",md:"640px !important"},backgroundColor:"rgba(255, 255, 255, 0.8)",boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px !important",minHeight:"640px",minWidth:{xs:"200px",sm:"500px"},marginTop:function(e){return e.spacing(5)},padding:function(e){return e.spacing(2)},borderRadius:function(e){return e.spacing(1)},"& h5, h6":{marginBottom:function(e){return e.spacing(2)}}},calendar:{width:"100%",alignItems:"center","& .cropcal-cropname":{fontSize:{xs:"9px !important",sm:"12px !important",md:"unset !important"},whiteSpace:{xs:"unset",sm:"nowrap"}},"& .calendar-header-csystem":{fontSize:{xs:"12px",md:"16px"},textAlign:"center","& h6":{fontSize:{xs:"11px",sm:"unset"}}},"& .calendar-header-months":{display:"flex",fontSize:{xs:"11px",md:"1rem"},"& div":{width:"100%",textAlign:"center"},"& .monthlabels":{backgroundColor:"#092139",color:"#fff",padding:{xs:"8px 0 8px 0",sm:"8px 8px 8px 8px"}}},"& .cal-mo-container":{height:"32px",display:"flex","& div":{width:"100%",textAlign:"center"}},"& .cropCalprep":{backgroundColor:"#ffd966"},"& .cropCalgrow":{backgroundColor:"#375623"},"& .cropCalharv":{backgroundColor:"#203764"},"& .cropCalplant":{backgroundColor:"#a9d08e"},"& .cropCalnocolor, .cropCalbkank":{backgroundColor:"#f7f7ff"},cellBorderColor:{cropCalprep:"#ffd966",cropCalgrow:"#375623",cropCalharv:"#203764",cropCalplant:"#a9d08e",cropCalnocolor:"#f7f7ff",cropCalbkank:"rgba(0, 0, 0, 0.4)"}},legend:{"& ul":{listStyle:"none","& li":{marginRight:"10px",fontSize:"14px"},span:{border:"1px solid #ccc",float:"left",width:"12px",height:"12px",margin:"4px"}}},errorMsg:{fontSize:"12px"},infoMsg:{fontSize:"12px"}};function P(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function _(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){P(e,n,r[n])}))}return e}var S=function(e){var n=e.state,r=e.subcalendar,t=e.systemCropname,i=e.withcalendar,l=e.onSelectItemChange,s=(0,m.Z)("(max-width:600px)"),u=(0,o.v9)((function(e){return e.provinces})),p=(0,o.v9)((function(e){return e.municipalities})),d=(0,c.useState)(!1),P=d[0],S=d[1];return(0,c.useEffect)((function(){""===u.error&&""===p.error&&""===n.error||S(!0)}),[u,p,n.error]),(0,a.jsxs)(g.Z,{variant:"outlined",sx:Z.card,children:[(0,a.jsxs)(y.ZP,{container:!0,maxWidth:"lg",spacing:5,alignItems:"bottom",sx:{marginBottom:"48px"},children:[(0,a.jsx)(y.ZP,{item:!0,xs:12,md:4,children:(0,a.jsxs)(h.Z,{children:[(0,a.jsx)(f.Z,{variant:"h6",children:"Location Selector"}),(0,a.jsx)(x.Z,{disablePortal:!0,id:"province",size:"small",value:u.province,disabled:0===u.ids||n.loading,options:Object.values(u.entities),renderInput:function(e){return(0,a.jsx)(w.Z,_({},e,{label:0===u.ids.length?"Loading...":"Select a province"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},onChange:function(e,n){return l(e,_({},n,{from:"province"}))}}),(0,a.jsx)(x.Z,{disablePortal:!0,id:"municipality",size:"small",value:p.municipality,disabled:0===p.ids.length||n.loading,options:Object.values(p.entities),getOptionDisabled:function(e){return!i.includes(e.label)},sx:Z.autoMuni,renderInput:function(e){return(0,a.jsx)(w.Z,_({},e,{label:null===p.municipality?"Select a municipality":"Municipality"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},onChange:function(e,n){return l(e,_({},n,{from:"municipality"}))}})]})}),(0,a.jsx)(y.ZP,{item:!0,xs:12,md:4,children:(0,a.jsxs)(h.Z,{children:[(0,a.jsx)(f.Z,{variant:"h6",children:"Crop Type"}),(0,a.jsxs)(C.Z,{row:!0,"aria-labelledby":"crop-calendar-croptype-selector",name:"crop-calendar-croptype-selector",children:[(0,a.jsx)(v.Z,{value:"rice",control:(0,a.jsx)(j.Z,{onClick:function(e){return l(e,{label:"Rice",from:"rice"})}}),label:"Rice",checked:"rice"===n.crop,disabled:null===n.municipality||n.loading}),(0,a.jsx)(v.Z,{value:"other_crops",control:(0,a.jsx)(j.Z,{onClick:function(e){return l(e,{label:"Other Crops",from:"other_crops"})}}),label:"Other Crops",checked:"other_crops"===n.crop,disabled:null===n.municipality||n.loading})]})]})})]}),n.loading&&!P?(0,a.jsx)(O.Z,{text:"Loading data..."}):P?(0,a.jsx)(b.Z,{message:"Error loading data."}):0===Object.keys(r).length&&null!==p.municipality&&null!==u.province?(0,a.jsx)(h.Z,{sx:Z.infoMsg,children:"Data for the requested resource is not yet available."}):Object.keys(r).length>0?(0,a.jsxs)(h.Z,{children:[(0,a.jsxs)(y.ZP,{container:!0,sx:Z.calendar,children:[(0,a.jsx)(y.ZP,{item:!0,xs:2,md:3,className:"calendar-header-csystem",children:(0,a.jsx)(f.Z,{variant:"subtitle1",children:(0,a.jsx)("strong",{children:"Crops"})})}),(0,a.jsx)(y.ZP,{item:!0,xs:10,md:9,className:"calendar-header-months",children:Object.values(k.re).map((function(e,n){return(0,a.jsx)(h.Z,{className:"monthlabels",children:s?(0,a.jsx)("span",{children:e.format.substring(0,1)}):(0,a.jsx)("span",{children:e.format.substring(0,3)})},"cal-mo-".concat(n))}))})]}),Object.keys(r).map((function(e,n){return(0,a.jsxs)("div",{children:[(0,a.jsxs)(y.ZP,{container:!0,sx:Z.calendar,children:[(0,a.jsx)(y.ZP,{item:!0,xs:2,md:3,className:"calendar-header-csystem"}),(0,a.jsx)(y.ZP,{item:!0,xs:10,md:9,className:"calendar-header-months",children:Object.values(k.re).map((function(e,n){return(0,a.jsx)(h.Z,{className:"cal-mo-container",style:{borderRight:"1px solid rgba(0, 0, 0, 0.4)"},children:(0,a.jsx)("div",{className:"cropCalnocolor"})},"cal-mo-itm-".concat(n,"-1"))}))})]}),(0,a.jsxs)(y.ZP,{container:!0,sx:Z.calendar,children:[(0,a.jsx)(y.ZP,{item:!0,xs:2,md:3,className:"calendar-header-csystem cropcal-cropname",children:void 0!==t[e]?t[e][0]:e}),(0,a.jsx)(y.ZP,{item:!0,xs:10,md:9,className:"calendar-header-months",children:Object.values(k.re).map((function(n,t){var i=r[e][n.code].length<=1?"1px solid rgba(0, 0, 0, 0.4)":"",c=Z.calendar.cellBorderColor[r[e][n.code][0]],o=Z.calendar.cellBorderColor[r[e][n.code][1]];return(0,a.jsxs)(h.Z,{className:"cal-mo-container",style:{borderRight:""!==i?i:o.includes("#f7f7ff")?"1px solid rgba(0, 0, 0, 0.4)":"1px solid ".concat(o)},children:[(0,a.jsx)("div",{style:{backgroundColor:c||"#f7f7ff"}}),(0,a.jsx)("div",{style:{backgroundColor:o||"#f7f7ff"}})]},"cal-mo-itm-".concat(t,"-1"))}))})]},"cal-row-".concat(n))]},"cal-row-".concat(e))})),(0,a.jsxs)(y.ZP,{container:!0,style:{marginTop:"32px"},children:[(0,a.jsx)(y.ZP,{item:!0,xs:2,md:3,className:"calendar-header-csystem"}),(0,a.jsxs)(y.ZP,{item:!0,xs:10,md:9,sx:Z.legend,className:"calendar-header-months",children:[(0,a.jsx)("strong",{children:"Legend"}),(0,a.jsxs)("ul",{children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{style:{backgroundColor:"#ffd966"}}),"Land Preparation"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{style:{backgroundColor:"#a9d08e"}}),"Planting"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{style:{backgroundColor:"#375623"}}),"Growing"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{style:{backgroundColor:"#203764"}}),"Harvesting"]})]})]})]})]}):(0,a.jsx)(h.Z,{sx:Z.infoMsg,children:"Please select a province and a municipality."})]})},E=r(2848);function R(e,n,r,t,i,a,c){try{var o=e[a](c),l=o.value}catch(s){return void r(s)}o.done?n(l):Promise.resolve(l).then(t,i)}function L(e){return function(){var n=this,r=arguments;return new Promise((function(t,i){var a=e.apply(n,r);function c(e){R(a,t,i,c,o,"next",e)}function o(e){R(a,t,i,c,o,"throw",e)}c(void 0)}))}}function N(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function T(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){N(e,n,r[n])}))}return e}var z={crop:"rice",loading:!0,error:""};var A=!0,B=function(e){var n=(0,c.useState)(z),r=n[0],t=n[1],m=(0,c.useState)([]),x=m[0],h=m[1],g=(0,c.useState)([]),b=g[0],v=g[1],y=(0,c.useState)([]),j=y[0],C=y[1],w=(0,o.v9)((function(e){return e.provinces})),O=w.ids,Z=w.entities,P=w.province,_=(0,o.v9)((function(e){return e.municipalities})),R=_.status,A=_.municipality,B=(0,o.I0)(),D=(0,c.useRef)(!1);(0,c.useEffect)((function(){return function(){D.current=!1}}),[]),(0,c.useEffect)((function(){0===O.length?(D.current=!0,B((0,l.Q)())):(B((0,s.Wn)({id:1,label:"Camarines Sur"})),B((0,p.q)("Camarines Sur")).unwrap().then((function(){D.current=!0;var n=e.municipalitliesLite.find((function(e){return"Camarines Sur"===e.province}));B((0,u.QA)({id:n.id,label:n.name}))})))}),[B,O.length,Z,e.municipalitliesLite]),(0,c.useEffect)((function(){var n=function(){var n=L(i().mark((function n(){var r;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(R!==d.G.FULLFILLED||null===A||!D.current){n.next=13;break}if(e.municipalitliesLite.map((function(e){return e.name})).includes(A.label)){n.next=3;break}return n.abrupt("return");case 3:return n.prev=3,n.next=6,(0,E.OP)(P.label,A.label);case 6:r=n.sent,D.current&&(t((function(e){return T({},e,{loading:!1})})),h((function(e){return r}))),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(3),t((function(e){return T({},e,{loading:!1,error:n.t0.message})}));case 13:case"end":return n.stop()}}),n,null,[[3,10]])})));return function(){return n.apply(this,arguments)}}();n()}),[R,A,e.municipalitliesLite,P]),(0,c.useEffect)((function(){x.length>0&&I(null,{label:"Rice",from:"rice"})}),[x]);var I=function(){var n=L(i().mark((function n(a,c){var o,l,d,f,m,g;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=c.label,l=c.from,["rice","other_crops"].includes(l)||h([]),void 0===o){n.next=24;break}n.t0=l,n.next="province"===n.t0?6:"municipality"===n.t0?8:"rice"===n.t0||"other_crops"===n.t0?12:21;break;case 6:try{t(T({},r,{loading:!0})),B((0,s.Wn)(c)),B((0,p.q)(c.label)).unwrap().then((function(){var n=e.municipalitliesLite.find((function(e){return e.province===c.label}));B((0,u.QA)({id:n.id,label:n.name}))})),v([])}catch(i){t(T({},r,{loading:!1,error:i.message}))}return n.abrupt("break",22);case 8:return t(T({},r,{loading:!0})),B((0,u.QA)(c)),v([]),n.abrupt("break",22);case 12:return t((function(e){return T({},e,{crop:l})})),d="rice"===l?["Rainfed Rice","Irrigated Rice","Rice"]:["Cassava","Lowland Vegetable","Corn"],f=x.filter((function(e){return e.province===P.label&&e.municipality===A.label&&d.includes(e.crop)})),m=f.reduce((function(e,n){var r=Object.values(k.re).reduce((function(e,r){var t=""===n[r.code]?[]:2===n[r.code].split(",").length?n[r.code].split(",").map((function(e){return"cropCal".concat(e.length>0?e:"nocolor")})):["cropCal".concat(n[r.code]),"cropCal".concat(n[r.code])];return T({},e,N({},r.code,t))}),{});return void 0!==e[n.cropping_system]&&Object.values(k.re).forEach((function(t){var i=t.code;e[n.cropping_system][i].every((function(e){return r[i].includes(e)}))||e[n.cropping_system][i].filter((function(e){return!r[i].includes(e)})).forEach((function(e){r[i].push(e)}))})),T({},e,N({},n.cropping_system,r))}),{}),g={},f.forEach((function(e){void 0===g[e.cropping_system]&&(g[e.cropping_system]=[]),g[e.cropping_system].includes(e.crop)||g[e.cropping_system].push(e.crop)})),C(g),v(m),n.abrupt("break",22);case 21:return n.abrupt("break",22);case 22:n.next=34;break;case 24:n.t1=l,n.next="province"===n.t1?27:"municipality"===n.t1?30:33;break;case 27:return t(T({},r,{province:null,municipality:null})),v([]),n.abrupt("break",34);case 30:return t(T({},r,{municipality:null})),v([]),n.abrupt("break",34);case 33:return n.abrupt("break",34);case 34:case"end":return n.stop()}}),n)})));return function(e,r){return n.apply(this,arguments)}}();return(0,a.jsxs)("div",{id:"bacap-cropping-calendar",children:[(0,a.jsx)(f.Z,{variant:"h4",children:"Cropping Calendar"}),(0,a.jsx)(f.Z,{variant:"label",children:"Cropping Calendar page"}),(0,a.jsx)(S,{state:r,subcalendar:b,systemCropname:j,withcalendar:e.municipalitliesLite.map((function(e){return e.name})),onSelectItemChange:I})]})}},2848:function(e,n,r){"use strict";r.d(n,{OP:function(){return j}});var t=r(4051),i=r.n(t),a=r(4763);function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o(e,n,r,t,i,a,c){try{var o=e[a](c),l=o.value}catch(s){return void r(s)}o.done?n(l):Promise.resolve(l).then(t,i)}function l(e){return function(){var n=this,r=arguments;return new Promise((function(t,i){var a=e.apply(n,r);function c(e){o(a,t,i,c,l,"next",e)}function l(e){o(a,t,i,c,l,"throw",e)}c(void 0)}))}}function s(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function u(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function d(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){u(e,n,r[n])}))}return e}function f(e,n){return!n||"object"!==x(n)&&"function"!==typeof n?c(e):n}function m(e,n){return m=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},m(e,n)}var x=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function h(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,t=p(e);if(n){var i=p(this).constructor;r=Reflect.construct(t,arguments,i)}else r=t.apply(this,arguments);return f(this,r)}}var g="misc_crop_calendars",b="n_cropping_calendar_merged",v=function(e){!function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&m(e,n)}(r,e);var n=h(r);function r(){var e;s(this,r);var t=c(e=n.apply(this,arguments));u(c(e),"getCropCalendarsHi",l(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getCollectionData(g,"filename");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));var a=c(e);u(c(e),"getCroppingCalendarMerged",l(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getCollectionData(b,"id");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));var o=c(e);return u(c(e),"getCroppingCalendarSimplified",function(){var e=l(i().mark((function e(n,r){var t,a,c,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==n&&void 0!==r){e.next=2;break}return e.abrupt("return");case 2:return t=o.collection(o.db,b),a=o.query(t,o.where("province","==",n),o.where("municipality","==",r)),e.next=6,o.getDocs(a);case 6:return c=e.sent,l=c.docs.map((function(e){return d({},e.data())})),e.abrupt("return",l);case 9:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}()),e}return r}(a.Z),y=new v,j=(y.getCropCalendarsHi.bind(y),y.getCroppingCalendarMerged.bind(y),y.getCroppingCalendarSimplified.bind(y))}},function(e){e.O(0,[9969,9774,2888,179],(function(){return n=6318,e(e.s=n);var n}));var n=e.O();_N_E=n}]);
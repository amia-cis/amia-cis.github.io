(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[31],{6318:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cropping-calendar",function(){return r(4298)}])},3080:function(e,n,r){"use strict";var t=r(5893),i=r(7357),o=r(8456);n.Z=function(e){var n=e.text,r=void 0===n?"":n,a=e.size,c=void 0===a?24:a,l=e.children;return(0,t.jsxs)(i.Z,{sx:{width:"100%",textAlign:"center",height:"20vh"},children:[(0,t.jsxs)(i.Z,{sx:{width:"100%",textAlign:"center",marginTop:function(e){return e.spacing(12)},marginBottom:"32px",display:"flex",justifyContent:"center"},children:[(0,t.jsx)("span",{children:""!==r?r:"Loading..."})," \xa0",(0,t.jsx)(o.Z,{size:c})]}),l]})}},4298:function(e,n,r){"use strict";r.r(n),r.d(n,{__N_SSG:function(){return _},default:function(){return S}});var t=r(4051),i=r.n(t),o=r(5893),a=r(7294),c=r(5861),l=r(6295),s=r(7357),u=r(6242),p=r(480),d=r(6886),f=r(6872),m=r(2890),g=r(1903),h=r(3080),x=r(7426),b={wrapper:{marginTop:function(e){return e.spacing(8)},marginBottom:function(e){return e.spacing(12)}},container:{maxWidth:"900px",margin:"auto",marginTop:function(e){return e.spacing(8)}},tabsContainer:{borderBottom:1,borderColor:"divider",marginBottom:function(e){return e.spacing(5)}},autocomplete:{maxWidth:"100%",marginTop:function(e){return e.spacing(1)}},autoMuni:{marginTop:function(e){return e.spacing(2)}},card:{height:"640px !important",backgroundColor:"rgba(255, 255, 255, 0.8)",boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px !important",minHeight:"390px",minWidth:{xs:"200px",sm:"500px"},marginTop:function(e){return e.spacing(5)},padding:function(e){return e.spacing(2)},borderRadius:function(e){return e.spacing(1)},"& h5, h6":{marginBottom:function(e){return e.spacing(2)}}},calendar:{width:"100%",alignItems:"center","& .calendar-header-csystem":{fontSize:{xs:"12px",md:"16px"},textAlign:"center"},"& .calendar-header-months":{display:"flex","& div":{width:"100%",textAlign:"center"}},"& .cal-mo-container":{height:"32px",display:"flex","& div":{width:"100%",textAlign:"center"}},"& .cropCalprep":{backgroundColor:"#ffd966"},"& .cropCalgrow":{backgroundColor:"#375623"},"& .cropCalharv":{backgroundColor:"#203764"},"& .cropCalplant":{backgroundColor:"#a9d08e"},"& .cropCalnocolor, .cropCalbkank":{backgroundColor:"#f7f7ff"},cellBorderColor:{cropCalprep:"#ffd966",cropCalgrow:"#375623",cropCalharv:"#203764",cropCalplant:"#a9d08e",cropCalnocolor:"#f7f7ff",cropCalbkank:"rgba(0, 0, 0, 0.4)"}},legend:{"& ul":{listStyle:"none","& li":{marginRight:"10px",fontSize:"14px"},span:{border:"1px solid #ccc",float:"left",width:"12px",height:"12px",margin:"4px"}}},errorMsg:{fontSize:"12px",color:"red"},infoMsg:{fontSize:"12px"}};function v(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function y(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){v(e,n,r[n])}))}return e}var j=function(e){var n=e.state,r=e.subcalendar,t=e.systemCropname,i=e.optsprovinces,a=e.optsmunicipalities,v=e.onSelectItemChange;return(0,o.jsxs)(u.Z,{variant:"outlined",sx:b.card,children:[(0,o.jsxs)(d.ZP,{container:!0,maxWidth:"lg",spacing:5,alignItems:"bottom",sx:{marginBottom:"48px"},children:[(0,o.jsx)(d.ZP,{item:!0,xs:12,md:4,children:(0,o.jsxs)(s.Z,{children:[(0,o.jsx)(c.Z,{variant:"h6",children:"Location Selector"}),(0,o.jsx)(l.Z,{disablePortal:!0,id:"province",size:"small",value:n.province,disabled:0===i.length||n.loading,options:i,renderInput:function(e){return(0,o.jsx)(g.Z,y({},e,{label:0===i.length?"Loading...":"Select a province"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},onChange:function(e,n){return v(e,y({},n,{from:"province"}))}}),(0,o.jsx)(l.Z,{disablePortal:!0,id:"municipality",size:"small",value:n.municipality,disabled:0===a.length||n.loading,options:a,sx:b.autoMuni,renderInput:function(e){return(0,o.jsx)(g.Z,y({},e,{label:null===n.municipality?"Select a municipality":"Municipality"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},onChange:function(e,n){return v(e,y({},n,{from:"municipality"}))}})]})}),(0,o.jsx)(d.ZP,{item:!0,xs:12,md:4,children:(0,o.jsxs)(s.Z,{children:[(0,o.jsx)(c.Z,{variant:"h6",children:"Crop Type"}),(0,o.jsxs)(m.Z,{row:!0,"aria-labelledby":"crop-calendar-croptype-selector",name:"crop-calendar-croptype-selector",children:[(0,o.jsx)(p.Z,{value:"rice",control:(0,o.jsx)(f.Z,{onClick:function(e){return v(e,{label:"Rice",from:"rice"})}}),label:"Rice",checked:"rice"===n.crop,disabled:null===n.municipality||n.loading}),(0,o.jsx)(p.Z,{value:"other_crops",control:(0,o.jsx)(f.Z,{onClick:function(e){return v(e,{label:"Other Crops",from:"other_crops"})}}),label:"Other Crops",checked:"other_crops"===n.crop,disabled:null===n.municipality||n.loading})]})]})})]}),n.loading?(0,o.jsx)(h.Z,{text:"Loading data..."}):""!==n.error?(0,o.jsx)(s.Z,{sx:b.errorMsg,children:"Error loading data."}):0===Object.keys(r).length&&null!==n.municipality&&null!==n.province?(0,o.jsx)(s.Z,{sx:b.infoMsg,children:"Data for the requested resource is not yet available."}):Object.keys(r).length>0?(0,o.jsxs)(s.Z,{children:[(0,o.jsxs)(d.ZP,{container:!0,sx:b.calendar,children:[(0,o.jsx)(d.ZP,{item:!0,xs:3,className:"calendar-header-csystem",children:(0,o.jsx)(c.Z,{variant:"subtitle1",children:(0,o.jsx)("strong",{children:"Crops"})})}),(0,o.jsx)(d.ZP,{item:!0,xs:9,className:"calendar-header-months",children:Object.values(x.re).map((function(e,n){return(0,o.jsx)(s.Z,{sx:{backgroundColor:"#092139",color:"#fff",padding:"8px"},children:e.format.substring(0,3)},"cal-mo-".concat(n))}))})]}),Object.keys(r).map((function(e,n){return(0,o.jsxs)("div",{children:[(0,o.jsxs)(d.ZP,{container:!0,sx:b.calendar,children:[(0,o.jsx)(d.ZP,{item:!0,xs:3,className:"calendar-header-csystem"}),(0,o.jsx)(d.ZP,{item:!0,xs:9,className:"calendar-header-months",children:Object.values(x.re).map((function(e,n){return(0,o.jsx)(s.Z,{className:"cal-mo-container",style:{borderRight:"1px solid rgba(0, 0, 0, 0.4)"},children:(0,o.jsx)("div",{className:"cropCalnocolor"})},"cal-mo-itm-".concat(n,"-1"))}))})]}),(0,o.jsxs)(d.ZP,{container:!0,sx:b.calendar,children:[(0,o.jsx)(d.ZP,{item:!0,xs:3,className:"calendar-header-csystem",children:void 0!==t[e]?t[e][0]:e}),(0,o.jsx)(d.ZP,{item:!0,xs:9,className:"calendar-header-months",children:Object.values(x.re).map((function(n,t){var i=r[e][n.code].length<=1?"1px solid rgba(0, 0, 0, 0.4)":"",a=b.calendar.cellBorderColor[r[e][n.code][0]],c=b.calendar.cellBorderColor[r[e][n.code][1]];return(0,o.jsxs)(s.Z,{className:"cal-mo-container",style:{borderRight:""!==i?i:c.includes("#f7f7ff")?"1px solid rgba(0, 0, 0, 0.4)":"1px solid ".concat(c)},children:[(0,o.jsx)("div",{style:{backgroundColor:a||"#f7f7ff"}}),(0,o.jsx)("div",{style:{backgroundColor:c||"#f7f7ff"}})]},"cal-mo-itm-".concat(t,"-1"))}))})]},"cal-row-".concat(n))]},"cal-row-".concat(e))})),(0,o.jsxs)(d.ZP,{container:!0,style:{marginTop:"32px"},children:[(0,o.jsx)(d.ZP,{item:!0,xs:3,className:"calendar-header-csystem"}),(0,o.jsxs)(d.ZP,{item:!0,xs:9,sx:b.legend,className:"calendar-header-months",children:[(0,o.jsx)("strong",{children:"Legend"}),(0,o.jsxs)("ul",{children:[(0,o.jsxs)("li",{children:[(0,o.jsx)("span",{style:{backgroundColor:"#ffd966"}}),"Land Preparation"]}),(0,o.jsxs)("li",{children:[(0,o.jsx)("span",{style:{backgroundColor:"#a9d08e"}}),"Planting"]}),(0,o.jsxs)("li",{children:[(0,o.jsx)("span",{style:{backgroundColor:"#375623"}}),"Growing"]}),(0,o.jsxs)("li",{children:[(0,o.jsx)("span",{style:{backgroundColor:"#203764"}}),"Harvesting"]})]})]})]})]}):(0,o.jsx)(s.Z,{sx:b.infoMsg,children:"Please select a province and a municipality."})]})},C=r(2848);function w(e,n,r,t,i,o,a){try{var c=e[o](a),l=c.value}catch(s){return void r(s)}c.done?n(l):Promise.resolve(l).then(t,i)}function k(e){return function(){var n=this,r=arguments;return new Promise((function(t,i){var o=e.apply(n,r);function a(e){w(o,t,i,a,c,"next",e)}function c(e){w(o,t,i,a,c,"throw",e)}a(void 0)}))}}function O(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function P(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){O(e,n,r[n])}))}return e}var Z={province:null,municipality:null,crop:"rice",loading:!0,error:""};var _=!0,S=function(e){var n=(0,a.useState)(Z),r=n[0],t=n[1],l=(0,a.useState)(e.provinces),s=l[0],u=(l[1],(0,a.useState)([])),p=u[0],d=u[1],f=(0,a.useState)([]),m=f[0],g=f[1],h=(0,a.useState)([]),b=h[0],v=h[1],y=(0,a.useState)([]),w=y[0],_=y[1],S=(0,a.useRef)(!1);(0,a.useEffect)((function(){return S.current=!0,function(){S.current=!1}}),[]),(0,a.useEffect)((function(){var n=function(){var n=k(i().mark((function n(){var r,o;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=[];try{r=e.municipalitliesList.filter((function(e){return e.province===s[2].label})).map((function(e){return{id:e.id,name:e.name}})),S.current&&d((function(e){return r.map((function(e){return{id:e.id,label:e.name}}))}))}catch(i){t((function(e){return P({},e,{loading:!1,error:i.message})}))}if(!(r.length>0)){n.next=13;break}return n.prev=3,n.next=6,(0,C.OP)(s[2].label,r[0].name);case 6:o=n.sent,S.current&&(t((function(e){return P({},e,{loading:!1,province:s[2],municipality:{id:r[0].id,label:r[0].name}})})),g((function(e){return o}))),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(3),t((function(e){return P({},e,{loading:!1,error:n.t0.message})}));case 13:case"end":return n.stop()}}),n,null,[[3,10]])})));return function(){return n.apply(this,arguments)}}();n()}),[s,e.municipalitliesList]),(0,a.useEffect)((function(){m.length>0&&E(null,{label:"Rice",from:"rice"})}),[m]);var E=function(){var n=k(i().mark((function n(o,a){var c,l,s,u,p,f,h,b,y;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c=a.label,l=a.from,["rice","other_crops"].includes(l)||g([]),void 0===c){n.next=33;break}n.t0=l,n.next="province"===n.t0?6:"municipality"===n.t0?8:"rice"===n.t0||"other_crops"===n.t0?21:30;break;case 6:try{t(P({},r,(O(s={loading:!0},l,a),O(s,"municipality",null),s))),v([]),u=e.municipalitliesList.filter((function(e){return e.province===c})).map((function(e){return{id:e.id,label:e.name}})),S.current&&(t((function(e){return P({},e,{loading:!1})})),d((function(e){return u})))}catch(i){t(P({},r,{loading:!1,error:i.message}))}return n.abrupt("break",31);case 8:return n.prev=8,t(P({},r,O({loading:!0},l,a))),v([]),n.next=13,(0,C.OP)(r.province.label,c);case 13:p=n.sent,S.current&&(t((function(e){return P({},e,{loading:!1})})),g((function(e){return p}))),n.next=20;break;case 17:n.prev=17,n.t1=n.catch(8),t(P({},r,{loading:!1,error:n.t1.message}));case 20:return n.abrupt("break",31);case 21:return t((function(e){return P({},e,{crop:l})})),f="rice"===l?["Rainfed Rice","Irrigated Rice","Rice"]:["Cassava","Lowland Vegetable","Corn"],h=m.filter((function(e){return e.province===r.province.label&&e.municipality===r.municipality.label&&f.includes(e.crop)})),b=h.reduce((function(e,n){var r=Object.values(x.re).reduce((function(e,r){var t=""===n[r.code]?[]:2===n[r.code].split(",").length?n[r.code].split(",").map((function(e){return"cropCal".concat(e.length>0?e:"nocolor")})):["cropCal".concat(n[r.code]),"cropCal".concat(n[r.code])];return P({},e,O({},r.code,t))}),{});return void 0!==e[n.cropping_system]&&Object.values(x.re).forEach((function(t){var i=t.code;e[n.cropping_system][i].every((function(e){return r[i].includes(e)}))||e[n.cropping_system][i].filter((function(e){return!r[i].includes(e)})).forEach((function(e){r[i].push(e)}))})),P({},e,O({},n.cropping_system,r))}),{}),y={},h.forEach((function(e){void 0===y[e.cropping_system]&&(y[e.cropping_system]=[]),y[e.cropping_system].includes(e.crop)||y[e.cropping_system].push(e.crop)})),_(y),v(b),n.abrupt("break",31);case 30:return n.abrupt("break",31);case 31:n.next=44;break;case 33:n.t2=l,n.next="province"===n.t2?36:"municipality"===n.t2?40:43;break;case 36:return t(P({},r,{province:null,municipality:null})),d([]),v([]),n.abrupt("break",44);case 40:return t(P({},r,{municipality:null})),v([]),n.abrupt("break",44);case 43:return n.abrupt("break",44);case 44:case"end":return n.stop()}}),n,null,[[8,17]])})));return function(e,r){return n.apply(this,arguments)}}();return(0,o.jsxs)("div",{id:"bacap-cropping-calendar",children:[(0,o.jsx)(c.Z,{variant:"h4",children:"Cropping Calendar"}),(0,o.jsx)(c.Z,{variant:"label",children:"Cropping Calendar page"}),(0,o.jsx)(j,{state:r,subcalendar:b,systemCropname:w,optsprovinces:s,optsmunicipalities:p,optscroptsURL:e.downloadurl,onSelectItemChange:E})]})}},2848:function(e,n,r){"use strict";r.d(n,{OP:function(){return j}});var t=r(4051),i=r.n(t),o=r(4763);function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,n,r,t,i,o,a){try{var c=e[o](a),l=c.value}catch(s){return void r(s)}c.done?n(l):Promise.resolve(l).then(t,i)}function l(e){return function(){var n=this,r=arguments;return new Promise((function(t,i){var o=e.apply(n,r);function a(e){c(o,t,i,a,l,"next",e)}function l(e){c(o,t,i,a,l,"throw",e)}a(void 0)}))}}function s(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function u(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function d(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){u(e,n,r[n])}))}return e}function f(e,n){return!n||"object"!==g(n)&&"function"!==typeof n?a(e):n}function m(e,n){return m=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},m(e,n)}var g=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function h(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,t=p(e);if(n){var i=p(this).constructor;r=Reflect.construct(t,arguments,i)}else r=t.apply(this,arguments);return f(this,r)}}var x="misc_crop_calendars",b="n_cropping_calendar_merged",v=function(e){!function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&m(e,n)}(r,e);var n=h(r);function r(){var e;s(this,r);var t=a(e=n.apply(this,arguments));u(a(e),"getCropCalendarsHi",l(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getCollectionData(x,"filename");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));var o=a(e);u(a(e),"getCroppingCalendarMerged",l(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.getCollectionData(b,"id");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));var c=a(e);return u(a(e),"getCroppingCalendarSimplified",function(){var e=l(i().mark((function e(n,r){var t,o,a,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==n&&void 0!==r){e.next=2;break}return e.abrupt("return");case 2:return t=c.collection(c.db,b),o=c.query(t,c.where("province","==",n),c.where("municipality","==",r)),e.next=6,c.getDocs(o);case 6:return a=e.sent,l=a.docs.map((function(e){return d({},e.data())})),e.abrupt("return",l);case 9:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}()),e}return r}(o.Z),y=new v,j=(y.getCropCalendarsHi.bind(y),y.getCroppingCalendarMerged.bind(y),y.getCroppingCalendarSimplified.bind(y))}},function(e){e.O(0,[810,774,888,179],(function(){return n=6318,e(e.s=n);var n}));var n=e.O();_N_E=n}]);
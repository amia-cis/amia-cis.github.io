(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[603],{7741:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/agroclimatic-services",function(){return t(599)}])},599:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSG:function(){return j},default:function(){return I}});var r=t(4051),i=t.n(r),a=t(5893),o=t(7294),c=t(7467),u=t(7720),s=t(1903),l=t(6295),p=t(5861),f=t(6886),d=t(6872),v=t(2890),b=t(480),h=t(4054),m=t(4854);var _=function(e){var n=e.value,t=e.handleChange;return(0,a.jsx)(h.Z,{children:(0,a.jsxs)(v.Z,{"aria-labelledby":"weather-condition-group-label",value:n,onChange:t,name:"weather-condition-group",id:"weather_condition",children:[(0,a.jsx)(b.Z,{value:m.M.NORMAL,control:(0,a.jsx)(d.Z,{}),label:"Normal"}),(0,a.jsx)(b.Z,{value:m.M.WETTER,control:(0,a.jsx)(d.Z,{}),label:"Wetter"}),(0,a.jsx)(b.Z,{value:m.M.DRIER,control:(0,a.jsx)(d.Z,{}),label:"Drier"})]})})};var g=function(e){var n=e.onSelectWeather,t=e.value;return(0,a.jsx)(_,{value:t,handleChange:function(e){var t=e.target.value;n(e,{label:t,from:"weather_condition",id:0})}})},C={container:{marginTop:function(e){return e.spacing(3)},minHeight:"400px"},controls:{marginTop:function(e){return e.spacing(6)}},selectContainer:{borderRight:{xs:"none",md:"1px solid gray"}},recsContainer:{paddingLeft:{sm:"none",md:"54px !important"}},autocomplete:{maxWidth:{sm:"100%",md:"310px"},marginBottom:function(e){return e.spacing(3)},marginTop:function(e){return e.spacing(1)}}};function x(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){x(e,n,t[n])}))}return e}var O=function(e){var n=e.sel_options,t=e.provinces,r=e.recommendations,i=e.setWeatherCondition,o=e.onSelectItemChange,c=e.optsmunicipalities,d=e.optscrops,v=e.optscropstages,b=e.optsactivities,h=function(){var e="Loading...";return t.length>0&&(e=null===n.sel_province?"Select a province":"Province"),e};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.Z,{variant:"h4",children:"Agroclimatic Service"}),(0,a.jsx)(p.Z,{variant:"label",children:"Crop Recommendations"}),(0,a.jsxs)(f.ZP,{container:!0,spacing:2,sx:C.container,children:[(0,a.jsxs)(f.ZP,{item:!0,xs:12,md:4,sx:C.selectContainer,children:[(0,a.jsx)(p.Z,{variant:"subtitle2",children:"Select Parameters"}),(0,a.jsx)(l.Z,{disablePortal:!0,id:"province",disabled:0===t.length,options:t,sx:C.autocomplete,renderInput:function(e){return(0,a.jsx)(s.Z,y({},e,{label:h()}))},onChange:function(e,n){return o(e,y({},n,{from:"province"}))}}),(0,a.jsx)(l.Z,{disablePortal:!0,id:"municipality",value:n.sel_municipality,disabled:0===c.length,options:c,sx:C.autocomplete,renderInput:function(e){return(0,a.jsx)(s.Z,y({},e,{label:null===n.sel_municipality?"Select a municipality":"Municipality"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},onChange:function(e,n){return o(e,y({},n,{from:"municipality"}))}}),(0,a.jsx)(l.Z,{disablePortal:!0,id:"crop",value:n.sel_crop,disabled:0===d.length,options:d,sx:C.autocomplete,renderInput:function(e){return(0,a.jsx)(s.Z,y({},e,{label:null===n.sel_crop?"Select a crop type":"Crop"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},onChange:function(e,n){return o(e,y({},n,{from:"crop"}))}}),(0,a.jsx)(l.Z,{disablePortal:!0,id:"cropstage",value:n.sel_stage,disabled:0===v.length,options:v,sx:C.autocomplete,renderInput:function(e){return(0,a.jsx)(s.Z,y({},e,{label:null===n.sel_stage?"Select a crop stage":"Crop Stage"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},onChange:function(e,n){return o(e,y({},n,{from:"cropstage"}))}}),(0,a.jsx)(l.Z,{disablePortal:!0,id:"activity",value:n.sel_activity,disabled:0===b.length,options:b,sx:C.autocomplete,renderInput:function(e){return(0,a.jsx)(s.Z,y({},e,{label:null===n.sel_activity?"Select an activity":"Activity"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},onChange:function(e,n){return o(e,y({},n,{from:"activity"}))}}),(0,a.jsx)("br",{}),(0,a.jsx)(u.Z,{}),(0,a.jsx)("br",{}),(0,a.jsx)(p.Z,{variant:"subtitle2",children:"Weather Condition (Temporary Selection)"}),(0,a.jsx)(g,{onSelectWeather:i,value:n.sel_condition.label})]}),(0,a.jsx)(f.ZP,{item:!0,xs:12,md:8,sx:C.recsContainer,children:(0,a.jsxs)("div",{children:[null!==n.sel_crop&&null!==n.sel_activity&&(0,a.jsxs)(p.Z,{variant:"h5",children:[n.sel_crop.label," Recommendations"]}),r.length>0&&r.map((function(e,t){return(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{children:"".concat(n.sel_condition.label.charAt(0).toUpperCase()).concat(n.sel_condition.label.slice(1))}),e.recommendations().map((function(e,n){return e.ul?(0,a.jsxs)("ul",{children:[(0,a.jsx)("li",{children:e.id}),e.subs.length>0&&(0,a.jsx)("ul",{children:e.subs.map((function(e,n){return(0,a.jsx)("li",{children:e},"sub-".concat(t,"-").concat(n))}))})]},"main-".concat(t,"-").concat(n)):(0,a.jsx)("p",{children:e.id},"main-".concat(t,"-").concat(n))}))]},"rec-".concat(t))}))]})})]})]})};function R(e,n,t,r,i,a,o){try{var c=e[a](o),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(r,i)}function E(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){R(a,r,i,o,c,"next",e)}function c(e){R(a,r,i,o,c,"throw",e)}o(void 0)}))}}function w(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function S(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){w(e,n,t[n])}))}return e}var P={sel_province:null,sel_municipality:null,sel_crop:null,sel_stage:null,sel_activity:null,sel_condition:{id:0,from:"weather_condition",label:m.M.DRIER}};var j=!0,I=function(e){var n=e.municipalities,t=void 0===n?[]:n,r=(0,o.useState)([]),u=r[0],s=r[1],l=(0,o.useState)([]),p=l[0],f=l[1],d=(0,o.useState)([]),v=d[0],b=d[1],h=(0,o.useState)([]),_=h[0],g=h[1],C=(0,o.useState)([]),x=C[0],y=C[1],R=(0,o.useState)([]),w=R[0],j=R[1],I=(0,o.useState)(P),T=I[0],k=I[1],N=(0,o.useState)([]),A=N[0],M=N[1],D=(0,o.useState)([]),Z=D[0],L=D[1],V=(0,o.useState)([]),W=V[0],G=V[1],J=(0,o.useState)([]),F=J[0],H=J[1];(0,o.useEffect)((function(){var e=function(){var e=E(i().mark((function e(){var n,r,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,Promise.all([(0,c.Mw)(),(0,c.Ob)()]);case 5:n=e.sent,b((function(e){return n[0]})),g((function(e){return n[1]})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.error(e.t0.message);case 13:try{r={},a=[],t.forEach((function(e,n){void 0===r[e.province]?(a.push({id:n,label:e.province}),r[e.province]=[{id:0,label:e.name}]):r[e.province].push({id:r[e.province].length,label:e.name})})),f((function(e){return r})),s((function(e){return a}))}catch(i){console.error(i.message)}case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}();return e(),function(){return!0}}),[t]);var U=function(){var e=E(i().mark((function e(n,t){var r,a,o,u,s,l,f,d,b,h,g,C;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.from,a=t.label,j([]),!Object.keys(t).includes("id")){e.next=58;break}e.t0=r,e.next="province"===e.t0?6:"municipality"===e.t0?9:"crop"===e.t0?27:"cropstage"===e.t0?34:"activity"===e.t0||"weather_condition"===e.t0?40:55;break;case 6:return k(S({},T,{sel_province:t,sel_municipality:null,sel_crop:null,sel_stage:null,sel_activity:null})),M(p[a]),e.abrupt("break",56);case 9:return k(S({},T,{sel_municipality:t,sel_crop:null,sel_stage:null,sel_activity:null})),G([]),H([]),e.prev=12,e.next=15,(0,c.$K)(T.sel_province.label,a);case 15:o=e.sent,y((function(e){return o})),u=[],o.map((function(e){return e.crop})).filter((function(e,n,t){return t.indexOf(e)==n})).forEach((function(e,n){u.push({id:n,label:e})})),L((function(e){return u})),e.next=26;break;case 23:e.prev=23,e.t1=e.catch(12),console.error(e.t1.message);case 26:return e.abrupt("break",56);case 27:return s=[],l=x.filter((function(e){return e.crop===a})).map((function(e){return e.stage})).filter((function(e,n,t){return t.indexOf(e)==n})),k(S({},T,{sel_crop:t,sel_stage:null,sel_activity:null})),H([]),l.forEach((function(e,n){s.push({id:n,label:e})})),G((function(e){return s})),e.abrupt("break",56);case 34:return f=[],d=x.filter((function(e){return e.stage===a&&e.crop===T.sel_crop.label})).map((function(e){return e.activity})).filter((function(e,n,t){return t.indexOf(e)==n})),k(S({},T,{sel_stage:t,sel_activity:null})),d.forEach((function(e,n){f.push({id:n,label:e})})),H((function(e){return f})),e.abrupt("break",56);case 40:if("weather_condition"!==r){e.next=49;break}k(S({},T,{sel_condition:t})),e.t2=regeneratorRuntime.keys(T);case 43:if((e.t3=e.t2()).done){e.next=49;break}if(b=e.t3.value,null!==T[b]||"weather_condition"===b){e.next=47;break}return e.abrupt("return");case 47:e.next=43;break;case 49:return h="weather_condition"===r?a:T.sel_condition.label,g="activity"===r?a:T.sel_activity.label,C=x.filter((function(e){return e.activity===g&&e.stage===T.sel_stage.label&&e.crop===T.sel_crop.label})).map((function(e){return{province:e.province,municipality:e.municipality,crop:e.crop,stage:e.stage,activity:e.activity,recommendations:function(){switch(h){case m.M.DRIER:return JSON.parse(e.normal).map((function(e){return{id:v.find((function(n){return n.id===e.id})).description,ul:e.ul,subs:e.subs.map((function(e){return _.find((function(n){return n.id===e})).description}))}}));case m.M.NORMAL:return JSON.parse(e.wetter).map((function(e){return{id:v.find((function(n){return n.id===e.id})).description,ul:e.ul,subs:e.subs.map((function(e){return _.find((function(n){return n.id===e})).description}))}}));case m.M.WETTER:return JSON.parse(e.drier).map((function(e){return{id:v.find((function(n){return n.id===e.id})).description,ul:e.ul,subs:e.subs.map((function(e){return _.find((function(n){return n.id===e})).description}))}}))}}}})),"activity"===r&&k(S({},T,{sel_activity:t})),j(C),e.abrupt("break",56);case 55:return e.abrupt("break",56);case 56:e.next=59;break;case 58:"province"===r?(k(P),M([]),L([]),G([]),H([])):"municipality"===r?(k(S({},T,{sel_municipality:null,sel_crop:null,sel_stage:null,sel_activity:null})),L([]),G([]),H([])):"crop"===r?(k(S({},T,{sel_crop:null,sel_stage:null,sel_activity:null})),G([]),H([])):"cropstage"===r?(k(S({},T,{sel_stage:null,sel_activity:null})),H([])):"activity"===r&&k(S({},T,{sel_activity:null}));case 59:case"end":return e.stop()}}),e,null,[[12,23]])})));return function(n,t){return e.apply(this,arguments)}}();return(0,a.jsx)(O,{sel_options:T,provinces:u,recommendations:w,optsmunicipalities:A,optscrops:Z,optscropstages:W,optsactivities:F,conditions:[{id:"norm",label:"Normal Conditions"},{id:"wet",label:"Wetter than Normal Conditions"},{id:"dry",label:"Drier than Normal Conditions"}],onSelectItemChange:U,setWeatherCondition:function(e,n){k(S({},T,{sel_condition:n.label})),U(null,n)}})}},4854:function(e,n,t){"use strict";function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}t.d(n,{M:function(){return a},t:function(){return o}});var i,a={DRIER:"drier",NORMAL:"normal",WETTER:"wetter"},o=(r(i={},a.DRIER,"#c2d69b"),r(i,a.NORMAL,"#ebf1dd"),r(i,a.WETTER,"#7e9550"),i)},7467:function(e,n,t){"use strict";t.d(n,{Mw:function(){return h},$K:function(){return b},Qt:function(){return v},Ob:function(){return m},GV:function(){return _}});var r=t(4051),i=t.n(r),a=t(5048),o=t(5321);function c(e,n,t,r,i,a,o){try{var c=e[a](o),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(r,i)}function u(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){c(a,r,i,o,u,"next",e)}function u(e){c(a,r,i,o,u,"throw",e)}o(void 0)}))}}function s(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){l(e,n,t[n])}))}return e}var f=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e);var n=this;l(this,"getSelections",u(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getCollectionData(n.CROP_REC_ACTIVITY_SELECTION,"prov");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));var t=this;l(this,"getProvinces",u(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getCollectionData(t.CROP_REC_PROVINCES,"id");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));var r=this;l(this,"getMunicipalities",u(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getCollectionData(r.CROP_REC_MUNICIPALITIES,"id");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));var c=this;l(this,"getActivities",function(){var e=u(i().mark((function e(n){var t,r,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return t=(0,o.hJ)(a.db,c.CROP_REC_ACTIVITY_SELECTION),r=(0,o.IO)(t,(0,o.ar)("prov","==",n)),e.next=6,c.getCollectionData(c.CROP_REC_ACTIVITY_SELECTION,"",r);case 6:return u=e.sent,e.abrupt("return",u);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());var s=this;l(this,"getVillages",u(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.getCollectionData(s.VILLAGES,"barangay");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));var p=this;l(this,"getCropCalendarsHi",u(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.getCollectionData(p.CROP_CALENDARS,"filename");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));var f=this;l(this,"getRegionProvinces",u(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.getCollectionData(f.REGIONS,"province");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));var d=this;l(this,"getWeatherForecast",function(){var e=u(i().mark((function e(n,t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.getNestedCollectionData(d.WEATHER_FORECASTS,n,t,"name");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}());var v=this;l(this,"getRecommendations",function(){var e=u(i().mark((function e(n,t){var r,c,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==n&&void 0!==t){e.next=2;break}return e.abrupt("return");case 2:return r=(0,o.hJ)(a.db,v.CROP_REC_RECOMMENDATIONS),c=(0,o.IO)(r,(0,o.ar)("province","==",n),(0,o.ar)("municipality","==",t)),e.next=6,v.getCollectionData(v.CROP_REC_RECOMMENDATIONS,"",c);case 6:return u=e.sent,e.abrupt("return",u);case 8:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}());var b=this;l(this,"getMainCropRecommendations",u(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.getCollectionData(b.CROP_REC_LIST_RECS_MAIN,"id");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));var h=this;l(this,"getSubCropRecommendations",u(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.getCollectionData(h.CROP_REC_LIST_RECS_SUB,"id");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))),this.CROP_REC_ACTIVITY_SELECTION="rec_selections",this.VILLAGES="villages",this.CROP_CALENDARS="misc_crop_calendars",this.REGIONS="const_regions",this.WEATHER_FORECASTS="weather_forecasts",this.CROP_REC_RECOMMENDATIONS="n_crop_recommendations",this.CROP_REC_PROVINCES="n_provinces",this.CROP_REC_MUNICIPALITIES="n_municipalities",this.CROP_REC_CROPS="n_crops",this.CROP_REC_STAGES="n_crop_stages",this.CROP_REC_ACTIVITIES="n_activities",this.CROP_REC_LIST_RECS_MAIN="n_list_recommendations",this.CROP_REC_LIST_RECS_SUB="n_list_subrecommendations"}var n,t,r;return n=e,t=[{key:"getCollectionData",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return u(i().mark((function r(){var c,u,s,l;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c=(0,o.hJ)(a.db,e),u=t||(0,o.IO)(c,(0,o.Xo)(n,"asc")),r.next=4,(0,o.PL)(u);case 4:return s=r.sent,l=s.docs.map((function(e){return p({},e.data())})),r.abrupt("return",l);case 7:case"end":return r.stop()}}),r)})))()}},{key:"getNestedCollectionData",value:function(e,n,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return u(i().mark((function c(){var s;return i().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return s=(0,o.IO)((0,o.hJ)(a.db,e,n,t),(0,o.Xo)(r)),c.abrupt("return",new Promise(function(){var e=u(i().mark((function e(n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,o.cf)(s,(function(e){n(e.docs.map((function(e){return e.data()})))}));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 2:case"end":return c.stop()}}),c)})))()}}],t&&s(n.prototype,t),r&&s(n,r),e}(),d=new f,v=(d.getSelections.bind(d),d.getProvinces.bind(d),d.getActivities.bind(d),d.getVillages.bind(d),d.getRegionProvinces.bind(d)),b=(d.getCropCalendarsHi.bind(d),d.getMunicipalities.bind(d),d.getRecommendations.bind(d)),h=d.getMainCropRecommendations.bind(d),m=d.getSubCropRecommendations.bind(d),_=d.getWeatherForecast.bind(d)}},function(e){e.O(0,[46,903,295,250,774,888,179],(function(){return n=7741,e(e.s=n);var n}));var n=e.O();_N_E=n}]);
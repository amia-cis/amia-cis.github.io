(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[406],{3622:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/bulletins/crops",function(){return n(1995)}])},7513:function(e,t){"use strict";t.Z={container:{padding:"24px",width:"100%",position:"relative",minWidth:"0px",overflowWrap:"break-word",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"16px",margin:"auto",borderColor:"#E2E8F0"},welcome:{display:"grid",placeContent:"center",marginTop:function(e){return e.spacing(10)},textAlign:"center","& h5":{marginTop:function(e){return e.spacing(2)}}},conditionLegend:{maxWidth:{md:"100%",lg:"270px"},marginBottom:"32px",padding:function(e){return e.spacing(1)},borderRadius:"4px",border:"1px solid grey",textAlign:"center",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px"},autocomplete:{marginTop:function(e){return e.spacing(1)}},recSeasonal:{marginTop:function(e){return e.spacing(5)},"& p, ul":{fontSize:"14px"}},datagrid:{background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"8px","& .MuiDataGrid-main":{borderRadius:2},"& .MuiDataGrid-virtualScrollerRenderZone":{"& .MuiDataGrid-row":{"&:nth-of-type(2n)":{backgroundColor:"rgba(235, 235, 235, .7)"}}},"& .MuiDataGrid-columnHeader:focus-within":{outline:"none !important"},"& .MuiDataGrid-columnHeaders":{color:function(e){return e.palette.primary.dark},fontSize:16}},gridContainer:{marginTop:"24px",minHeight:500,width:1,"& .normal":{backgroundColor:"yellow"},"& .drier":{backgroundColor:"red"},"& .wetter":{backgroundColor:"blue"}},item:{}}},1995:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return X}});var r=n(4051),o=n.n(r),i=n(5893),a=n(7294),c=n(1163),u=n(3835),l=n(8152),s=n(1664),f=n(5861),p=n(7357),d=n(1057),b=n(7462),h=n(3366),v=n(6010),m=n(1496),y=n(7192),g=n(3490),w=n(8836);const x=["className","children"],P=(0,m.ZP)("div",{name:"MuiDataGrid",slot:"ToolbarContainer",overridesResolver:(e,t)=>t.toolbarContainer})((({theme:e})=>({display:"flex",alignItems:"center",padding:e.spacing(.5,.5,0)}))),O=a.forwardRef((function(e,t){const{className:n,children:r}=e,o=(0,h.Z)(e,x),a=(e=>{const{classes:t}=e;return(0,y.Z)({root:["toolbarContainer"]},g.d,t)})({classes:(0,w.B)().classes});return r?(0,i.jsx)(P,(0,b.Z)({ref:t,className:(0,v.Z)(n,a.root)},o,{children:r})):null}));var j=n(4696),k=n(269),C=n(7476),R=n(9630);const _=["onClick"],T=a.forwardRef((function(e,t){var n;const{onClick:r}=e,o=(0,h.Z)(e,_),a=(0,R.l)(),c=(0,w.B)(),{open:u,openedPanelValue:l}=(0,j.P)(a,k.e);return c.disableColumnSelector?null:(0,i.jsx)(c.components.BaseButton,(0,b.Z)({ref:t,size:"small",color:"primary","aria-label":a.current.getLocaleText("toolbarColumnsLabel"),startIcon:(0,i.jsx)(c.components.ColumnSelectorIcon,{})},o,{onClick:e=>{u&&l===C.y.columns?a.current.hidePreferences():a.current.showPreferences(C.y.columns),null==r||r(e)}},null==(n=c.componentsProps)?void 0:n.baseButton,{children:a.current.getLocaleText("toolbarColumns")}))}));var S=n(8082),E=n(8216),F=n(198),B=n(1207);const D=["componentsProps"],Z=(0,m.ZP)("ul",{name:"MuiDataGrid",slot:"ToolbarFilterList",overridesResolver:(e,t)=>t.toolbarFilterList})((({theme:e})=>({margin:e.spacing(1,1,.5),padding:e.spacing(0,1)}))),L=a.forwardRef((function(e,t){var n,r;const{componentsProps:o={}}=e,c=(0,h.Z)(e,D),u=o.button||{},l=(0,R.l)(),s=(0,w.B)(),f=(0,j.P)(l,B.DY),p=(0,j.P)(l,F.WH),d=(0,j.P)(l,k.e),v=(e=>{const{classes:t}=e;return(0,y.Z)({root:["toolbarFilterList"]},g.d,t)})({classes:s.classes}),m=a.useMemo((()=>{if(d.open)return l.current.getLocaleText("toolbarFiltersTooltipHide");if(0===f.length)return l.current.getLocaleText("toolbarFiltersTooltipShow");const e=e=>p[e.columnField].filterOperators.find((t=>t.value===e.operatorValue)).label||l.current.getLocaleText(`filterOperator${(0,E.Z)(e.operatorValue)}`).toString();return(0,i.jsxs)("div",{children:[l.current.getLocaleText("toolbarFiltersTooltipActive")(f.length),(0,i.jsx)(Z,{className:v.root,children:f.map(((t,n)=>(0,b.Z)({},p[t.columnField]&&(0,i.jsx)("li",{children:`${p[t.columnField].headerName||t.columnField}\n                  ${e(t)}\n                  ${t.value}`},n))))})]})}),[l,d.open,f,p,v]);return s.disableColumnFilter?null:(0,i.jsx)(s.components.BaseTooltip,(0,b.Z)({title:m,enterDelay:1e3},c,null==(n=s.componentsProps)?void 0:n.baseTooltip,{children:(0,i.jsx)(s.components.BaseButton,(0,b.Z)({ref:t,size:"small",color:"primary","aria-label":l.current.getLocaleText("toolbarFiltersLabel"),startIcon:(0,i.jsx)(S.Z,{badgeContent:f.length,color:"primary",children:(0,i.jsx)(s.components.OpenFilterButtonIcon,{})})},u,{onClick:e=>{var t;const{open:n,openedPanelValue:r}=d;n&&r===C.y.filters?l.current.hideFilterPanel():l.current.showFilterPanel(),null==(t=u.onClick)||t.call(u,e)}},null==(r=s.componentsProps)?void 0:r.baseButton,{children:l.current.getLocaleText("toolbarFilters")}))}))}));var I=n(9208),N=n(7702),M=n(7513);function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e){return(0,i.jsxs)(O,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){A(e,t,n[t])}))}return e}({},e,{children:[(0,i.jsx)(T,{}),(0,i.jsx)(L,{})]}))}var H=function(e){var t=e.rows,n=e.columns,r=e.loading,o=e.loadingReports,a=e.user,u=e.onBtnClick,l=(0,c.useRouter)();return(0,i.jsxs)(N.Z,{loading:r,user:a,onBtnLogoutClick:u,children:[(0,i.jsx)(f.Z,{variant:"h5",children:"Crop Recommendations"}),(0,i.jsxs)("p",{children:["Create and preview ",(0,i.jsx)("strong",{children:"10-Day"})," and ",(0,i.jsx)("strong",{children:"Seasonal"})," crop bulletins. Finalized bulletins will be automatically uploaded to the site for public download."]}),(0,i.jsx)(s.default,{href:"/admin/bulletins/crops/create",passHref:!0,children:(0,i.jsx)(d.Z,{variant:"contained",children:"Create Bulletin"})}),(0,i.jsx)(p.Z,{sx:M.Z.gridContainer,style:{height:t.length<=4?"500px":"unset"},children:(0,i.jsx)(I._,{rows:t,columns:n,sx:M.Z.datagrid,autoHeight:t.length>=5,disableDensitySelector:!0,rowsPerPageOptions:[15,30,100],components:{Toolbar:G},loading:o,initialState:{columns:{columnVisibilityModel:{rowId:!1}}},onRowClick:function(e){l.push({pathname:"/admin/bulletins/crops/view",query:{docId:e.row.docId}})}})})]})};function q(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,o)}function z(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){q(i,r,o,a,c,"next",e)}function c(e){q(i,r,o,a,c,"throw",e)}a(void 0)}))}}function V(){var e=(0,u.aC)(),t=(0,c.useRouter)(),n=(0,a.useState)([]),r=n[0],s=n[1],f=(0,a.useState)([]),p=f[0],d=f[1],b=(0,a.useState)([]),h=b[0],v=b[1],m=(0,a.useState)(!0),y=m[0],g=m[1];(0,a.useEffect)((function(){if(null!==e.user&&!e.loading){var t=function(){var t=z(o().mark((function t(){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,l.pr)(e.user.uid);case 3:n=t.sent,v(n),g(!1),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),g(!1),console.error(t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}();t()}}),[e]),(0,a.useEffect)((function(){if(h.length>0){var e={crop:"Crop",province:"Province",municipality:"Municipality",updated_by:"Updated by",date_created:"Date Created"},t=[];["crop","province","municipality","updated_by","date_created"].forEach((function(n){t.push({field:n,headerName:e[n],width:200,editable:!1,sortable:!1,disableColumnMenu:!0})}));var n=h.map((function(e,t){return{id:t,docId:e.id,crop:e.crop,province:e.province,municipality:e.municipality,updated_by:e.updated_by,date_created:e.date_created.toDate().toDateString()}}));s(n),d(t)}}),[h]),(0,a.useEffect)((function(){e.loading||e.user||t.push("/admin/login")}),[e.user,e.loading,t]);var w=function(){var t=z(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.logOut();case 3:t.next=7;break;case 5:t.prev=5,t.t0=t.catch(0);case 7:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(){return t.apply(this,arguments)}}();return(0,i.jsx)(H,{loading:e.loading,user:e.user,rows:r,columns:p,loadingReports:y,onBtnClick:w})}V.customLayout=!0,V.adminPage=!0;var X=V},8152:function(e,t,n){"use strict";n.d(t,{Zn:function(){return L},fL:function(){return N},pr:function(){return M},pl:function(){return I}});var r=n(4051),o=n.n(r),i=n(9669),a=n.n(i),c=n(9431);function u(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){u(i,r,o,a,c,"next",e)}function c(e){u(i,r,o,a,c,"throw",e)}a(void 0)}))}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){p(e,t,n[t])}))}return e}function h(e,t){return!t||"object"!==m(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e,t){return v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},v(e,t)}var m=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var o=d(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h(this,n)}}var g={BASE_API_URL:"https://amia-cis.herokuapp.com/api",CREATE_REPORT:"".concat("https://amia-cis.herokuapp.com/api","/bulletins/seasonal/crops"),REPORTS_CROPS:"reports_crops"},w=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(c,e);var t,n,r,i=y(c);function c(){return s(this,c),i.apply(this,arguments)}return t=c,(n=[{key:"createReport",value:function(e){var t=this;return l(o().mark((function n(){var r,i;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.createRequestObject({body:e});case 2:return r=n.sent,n.next=5,a()(b({},r,{url:g.CREATE_REPORT,method:"POST"}));case 5:return i=n.sent,n.abrupt("return",i.data);case 7:case"end":return n.stop()}}),n)})))()}},{key:"previewBulletin",value:function(e){var t=this;return l(o().mark((function n(){var r,i;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.createRequestObject({body:e,responseType:"blob"});case 2:return r=n.sent,n.next=5,a()(b({},r,{url:g.CREATE_REPORT,method:"POST"}));case 5:return i=n.sent,n.abrupt("return",i.data);case 7:case"end":return n.stop()}}),n)})))()}}])&&f(t.prototype,n),r&&f(t,r),c}(c.Z),x=n(4763);function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,o)}function j(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){O(i,r,o,a,c,"next",e)}function c(e){O(i,r,o,a,c,"throw",e)}a(void 0)}))}}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}function _(e,t){return!t||"object"!==S(t)&&"function"!==typeof t?P(e):t}function T(e,t){return T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},T(e,t)}var S=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R(e);if(t){var o=R(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _(this,n)}}var F="reports_crops",B=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(n,e);var t=E(n);function n(){var e;k(this,n);var r=P(e=t.apply(this,arguments));C(P(e),"getBulletin",function(){var e=j(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getDocumentData(F,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var i=P(e);return C(P(e),"getBulletins",function(){var e=j(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.collection(i.db,F),r=i.query(n,i.where("uid","==",t)),e.next=4,i.getCollectionData(F,"",r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e}return n}(x.Z),D=new w,Z=new B,L=D.createReport.bind(D),I=D.previewBulletin.bind(D),N=Z.getBulletin.bind(Z),M=Z.getBulletins.bind(Z)},4763:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var r=n(4051),o=n.n(r),i=n(4659),a=n(5321);function c(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){c(i,r,o,a,u,"next",e)}function u(e){c(i,r,o,a,u,"throw",e)}a(void 0)}))}}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){s(e,t,n[t])}))}return e}var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.db=i.db,this.collection=a.hJ,this.doc=a.JU,this.getDocs=a.PL,this.getDoc=a.QT,this.query=a.IO,this.where=a.ar,this.limit=a.b9,this.orderBy=a.Xo}var t,n,r;return t=e,n=[{key:"getCollectionData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return u(o().mark((function r(){var c,u,l,s;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c=(0,a.hJ)(i.db,e),u=n||(0,a.IO)(c,(0,a.Xo)(t,"asc")),r.next=4,(0,a.PL)(u);case 4:return l=r.sent,s=l.docs.map((function(e){return f({},e.data())})),r.abrupt("return",s);case 7:case"end":return r.stop()}}),r)})))()}},{key:"getNestedCollectionData",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return u(o().mark((function c(){var u,l,s;return o().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return u=(0,a.IO)((0,a.hJ)(i.db,e,t,n),(0,a.Xo)(r)),o.next=3,(0,a.PL)(u);case 3:return l=o.sent,s=l.docs.map((function(e){return f({},e.data())})),o.abrupt("return",s);case 6:case"end":return o.stop()}}),c)})))()}},{key:"getDocumentData",value:function(e,t){var n=this;return u(o().mark((function r(){var i,a;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.doc(n.db,e,t),r.next=3,n.getDoc(i);case 3:if(!(a=r.sent).exists()){r.next=8;break}return r.abrupt("return",a.data());case 8:return r.abrupt("return",void 0);case 9:case"end":return r.stop()}}),r)})))()}}],n&&l(t.prototype,n),r&&l(t,r),e}()}},function(e){e.O(0,[369,295,531,669,208,899,774,888,179],(function(){return t=3622,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[406],{7070:function(e,t,n){"use strict";n(7294);var r=n(2066),o=n(5893);t.Z=(0,r.Z)((0,o.jsx)("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft")},6686:function(e,t,n){"use strict";n(7294);var r=n(2066),o=n(5893);t.Z=(0,r.Z)((0,o.jsx)("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight")},3622:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/bulletins/crops",function(){return n(1995)}])},7513:function(e,t){"use strict";t.Z={container:{padding:"24px",width:"100%",position:"relative",minWidth:"0px",overflowWrap:"break-word",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"16px",margin:"auto",borderColor:"#E2E8F0"},welcome:{display:"grid",placeContent:"center",marginTop:function(e){return e.spacing(10)},textAlign:"center","& h5":{marginTop:function(e){return e.spacing(2)}}},conditionLegend:{maxWidth:{md:"100%",lg:"270px"},marginBottom:"32px",padding:function(e){return e.spacing(1)},borderRadius:"4px",border:"1px solid grey",textAlign:"center",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px"},autocomplete:{marginTop:function(e){return e.spacing(1)}},recSeasonal:{marginTop:function(e){return e.spacing(1)},"& p, ul":{fontSize:"14px"}},datagrid:{background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"8px","& .MuiDataGrid-main":{borderRadius:2},"& .MuiDataGrid-virtualScrollerRenderZone":{"& .MuiDataGrid-row":{"&:nth-of-type(2n)":{backgroundColor:"rgba(235, 235, 235, .7)"}}},"& .MuiDataGrid-columnHeader:focus-within":{outline:"none !important"},"& .MuiDataGrid-columnHeaders":{color:function(e){return e.palette.primary.dark},fontSize:16}},gridContainer:{marginTop:"24px",minHeight:500,width:1,"& .normal":{backgroundColor:"yellow"},"& .drier":{backgroundColor:"red"},"& .wetter":{backgroundColor:"blue"}},button:{color:"#FFFFFF",textTransform:"capitalize",fontSize:"14px",fontStyle:"normal",fontWeight:"normal",width:"80px",height:{xs:"40px",sm:"50px"}}}},1995:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return W}});var r=n(4051),o=n.n(r),i=n(5893),a=n(7294),c=n(1163),u=n(3835),l=n(8152),s=n(1664),p=n(5861),f=n(7357),d=n(1057),b=n(7462),h=n(3366),m=n(6010),v=n(1496),y=n(7192),g=n(3490),x=n(8836);const w=["className","children"],P=(0,v.ZP)("div",{name:"MuiDataGrid",slot:"ToolbarContainer",overridesResolver:(e,t)=>t.toolbarContainer})((({theme:e})=>({display:"flex",alignItems:"center",padding:e.spacing(.5,.5,0)}))),O=a.forwardRef((function(e,t){const{className:n,children:r}=e,o=(0,h.Z)(e,w),a=(e=>{const{classes:t}=e;return(0,y.Z)({root:["toolbarContainer"]},g.d,t)})({classes:(0,x.B)().classes});return r?(0,i.jsx)(P,(0,b.Z)({ref:t,className:(0,m.Z)(n,a.root)},o,{children:r})):null}));var R=n(4696),j=n(269),_=n(7476),C=n(9630);const T=["onClick"],k=a.forwardRef((function(e,t){var n;const{onClick:r}=e,o=(0,h.Z)(e,T),a=(0,C.l)(),c=(0,x.B)(),{open:u,openedPanelValue:l}=(0,R.P)(a,j.e);return c.disableColumnSelector?null:(0,i.jsx)(c.components.BaseButton,(0,b.Z)({ref:t,size:"small",color:"primary","aria-label":a.current.getLocaleText("toolbarColumnsLabel"),startIcon:(0,i.jsx)(c.components.ColumnSelectorIcon,{})},o,{onClick:e=>{u&&l===_.y.columns?a.current.hidePreferences():a.current.showPreferences(_.y.columns),null==r||r(e)}},null==(n=c.componentsProps)?void 0:n.baseButton,{children:a.current.getLocaleText("toolbarColumns")}))}));var E=n(8082),F=n(8216),S=n(198),Z=n(1207);const B=["componentsProps"],L=(0,v.ZP)("ul",{name:"MuiDataGrid",slot:"ToolbarFilterList",overridesResolver:(e,t)=>t.toolbarFilterList})((({theme:e})=>({margin:e.spacing(1,1,.5),padding:e.spacing(0,1)}))),D=a.forwardRef((function(e,t){var n,r;const{componentsProps:o={}}=e,c=(0,h.Z)(e,B),u=o.button||{},l=(0,C.l)(),s=(0,x.B)(),p=(0,R.P)(l,Z.DY),f=(0,R.P)(l,S.WH),d=(0,R.P)(l,j.e),m=(e=>{const{classes:t}=e;return(0,y.Z)({root:["toolbarFilterList"]},g.d,t)})({classes:s.classes}),v=a.useMemo((()=>{if(d.open)return l.current.getLocaleText("toolbarFiltersTooltipHide");if(0===p.length)return l.current.getLocaleText("toolbarFiltersTooltipShow");const e=e=>f[e.columnField].filterOperators.find((t=>t.value===e.operatorValue)).label||l.current.getLocaleText(`filterOperator${(0,F.Z)(e.operatorValue)}`).toString();return(0,i.jsxs)("div",{children:[l.current.getLocaleText("toolbarFiltersTooltipActive")(p.length),(0,i.jsx)(L,{className:m.root,children:p.map(((t,n)=>(0,b.Z)({},f[t.columnField]&&(0,i.jsx)("li",{children:`${f[t.columnField].headerName||t.columnField}\n                  ${e(t)}\n                  ${t.value}`},n))))})]})}),[l,d.open,p,f,m]);return s.disableColumnFilter?null:(0,i.jsx)(s.components.BaseTooltip,(0,b.Z)({title:v,enterDelay:1e3},c,null==(n=s.componentsProps)?void 0:n.baseTooltip,{children:(0,i.jsx)(s.components.BaseButton,(0,b.Z)({ref:t,size:"small",color:"primary","aria-label":l.current.getLocaleText("toolbarFiltersLabel"),startIcon:(0,i.jsx)(E.Z,{badgeContent:p.length,color:"primary",children:(0,i.jsx)(s.components.OpenFilterButtonIcon,{})})},u,{onClick:e=>{var t;const{open:n,openedPanelValue:r}=d;n&&r===_.y.filters?l.current.hideFilterPanel():l.current.showFilterPanel(),null==(t=u.onClick)||t.call(u,e)}},null==(r=s.componentsProps)?void 0:r.baseButton,{children:l.current.getLocaleText("toolbarFilters")}))}))}));var M=n(9208),A=n(7702),I=n(7513);function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e){return(0,i.jsxs)(O,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){N(e,t,n[t])}))}return e}({},e,{children:[(0,i.jsx)(k,{}),(0,i.jsx)(D,{})]}))}var G=function(e){var t=e.rows,n=e.columns,r=e.loading,o=e.loadingReports,a=e.user,u=e.onBtnClick,l=(0,c.useRouter)();return(0,i.jsxs)(A.Z,{loading:r,user:a,onBtnLogoutClick:u,children:[(0,i.jsx)(p.Z,{variant:"h5",children:"Crop Recommendations"}),(0,i.jsxs)("p",{children:["Create and preview ",(0,i.jsx)("strong",{children:"10-Day"})," and ",(0,i.jsx)("strong",{children:"Seasonal"})," crop bulletins. Finalized bulletins will be automatically uploaded to the site for public download."]}),(0,i.jsx)(s.default,{href:"/admin/bulletins/crops/create",passHref:!0,children:(0,i.jsx)(d.Z,{variant:"contained",children:"Create Bulletin"})}),(0,i.jsx)(f.Z,{sx:I.Z.gridContainer,style:{height:t.length<=4?"500px":"unset"},children:(0,i.jsx)(M._,{rows:t,columns:n,sx:I.Z.datagrid,autoHeight:t.length>=5,disableDensitySelector:!0,rowsPerPageOptions:[15,30,100],components:{Toolbar:z},loading:o,initialState:{columns:{columnVisibilityModel:{rowId:!1}}},onRowClick:function(e){l.push({pathname:"/admin/bulletins/crops/view",query:{docId:e.row.docId}})}})})]})};function H(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,o)}function q(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){H(i,r,o,a,c,"next",e)}function c(e){H(i,r,o,a,c,"throw",e)}a(void 0)}))}}function V(){var e=(0,u.aC)(),t=(0,c.useRouter)(),n=(0,a.useState)([]),r=n[0],s=n[1],p=(0,a.useState)([]),f=p[0],d=p[1],b=(0,a.useState)([]),h=b[0],m=b[1],v=(0,a.useState)(!0),y=v[0],g=v[1];(0,a.useEffect)((function(){if(null!==e.user&&!e.loading){var t=function(){var t=q(o().mark((function t(){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,l.pr)(e.user.uid);case 3:n=t.sent,m(n),g(!1),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),g(!1),console.error(t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}();t()}}),[e]),(0,a.useEffect)((function(){if(h.length>0){var e={crop:"Crop",province:"Province",municipality:"Municipality",updated_by:"Updated by",date_created:"Date Created"},t=[];["crop","province","municipality","updated_by","date_created"].forEach((function(n){t.push({field:n,headerName:e[n],width:200,editable:!1,sortable:!1,disableColumnMenu:!0})}));var n=h.map((function(e,t){return{id:t,docId:e.id,crop:e.crop,province:e.province,municipality:e.municipality,updated_by:e.updated_by,date_created:e.date_created.toDate().toDateString()}}));s(n),d(t)}}),[h]),(0,a.useEffect)((function(){e.loading||e.user||t.push("/admin/login")}),[e.user,e.loading,t]);var x=function(){var t=q(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.logOut();case 3:t.next=7;break;case 5:t.prev=5,t.t0=t.catch(0);case 7:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(){return t.apply(this,arguments)}}();return(0,i.jsx)(G,{loading:e.loading,user:e.user,rows:r,columns:f,loadingReports:y,onBtnClick:x})}V.customLayout=!0,V.adminPage=!0;var W=V},8152:function(e,t,n){"use strict";n.d(t,{Zn:function(){return D},GR:function(){return M},fL:function(){return I},pr:function(){return N},pl:function(){return A}});var r=n(4051),o=n.n(r),i=n(9669),a=n.n(i),c=n(9431);function u(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){u(i,r,o,a,c,"next",e)}function c(e){u(i,r,o,a,c,"throw",e)}a(void 0)}))}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){f(e,t,n[t])}))}return e}function h(e,t){return!t||"object"!==v(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}var v=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var o=d(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h(this,n)}}var g={BASE_API_URL:"https://amia-cis.herokuapp.com/api",CREATE_REPORT:"".concat("https://amia-cis.herokuapp.com/api","/reports/seasonal/crops"),REPORTS_CROPS:"reports_crops"},x=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(c,e);var t,n,r,i=y(c);function c(){return s(this,c),i.apply(this,arguments)}return t=c,(n=[{key:"createReport",value:function(e){var t=this;return l(o().mark((function n(){var r,i;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.createRequestObject({body:e});case 2:return r=n.sent,n.next=5,a()(b({},r,{url:g.CREATE_REPORT,method:"POST"}));case 5:return i=n.sent,n.abrupt("return",i.data);case 7:case"end":return n.stop()}}),n)})))()}},{key:"deleteReport",value:function(e){var t=this;return l(o().mark((function n(){var r,i;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={docId:e},n.next=3,t.createRequestObject({body:r});case 3:return i=n.sent,n.next=6,a()(b({},i,{url:g.CREATE_REPORT,method:"DELETE"}));case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),n)})))()}},{key:"previewBulletin",value:function(e){var t=this;return l(o().mark((function n(){var r,i;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.createRequestObject({body:e,responseType:"blob"});case 2:return r=n.sent,n.next=5,a()(b({},r,{url:g.CREATE_REPORT,method:"POST"}));case 5:return i=n.sent,n.abrupt("return",i.data);case 7:case"end":return n.stop()}}),n)})))()}}])&&p(t.prototype,n),r&&p(t,r),c}(c.Z),w=n(4763);function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,o)}function R(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){O(i,r,o,a,c,"next",e)}function c(e){O(i,r,o,a,c,"throw",e)}a(void 0)}))}}function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e){return C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},C(e)}function T(e,t){return!t||"object"!==E(t)&&"function"!==typeof t?P(e):t}function k(e,t){return k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},k(e,t)}var E=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function F(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=C(e);if(t){var o=C(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return T(this,n)}}var S="reports_crops",Z=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(n,e);var t=F(n);function n(){var e;j(this,n);var r=P(e=t.apply(this,arguments));_(P(e),"getBulletin",function(){var e=R(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getDocumentData(S,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var i=P(e);return _(P(e),"getBulletins",function(){var e=R(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.collection(i.db,S),r=i.query(n,i.where("uid","==",t)),e.next=4,i.getCollectionData(S,"",r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e}return n}(w.Z),B=new x,L=new Z,D=B.createReport.bind(B),M=B.deleteReport.bind(B),A=B.previewBulletin.bind(B),I=L.getBulletin.bind(L),N=L.getBulletins.bind(L)}},function(e){e.O(0,[611,669,208,899,774,888,179],(function(){return t=3622,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[755],{6863:function(e,n,t){"use strict";t.d(n,{Z:function(){return x}});var r=t(3366),i=t(7462),o=t(7294),a=t(6010),l=t(7192),s=t(1796),c=t(8216),u=t(1496),d=t(3616),p=t(8979);function f(e){return(0,p.Z)("MuiButtonGroup",e)}var b=(0,t(6087).Z)("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","fullWidth","vertical","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary"]),h=t(8363),m=t(5893);const v=["children","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"],g=(0,u.ZP)("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:t}=e;return[{[`& .${b.grouped}`]:n.grouped},{[`& .${b.grouped}`]:n[`grouped${(0,c.Z)(t.orientation)}`]},{[`& .${b.grouped}`]:n[`grouped${(0,c.Z)(t.variant)}`]},{[`& .${b.grouped}`]:n[`grouped${(0,c.Z)(t.variant)}${(0,c.Z)(t.orientation)}`]},{[`& .${b.grouped}`]:n[`grouped${(0,c.Z)(t.variant)}${(0,c.Z)(t.color)}`]},n.root,n[t.variant],!0===t.disableElevation&&n.disableElevation,t.fullWidth&&n.fullWidth,"vertical"===t.orientation&&n.vertical]}})((({theme:e,ownerState:n})=>(0,i.Z)({display:"inline-flex",borderRadius:e.shape.borderRadius},"contained"===n.variant&&{boxShadow:e.shadows[2]},n.disableElevation&&{boxShadow:"none"},n.fullWidth&&{width:"100%"},"vertical"===n.orientation&&{flexDirection:"column"},{[`& .${b.grouped}`]:(0,i.Z)({minWidth:40,"&:not(:first-of-type)":(0,i.Z)({},"horizontal"===n.orientation&&{borderTopLeftRadius:0,borderBottomLeftRadius:0},"vertical"===n.orientation&&{borderTopRightRadius:0,borderTopLeftRadius:0},"outlined"===n.variant&&"horizontal"===n.orientation&&{marginLeft:-1},"outlined"===n.variant&&"vertical"===n.orientation&&{marginTop:-1}),"&:not(:last-of-type)":(0,i.Z)({},"horizontal"===n.orientation&&{borderTopRightRadius:0,borderBottomRightRadius:0},"vertical"===n.orientation&&{borderBottomRightRadius:0,borderBottomLeftRadius:0},"text"===n.variant&&"horizontal"===n.orientation&&{borderRight:"1px solid "+("light"===e.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)")},"text"===n.variant&&"vertical"===n.orientation&&{borderBottom:"1px solid "+("light"===e.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)")},"text"===n.variant&&"inherit"!==n.color&&{borderColor:(0,s.Fq)(e.palette[n.color].main,.5)},"outlined"===n.variant&&"horizontal"===n.orientation&&{borderRightColor:"transparent"},"outlined"===n.variant&&"vertical"===n.orientation&&{borderBottomColor:"transparent"},"contained"===n.variant&&"horizontal"===n.orientation&&{borderRight:`1px solid ${e.palette.grey[400]}`,[`&.${b.disabled}`]:{borderRight:`1px solid ${e.palette.action.disabled}`}},"contained"===n.variant&&"vertical"===n.orientation&&{borderBottom:`1px solid ${e.palette.grey[400]}`,[`&.${b.disabled}`]:{borderBottom:`1px solid ${e.palette.action.disabled}`}},"contained"===n.variant&&"inherit"!==n.color&&{borderColor:e.palette[n.color].dark},{"&:hover":(0,i.Z)({},"outlined"===n.variant&&"horizontal"===n.orientation&&{borderRightColor:"currentColor"},"outlined"===n.variant&&"vertical"===n.orientation&&{borderBottomColor:"currentColor"})}),"&:hover":(0,i.Z)({},"contained"===n.variant&&{boxShadow:"none"})},"contained"===n.variant&&{boxShadow:"none"})})));var x=o.forwardRef((function(e,n){const t=(0,d.Z)({props:e,name:"MuiButtonGroup"}),{children:s,className:u,color:p="primary",component:b="div",disabled:x=!1,disableElevation:y=!1,disableFocusRipple:Z=!1,disableRipple:_=!1,fullWidth:j=!1,orientation:w="horizontal",size:O="medium",variant:R="outlined"}=t,S=(0,r.Z)(t,v),C=(0,i.Z)({},t,{color:p,component:b,disabled:x,disableElevation:y,disableFocusRipple:Z,disableRipple:_,fullWidth:j,orientation:w,size:O,variant:R}),k=(e=>{const{classes:n,color:t,disabled:r,disableElevation:i,fullWidth:o,orientation:a,variant:s}=e,u={root:["root",s,"vertical"===a&&"vertical",o&&"fullWidth",i&&"disableElevation"],grouped:["grouped",`grouped${(0,c.Z)(a)}`,`grouped${(0,c.Z)(s)}`,`grouped${(0,c.Z)(s)}${(0,c.Z)(a)}`,`grouped${(0,c.Z)(s)}${(0,c.Z)(t)}`,r&&"disabled"]};return(0,l.Z)(u,f,n)})(C),E=o.useMemo((()=>({className:k.grouped,color:p,disabled:x,disableElevation:y,disableFocusRipple:Z,disableRipple:_,fullWidth:j,size:O,variant:R})),[p,x,y,Z,_,j,O,R,k.grouped]);return(0,m.jsx)(g,(0,i.Z)({as:b,role:"group",className:(0,a.Z)(k.root,u),ref:n,ownerState:C},S,{children:(0,m.jsx)(h.Z.Provider,{value:E,children:s})}))}))},8951:function(e,n,t){"use strict";t.d(n,{Z:function(){return h}});var r=t(3366),i=t(7462),o=t(7294),a=t(7192),l=t(1496),s=t(3616),c=t(5861),u=t(8979);function d(e){return(0,u.Z)("MuiDialogContentText",e)}(0,t(6087).Z)("MuiDialogContentText",["root"]);var p=t(5893);const f=["children"],b=(0,l.ZP)(c.Z,{shouldForwardProp:e=>(0,l.FO)(e)||"classes"===e,name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,n)=>n.root})({});var h=o.forwardRef((function(e,n){const t=(0,s.Z)({props:e,name:"MuiDialogContentText"}),o=(0,r.Z)(t,f),l=(e=>{const{classes:n}=e,t=(0,a.Z)({root:["root"]},d,n);return(0,i.Z)({},n,t)})(o);return(0,p.jsx)(b,(0,i.Z)({component:"p",variant:"body1",color:"text.secondary",ref:n,ownerState:o},t,{classes:l}))}))},7070:function(e,n,t){"use strict";t(7294);var r=t(2066),i=t(5893);n.Z=(0,r.Z)((0,i.jsx)("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft")},6686:function(e,n,t){"use strict";t(7294);var r=t(2066),i=t(5893);n.Z=(0,r.Z)((0,i.jsx)("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight")},5326:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/bulletins/crops/create",function(){return t(9764)}])},7513:function(e,n){"use strict";n.Z={container:{padding:"24px",width:"100%",position:"relative",minWidth:"0px",overflowWrap:"break-word",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"16px",borderColor:"#E2E8F0"},welcome:{border:"1px solid #DCEDC8",borderRadius:function(e){return e.spacing(1)},width:"100%",display:"grid",placeContent:"center",padding:"20px",marginTop:function(e){return e.spacing(1)},textAlign:"center","& h6":{lineHeight:"20px"}},summary:{border:"1px solid #DCEDC8",borderRadius:function(e){return e.spacing(1)},marginTop:function(e){return e.spacing(1)},padding:function(e){return e.spacing(3)}},selectionSummary:{minWidth:"100%",paddingLeft:{xs:0,lg:"16px"}},conditionLegend:{borderRadius:function(e){return e.spacing(1)},width:"100%",padding:function(e){return e.spacing(1)},border:"1px solid grey",textAlign:"center",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",float:"left"},autocomplete:{marginTop:function(e){return e.spacing(1)}},recSeasonal:{marginTop:function(e){return e.spacing(1)},"& p, ul":{fontSize:"14px"}},gridContainer:{marginTop:"24px",minHeight:500,width:1,"& .normal":{backgroundColor:"yellow"},"& .drier":{backgroundColor:"red"},"& .wetter":{backgroundColor:"blue"}},button:{color:"#FFFFFF",textTransform:"capitalize",fontSize:"14px",fontStyle:"normal",fontWeight:"normal",width:"80px",height:{xs:"40px",sm:"50px"}},pdfcontent:{ul:{paddingLeft:3}}}},3080:function(e,n,t){"use strict";var r=t(5893),i=t(7357),o=t(8456);n.Z=function(e){var n=e.text,t=void 0===n?"":n,a=e.size,l=void 0===a?24:a,s=e.children;return(0,r.jsxs)(i.Z,{sx:{width:"100%",textAlign:"center",height:"20vh"},children:[(0,r.jsxs)(i.Z,{sx:{width:"100%",textAlign:"center",marginTop:function(e){return e.spacing(12)},marginBottom:"32px",display:"flex",justifyContent:"center"},children:[(0,r.jsx)("span",{children:""!==t?t:"Loading..."})," \xa0",(0,r.jsx)(o.Z,{size:l})]}),s]})}},9764:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSG:function(){return oe},default:function(){return ae}});var r=t(4051),i=t.n(r),o=t(5893),a=t(7294),l=t(2848),s=t(1652),c=t(560),u=t(4680),d=t(8152),p=t(7682),f=t(7426),b=t(3059),h=t(1163),m=t(5697),v=t.n(m),g=t(1664),x=t(5675),y=t(6295),Z=t(7357),_=t(8456),j=t(1057),w=t(6863),O=t(657),R=t(1425),S=t(6580),C=t(8951),k=t(7645),E=t(7720),P=t(6886),M=t(1903),A=t(5861),W=t(8409),L=t(44),T=t(120),B=t(1033),N=t(3080),z=t(9758),F=t(7513);function $(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function I(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){$(e,n,t[n])}))}return e}function D(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var V=[{key:"sel_province",label:"Province"},{key:"sel_municipality",label:"Municipality"},{key:"sel_crop",label:"Crop"},{key:"sel_month",label:"Months"},{key:"sel_stage",label:"Crop Stages"},{key:"sel_activity",label:"Activities"}];var U=function(e){var n=function(e){var n=e.children,t=e.value,r=e.index,i=D(e,["children","value","index"]);return(0,o.jsx)("div",I({role:"tabpanel",hidden:t!==r,id:"simple-tabpanel-".concat(r),"aria-labelledby":"simple-tab-".concat(r)},i,{children:t===r&&(0,o.jsx)(Z.Z,{sx:{p:3},children:n})}))},t=function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}},r=(0,a.useRef)(!0),i=(0,h.useRouter)(),l=(0,a.useState)(0),s=l[0],c=l[1],u=e.sel_options,d=e.provinces,p=e.recommendations,b=e.onSelectItemChange,m=e.optsmunicipalities,$=e.optscrops,U=e.optsmonths,H=e.open,q=e.pdfPreview,G=e.handleSave,K=e.handlePreview,Y=e.toggleViewerOpen;(0,a.useEffect)((function(){return r.current=!0,function(){r.current=!1}}),[]);var J=function(){var e="Loading...";return d.length>0&&(e=null===u.sel_province?"Select a province":"Province"),e};return n.propTypes={children:v().node,index:v().number.isRequired,value:v().number.isRequired},(0,o.jsxs)("div",{children:[(0,o.jsxs)(O.Z,{open:H.savesuccess,"aria-labelledby":"data-saved-success","aria-describedby":"alert-dialog-description",children:[(0,o.jsx)(k.Z,{id:"data-saved-success",children:"Success"}),(0,o.jsx)(S.Z,{children:(0,o.jsx)(C.Z,{id:"alert-dialog-description",children:"Success! Bulletin report created."})}),(0,o.jsx)(R.Z,{children:(0,o.jsx)(j.Z,{onClick:function(){i.push("/admin/bulletins/crops/view/?docId=".concat(H.docId))},autoFocus:!0,children:"OK"})})]}),(0,o.jsxs)(O.Z,{open:H.preview,maxWidth:"lg",fullWidth:!0,"aria-labelledby":"data-saved-success","aria-describedby":"alert-dialog-description",children:[(0,o.jsx)(k.Z,{id:"data-saved-success",children:""!==q.filename?"Bulletin Preview - ".concat(q.filename):"Bulletin Preview"}),(0,o.jsx)(S.Z,{sx:{padding:0,overflow:"hidden"},children:(0,o.jsx)(Z.Z,{id:"alert-dialog-description",children:u.loading?(0,o.jsx)("div",{style:{width:"100%",height:"90vh",textAlign:"center"},children:(0,o.jsx)(N.Z,{text:"Loading Preview...",children:(0,o.jsx)(x.default,{unoptimized:!0,src:(0,T.assetPrefixer)("images/icons/data-processing-128.png"),height:100,width:100,loader:T.imageLoader,alt:"Loading Preview"})})}):""!==u.error?(0,o.jsx)("div",{style:{width:"100%",height:"100vh"},children:(0,o.jsx)(B.Z,{message:u.error})}):(0,o.jsx)("embed",{src:q.url,style:{width:"100%",height:"70vh"}})})}),(0,o.jsx)(R.Z,{children:(0,o.jsx)(j.Z,{variant:"contained",onClick:Y,autoFocus:!0,children:"OK"})})]}),(0,o.jsxs)(P.ZP,{container:!0,sx:F.Z.container,children:[(0,o.jsxs)(Z.Z,{sx:{marginBottom:"32px"},children:[(0,o.jsx)(A.Z,{variant:"h5",children:"Create Crop Recommendations Bulletins"}),(0,o.jsxs)("p",{children:["Create ",(0,o.jsx)("strong",{children:"Seasonal"})," crop recommendations bulletins. Finalized bulletins will be automatically uploaded to the site for public download."]})]}),(0,o.jsxs)(P.ZP,{item:!0,sx:F.Z.item,xs:12,lg:4,children:[(0,o.jsx)(A.Z,{variant:"h6",children:"Selection Options"}),(0,o.jsx)(y.Z,{disablePortal:!0,id:"province",value:u.sel_province,disabled:0===d.length||u.loading,options:d,sx:F.Z.autocomplete,size:"small",PaperComponent:z.Z,renderInput:function(e){return(0,o.jsx)(M.Z,I({},e,{label:J()}))},isOptionEqualToValue:function(e,n){return e.label===n.label},onChange:function(e,n){return b(e,I({},n,{from:"province"}))}}),(0,o.jsx)(y.Z,{disablePortal:!0,id:"municipality",value:u.sel_municipality,disabled:0===m.length||u.loading,options:m,sx:F.Z.autocomplete,size:"small",PaperComponent:z.Z,renderInput:function(e){return(0,o.jsx)(M.Z,I({},e,{label:null===u.sel_municipality?"Select a municipality":"Municipality"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},onChange:function(e,n){return b(e,I({},n,{from:"municipality"}))}}),(0,o.jsx)(y.Z,{disablePortal:!0,id:"crop",value:u.sel_crop,disabled:0===$.length||u.loading,options:$,sx:F.Z.autocomplete,size:"small",PaperComponent:z.Z,renderInput:function(e){return(0,o.jsx)(M.Z,I({},e,{label:null===u.sel_crop?"Select a crop type":"Crop"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},getOptionDisabled:function(e){return e.disabled},onChange:function(e,n){return b(e,I({},n,{from:"crop"}))}}),(0,o.jsx)(y.Z,{disablePortal:!0,id:"month",value:u.sel_month,disabled:0===U.length||0===$.length||u.loading||null===u.sel_crop,options:U,sx:F.Z.autocomplete,size:"small",PaperComponent:z.Z,renderInput:function(e){return(0,o.jsx)(M.Z,I({},e,{label:null===u.sel_month?"Select a Month":"Month"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},getOptionDisabled:function(e){return e.disabled},onChange:function(e,n){return b(e,I({},n,{from:"month"}))}})]}),(0,o.jsx)(P.ZP,{item:!0,sx:F.Z.item,xs:12,lg:8,children:(0,o.jsxs)(Z.Z,{sx:F.Z.selectionSummary,children:[(0,o.jsx)(A.Z,{variant:"h6",children:"Selection Summary"}),null===u.sel_province?(0,o.jsxs)(Z.Z,{sx:F.Z.welcome,children:[(0,o.jsx)(x.default,{unoptimized:!0,src:(0,T.assetPrefixer)("images/icons/finance.svg"),height:85,width:85,loader:T.imageLoader,alt:"Empty data"}),(0,o.jsxs)(Z.Z,{sx:{marginTop:"16px"},children:[(0,o.jsx)(A.Z,{variant:"subtitle2",children:"Crop Recommendations PDF Bulletins Creator"}),(0,o.jsx)(A.Z,{variant:"subtitle2",children:"Please select a province to start."})]})]}):(0,o.jsx)(Z.Z,{sx:F.Z.summary,children:V.map((function(e,n){return(0,o.jsxs)("div",{children:[(0,o.jsxs)(A.Z,{variant:"subtitle2",style:{display:"inline-block"},children:[e.label,": \xa0"]}),(0,o.jsx)(A.Z,{variant:"body2",style:{display:"inline-block"},children:null!==u[e.key]?["sel_stage","sel_activity"].includes(e.key)?u[e.key].map((function(n,t){return"".concat(n.label).concat(t<u[e.key].length-1?", ":"")})):u[e.key].label:""})]},"selected-".concat(n))}))})]})})]}),(0,o.jsxs)(P.ZP,{container:!0,sx:F.Z.container,gap:3,style:{marginTop:"24px"},children:[(0,o.jsxs)(P.ZP,{item:!0,sx:F.Z.item,xs:12,lg:12,children:[(0,o.jsx)(A.Z,{variant:"h6",children:"Crop Recommendations"}),p.length>0&&(0,o.jsxs)(Z.Z,{children:[(0,o.jsxs)(Z.Z,{sx:{display:{md:"block",lg:"flex"}},children:[(0,o.jsxs)(A.Z,{variant:"h5",sx:{display:0===u.sel_activity.length?"none":"block",flexGrow:{xs:12,sm:3}},children:[u.sel_crop.label," Recommendations"]}),(0,o.jsx)(Z.Z,{sx:{flexGrow:{xs:12,sm:1}},children:null!==u.sel_month&&(0,o.jsxs)(Z.Z,{sx:F.Z.conditionLegend,style:{color:[f.MW.ABOVE_NORMAL.label,f.MW.WAY_BELOW_NORMAL.label].includes(u.sel_condition.label)?"#fff":"#000",backgroundColor:f.tN[u.sel_condition.label]},children:[(0,o.jsx)(A.Z,{variant:"subtitle2",children:"Seasonal Weather Condition"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("span",{children:u.sel_month.label})," \xa0",(0,o.jsxs)("span",{children:[u.sel_condition.format," ","(",u.sel_condition.id,"%)"]})]})]})})]}),(0,o.jsxs)(Z.Z,{sx:{width:"100%",marginTop:{xs:"85px",lg:"0px"}},children:[(0,o.jsx)(Z.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,o.jsxs)(W.Z,{value:s,onChange:function(e,n){c(n)},"aria-label":"basic tabs example",children:[(0,o.jsx)(L.Z,I({label:"PDF FORM"},t(0))),(0,o.jsx)(L.Z,I({label:"SMS FORM"},t(1)))]})}),(0,o.jsx)(n,{value:s,index:0,children:p.map((function(e,n){var t="Rice"===u.sel_crop.label?"(".concat(e.crop,")"):"";return(0,o.jsxs)(Z.Z,{sx:F.Z.recSeasonal,children:[(0,o.jsxs)(A.Z,{variant:"h5",children:[e.stage," - ",e.activity," ",t]}),e.recommendations().map((function(e,t){return e.ul?(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:e.id}),e.subs.length>0&&(0,o.jsx)("ul",{children:e.subs.map((function(e,t){return(0,o.jsx)("li",{children:e},"sub-".concat(n,"-").concat(t))}))})]},"main-".concat(n,"-").concat(t)):(0,o.jsx)("p",{children:e.id},"main-".concat(n,"-").concat(t))}))]},"rec-".concat(n))}))}),(0,o.jsx)(n,{value:s,index:1,children:p.reduce((function(e,n){return e+=n.smsRecommendations()+" "}),"")})]})]})]}),(0,o.jsxs)(Z.Z,{sx:{marginBottom:"16px",width:"100%",display:p.length>0?"block":"none"},children:[(0,o.jsx)("br",{}),(0,o.jsx)(E.Z,{}),(0,o.jsx)("br",{}),""!==u.error&&(0,o.jsxs)(A.Z,{variant:"caption",sx:{color:"red"},children:["Error: ",u.error]}),(0,o.jsxs)(w.Z,{size:"large","aria-label":"large button group",sx:{display:"flex",justifyContent:"flex-end",marginTop:"8px"},children:[(0,o.jsx)(g.default,{href:"/admin/bulletins/crops",passHref:!0,children:(0,o.jsx)(j.Z,{disabled:u.loading,children:"Cancel"})}),(0,o.jsxs)(j.Z,{disabled:u.loading,onClick:K,children:[(0,o.jsx)("span",{style:{display:u.loading?"none":"block"},children:"Preview"})," ","\xa0",(0,o.jsx)(_.Z,{size:20,color:"secondary",sx:{display:u.loading?"block":"none"}})]}),(0,o.jsx)(j.Z,{variant:"contained",onClick:G,disableElevation:!0,disabled:u.loading,children:"Save"})]})]})]})]})},H=t(2530);function q(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function G(e,n,t,r,i,o,a){try{var l=e[o](a),s=l.value}catch(c){return void t(c)}l.done?n(s):Promise.resolve(s).then(r,i)}function K(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var o=e.apply(n,t);function a(e){G(o,r,i,a,l,"next",e)}function l(e){G(o,r,i,a,l,"throw",e)}a(void 0)}))}}function Y(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function J(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){Y(e,n,t[n])}))}return e}function X(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,o=[],a=!0,l=!1;try{for(t=t.call(e);!(a=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(s){l=!0,i=s}finally{try{a||null==t.return||t.return()}finally{if(l)throw i}}return o}}(e,n)||ne(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(e){return function(e){if(Array.isArray(e))return q(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ne(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ee=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function ne(e,n){if(e){if("string"===typeof e)return q(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?q(e,n):void 0}}var te={sel_province:null,sel_municipality:null,sel_crop:null,sel_stage:[],sel_activity:[],sel_month:null,sel_condition:{id:0,from:"weather_condition",label:f.MW.WAY_BELOW_NORMAL.label},loading:!1,error:"",success:""},re={url:"",filename:""},ie={preview:!1,savesuccess:!1,docId:""};var oe=!0,ae=(0,b.Z)((function(e){var n=X((0,p.ky)(u.o.STATIC_RECOMMENDATIONS,"data"),2),t=n[0],r=n[1],b=(0,p.m$)(c.M.WEATHER_FORECASTS,"bicol",c.M.SUB_SEASONAL,"name"),h=b.documents,m=b.loading,v=(0,a.useState)([]),g=v[0],x=v[1],y=(0,a.useState)([]),Z=y[0],_=y[1],j=(0,a.useState)([]),w=j[0],O=j[1],R=(0,a.useState)([]),S=R[0],C=R[1],k=(0,a.useState)([]),E=k[0],P=k[1],M=(0,a.useState)({}),A=M[0],W=M[1],L=(0,a.useState)(te),T=L[0],B=L[1],N=(0,a.useState)([]),z=N[0],F=N[1],$=(0,a.useState)([]),I=$[0],D=$[1],V=(0,a.useState)(re),q=V[0],G=V[1],Y=(0,a.useState)([]),ne=Y[0],oe=Y[1],ae=(0,a.useState)(ie),le=ae[0],se=ae[1],ce=(0,a.useRef)(!1);(0,a.useEffect)((function(){return ce.current=!0,function(){ce.current=!1}}),[]),(0,a.useEffect)((function(){if(e.municipalities.length>0&&!m&&!r){var n={};h.forEach((function(e){var t=e.name.split("_").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" ");n[t]={},e.months.forEach((function(e){var r=Object.values(f.MW).find((function(n){return n.label===e.con}));n[t][e.mo]={label:e.con,format:r.sync,val:e.val}}))}));var t=[];h[0].mos.forEach((function(e){t.push({id:f.re[e.toUpperCase()].code,label:f.re[e.toUpperCase()].format,disabled:!1})}));var i={},o=[];e.municipalities.forEach((function(e,n){void 0===i[e.province]?(o.push({id:n,label:e.province}),i[e.province]=[{id:0,label:e.name}]):i[e.province].push({id:i[e.province].length,label:e.name})})),ce.current&&(_(i),x(o),oe(t),W(n))}}),[e.municipalities,h,m,r]);var ue=function(e){var n="";switch(e){case f.MW.WAY_BELOW_NORMAL.label:n="drier";break;case f.MW.BELOW_NORMAL.label:case f.MW.NORMAL.label:n="normal";break;case f.MW.ABOVE_NORMAL.label:n="wetter"}return n},de=function(){var e=K(i().mark((function e(n,r){var o,a,c,u,d,p,b,h,m,v,g,x,y,_,j,R,k,E,M;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.from,a=r.label,n&&n.preventDefault(),P([]),G(re),!(["cropstage","activity"].includes(o)?Object.keys(r).length>1:Object.keys(r).includes("id"))){e.next=64;break}e.t0=o,e.next="province"===e.t0?9:"municipality"===e.t0?13:"crop"===e.t0?44:"month"===e.t0?51:61;break;case 9:return B(J({},T,{sel_province:r,sel_municipality:null,sel_crop:null,sel_stage:[],sel_activity:[],sel_month:null})),F(Z[a]),D([]),e.abrupt("break",62);case 13:return c=[],e.prev=14,B(J({},T,{loading:!0,error:""})),e.next=18,(0,s.$K)(T.sel_province.label,a);case 18:u=e.sent,((c=u.map((function(e){return e.crop})).filter((function(e,n,t){return t.indexOf(e)===n}))).includes("Rainfed Rice")||c.includes("Irrigated Rice"))&&c.push("Rice"),ce.current&&O((function(e){return u})),e.next=27;break;case 24:e.prev=24,e.t1=e.catch(14),B((function(n){return J({},n,{loading:!1,error:e.t1.message})}));case 27:if(0!==c.length){e.next=30;break}return B((function(e){return J({},e,{loading:!1,error:"There was an error loading data."})})),e.abrupt("return");case 30:return e.prev=30,e.next=33,(0,l.OP)(T.sel_province.label,a);case 33:d=e.sent,p=[],(b=d.map((function(e){return e.crop})).filter((function(e,n,t){return t.indexOf(e)===n}))).forEach((function(e,n){p.push({id:n,label:e,disabled:!c.includes(e)})})),ce.current&&(h=0===b.length?{id:"novalues",label:"No crop types for ".concat(a)}:null,B(J({},T,{sel_municipality:r,sel_crop:h,sel_stage:[],sel_activity:[],sel_month:null,loading:!1,error:""})),D((function(e){return p})),C((function(e){return d}))),e.next=43;break;case 40:e.prev=40,e.t2=e.catch(30),B((function(n){return J({},n,{loading:!1,error:e.t2.message})}));case 43:return e.abrupt("break",62);case 44:return B(J({},T,{sel_crop:r,sel_stage:[],sel_activity:[],sel_month:null})),m=[],S.filter((function(e){return e.crop===a&&e.province===T.sel_province.label&&e.municipality===T.sel_municipality.label})).forEach((function(e){ne.forEach((function(n){""===e[n.id]||m.includes(n.id)||m.push(n.id)}))})),v=Q(ne),ne.forEach((function(e,n){v[n].disabled=!m.includes(e.id)})),oe(v),e.abrupt("break",62);case 51:return g=A[T.sel_province.label][r.id],x=g.label,y=g.val,_=g.format,j=[],R=[],S.forEach((function(e,n){var t=Object.values(f.re).find((function(e){return e.format===r.label})).code;if(""!==e[t]&&e.crop===T.sel_crop.label)for(var i=function(e){o[e].length>0&&!j.includes(o[e])&&(j.push(o[e]),w.filter((function(n){return n.stage===f.MZ[o[e].toUpperCase()]&&("Rice"===T.sel_crop.label?["Irrigated Rice","Rainfed Rice"].includes(n.crop):n.crop===T.sel_crop.label)})).map((function(e){return e.activity})).filter((function(e,n,t){return t.indexOf(e)==n})).length>0&&R.push({id:R.length,label:f.MZ[o[e].toUpperCase()]}))},o=e[t].split(","),a=0;a<o.length;a+=1)i(a)})),k=w.filter((function(e){return R.map((function(e){return e.label})).includes(e.stage)&&("Rice"===T.sel_crop.label?["Irrigated Rice","Rainfed Rice"].includes(e.crop):e.crop===T.sel_crop.label)})).map((function(e){return{activity:e.activity,stage:e.stage}})).filter((function(e,n,t){return t.map((function(e){return e.activity})).indexOf(e.activity)===n})),E=k.reduce((function(e,n,t){return e.includes(n.activity)||e.push({id:t,label:n.activity,stage:n.stage}),Q(e)}),[]),B(J({},T,{sel_month:r,sel_stage:R,sel_activity:E,sel_condition:{id:y,format:_,label:x}})),M=w.filter((function(e){return E.map((function(e){return e.label})).includes(e.activity)&&R.map((function(e){return e.label})).includes(e.stage)&&("Rice"===T.sel_crop.label?["Irrigated Rice","Rainfed Rice"].includes(e.crop):e.crop===T.sel_crop.label)})).map((function(e){return{province:e.province,municipality:e.municipality,crop:e.crop,stage:e.stage,activity:e.activity,recommendations:function(){switch(x){case f.MW.BELOW_NORMAL.label:case f.MW.NORMAL.label:return JSON.parse(e.normal).map((function(e){return{id:t.mains.find((function(n){return n.id===e.id})).description,ul:e.ul,subs:e.subs.map((function(e){return t.subs.find((function(n){return n.id===e})).description}))}}));case f.MW.ABOVE_NORMAL.label:return JSON.parse(e.wetter).map((function(e){return{id:t.mains.find((function(n){return n.id===e.id})).description,ul:e.ul,subs:e.subs.map((function(e){return t.subs.find((function(n){return n.id===e})).description}))}}));case f.MW.WAY_BELOW_NORMAL.label:return JSON.parse(e.drier).map((function(e){return{id:t.mains.find((function(n){return n.id===e.id})).description,ul:e.ul,subs:e.subs.map((function(e){return t.subs.find((function(n){return n.id===e})).description}))}}))}},smsRecommendations:function(){var n="".concat(ue(x),"_sms");return void 0!==e[n]?t.sms.find((function(t){return t.id===e[n]})).description:""}}})),P(M),e.abrupt("break",62);case 61:return e.abrupt("break",62);case 62:e.next=65;break;case 64:"province"===o?(B(te),F([]),D([])):"municipality"===o?(B(J({},T,{sel_municipality:null,sel_crop:null,sel_stage:[],sel_activity:[],sel_month:null})),D([])):"crop"===o?B(J({},T,{sel_crop:null,sel_stage:[],sel_activity:[],sel_month:null})):"month"===o&&B(J({},T,{sel_month:null,sel_stage:[],sel_activity:[]}));case 65:case"end":return e.stop()}}),e,null,[[14,24],[30,40]])})));return function(n,t){return e.apply(this,arguments)}}(),pe=function(){var e=K(i().mark((function e(){var n,t,r,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B((function(e){return J({},e,{loading:!0,error:"",success:""})})),n=Object.values(f.re).find((function(e){return e.format===T.sel_month.label})).code,e.prev=2,t={region:"bicol",province:T.sel_province.label,municipality:T.sel_municipality.label,crop:T.sel_crop.label,month:n,stages:T.sel_stage.map((function(e){return e.label})),activities:T.sel_activity.map((function(e){return e.label})),operation:"create"},B((function(e){return J({},e,{loading:!0,error:""})})),e.next=7,(0,d.Zn)(t);case 7:r=e.sent,B((function(e){return J({},e,{loading:!1,success:"Bulletin report created."})})),se(J({},ie,{savesuccess:!0,docId:r.id})),e.next=18;break;case 12:e.prev=12,e.t0=e.catch(2),o="",void 0!==e.t0.response&&(o=void 0!==e.t0.response.data&&"[object Blob]"===ee(e.t0.response.data)?e.t0.response.data:""),""===o&&(o=e.t0.message),B((function(e){return J({},e,{loading:!1,error:o})}));case 18:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}(),fe=function(){var e=K(i().mark((function e(){var n,t,r,o,a,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===q.url){e.next=3;break}return se(J({},ie,{preview:!0})),e.abrupt("return");case 3:return B((function(e){return J({},e,{loading:!0,error:"",success:""})})),n=Object.values(f.re).find((function(e){return e.format===T.sel_month.label})).code,e.prev=5,t={region:"bicol",province:T.sel_province.label,municipality:T.sel_municipality.label,crop:T.sel_crop.label,month:n,stages:T.sel_stage.map((function(e){return e.label})),activities:T.sel_activity.map((function(e){return e.label})),operation:"preview"},se(J({},ie,{preview:!0})),B((function(e){return J({},e,{loading:!0,error:""})})),e.next=11,(0,d.pl)(t);case 11:r=e.sent,o=new Blob([r],{type:"application/pdf"}),(a={}).href=URL.createObjectURL(o),a.download="".concat(T.sel_province.label,"_").concat(T.sel_municipality.label,"-").concat(T.sel_crop.label,".pdf"),G((function(e){return J({},e,{url:a.href,filename:a.download})})),B((function(e){return J({},e,{loading:!1,success:"Bulletin preview created."})})),e.next=26;break;case 20:e.prev=20,e.t0=e.catch(5),l="",void 0!==e.t0.response&&(l=void 0!==e.t0.response.data&&"[object Blob]"===ee(e.t0.response.data)?e.t0.response.data:""),""===l&&(l=e.t0.message),B((function(e){return J({},e,{loading:!1,error:l})}));case 26:case"end":return e.stop()}}),e,null,[[5,20]])})));return function(){return e.apply(this,arguments)}}();return(0,o.jsx)(H.Z,{loading:e.loading,user:e.user,onBtnLogoutClick:e.onBtnLogoutClick,accLevel:f.DW.ADMIN,children:(0,o.jsx)(U,{sel_options:T,open:le,provinces:g,recommendations:E,optsmunicipalities:z,optscrops:I,optsmonths:ne,pdfPreview:q,conditions:[{id:"norm",label:"Normal Conditions"},{id:"wet",label:"Wetter than Normal Conditions"},{id:"dry",label:"Drier than Normal Conditions"}],onSelectItemChange:de,handlePreview:fe,handleSave:pe,toggleViewerOpen:function(){se((function(e){return!e}))}})})}))}},function(e){e.O(0,[135,669,203,572,728,152,113,774,888,179],(function(){return n=5326,e(e.s=n);var n}));var n=e.O();_N_E=n}]);
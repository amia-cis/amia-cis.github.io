(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7970],{37645:function(e,n,t){"use strict";var r=t(87462),o=t(63366),i=t(67294),l=t(86010),a=t(27192),s=t(15861),c=t(11496),u=t(33616),p=t(4472),d=t(34182),f=t(85893);const m=["className","id"],g=(0,c.ZP)(s.Z,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,n)=>n.root})({padding:"16px 24px",flex:"0 0 auto"}),h=i.forwardRef((function(e,n){const t=(0,u.Z)({props:e,name:"MuiDialogTitle"}),{className:s,id:c}=t,h=(0,o.Z)(t,m),b=t,v=(e=>{const{classes:n}=e;return(0,a.Z)({root:["root"]},p.a,n)})(b),{titleId:x=c}=i.useContext(d.Z);return(0,f.jsx)(g,(0,r.Z)({component:"h2",className:(0,l.Z)(v.root,s),ownerState:b,ref:n,variant:"h6",id:x},h))}));n.Z=h},40108:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/bulletins/crops/seasonal/create",function(){return t(83931)}])},83931:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSG:function(){return ge},default:function(){return he}});var r=t(34051),o=t.n(r),i=t(85893),l=t(67294),a=t(9473),s=t(30560),c=t(87006),u=t(87682),p=t(53063),d=t(12671),f=t(61690),m=t(59111),g=t(23766),h=t(76490),b=t(15113),v=t(33050),x=t(68193);function y(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function j(e){var n=(0,l.useState)([]),t=n[0],r=n[1],o=(0,l.useState)(""),i=o[0],a=o[1];(0,l.useEffect)((function(){if(a(""),e.length>0)try{var n=e.map((function(e){return{impact:e.impact,impact_tagalog:e.impact_tagalog}})).filter((function(e){return""!==e.impact&&""!==e.impact_tagalog}));return n=c(n),void r([{impact:s(n.impact),impact_tagalog:s(n.impact_tagalog)}])}catch(t){a(t)}}),[e]);var s=function(e){var n="-",t=e.reduce((function(e,t){return t.includes("<p>")?("list"===n&&(e+="</ul>"),e+=t,n="p"):(["-","p"].includes(n)&&(e+="<ul>"),e+=t,n="list"),e}),"");return"list"===n&&(t+="</ul>"),t},c=function(e){var n=[];return e.reduce((function(e,t){return Object.keys(e).forEach((function(r){var o=t[r].replace(/<ul>/g,"");(o=(o=o.replace(/<\/ul>/g,"")).replace(/<li>/g,"")).split("</li>").forEach((function(t){t.includes("<p>")?t.replace(/<p>/g,"").split("</p>").forEach((function(t){n.includes(t)||""===t||(n.push(t),e[r].push("<p>".concat(t,"</p>")))})):n.includes(t)||""===t||(n.push(t),e[r].push("<li>".concat(t,"</li>")))}))})),function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){y(e,n,t[n])}))}return e}({},e)}),{impact:[],impact_tagalog:[]})};return{group:t,error:i}}var _=t(99306),Z=t(41375),S=t(901),O=t(16013),w=t(47426),E=t(27392),P=t(95243),C=t(11163),k=t(45697),A=t.n(k),T=t(21023),L=t(93946),R=t(41664),I=t(76295),N=t(87357),B=t(98456),M=t(11057),z=t(56863),F=t(87918),D=t(67720),G=t(86886),W=t(61903),q=t(15861),V=t(88409),H=t(40044),U=t(11829),Y=t(19227),X=t(22094),$=t(27692),K=t(79316),J=t(22757);function Q(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ee(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){Q(e,n,t[n])}))}return e}function ne(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function te(e){var n=function(e){var n=e.children,t=e.value,r=e.index,o=ne(e,["children","value","index"]);return(0,i.jsx)("div",ee({role:"tabpanel",hidden:t!==r,id:"simple-tabpanel-".concat(r),"aria-labelledby":"simple-tab-".concat(r)},o,{children:t===r&&(0,i.jsx)(N.Z,{sx:{p:3},children:n})}))},t=function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}},r=(0,l.useState)(!1),o=r[0],s=r[1],c=(0,l.useRef)(!0),u=(0,C.useRouter)(),p=(0,a.I0)(),f=(0,l.useState)(0),m=f[0],g=f[1],h=e.sel_options,b=e.recommendations,v=e.recommendationsImpacts,x=e.optsprovinces,y=e.optsmunicipalities,j=e.optsactivities,_=e.optscrops,Z=e.optsmonths,S=e.monthForecast,O=e.open,E=e.isTagalog,P=e.loading,k=e.isloadingreport,Q=e.message,te=e.smstext,re=e.pdfPreview,oe=e.handleSave,ie=e.handlePreview,le=e.togglePrompt,ae=e.toggleViewerOpen,se=e.toggleGlobalLanguage,ce=e.onSelectItemChange,ue=e.resetSelections;(0,l.useEffect)((function(){return c.current=!0,function(){c.current=!1}}),[]),(0,l.useEffect)((function(){null===h.sel_month&&!0===o&&s(!1)}),[h.sel_month,o]);var pe=function(){p((0,d.s_)()),u.push("/admin/bulletins/crops/report/view/?docId=".concat(Q.docId))},de=function(){var e="Loading...";return x.length>0&&(e=null===h.sel_province?"Select a province":"Province"),e};return n.propTypes={children:A().node,index:A().number.isRequired,value:A().number.isRequired},(0,i.jsxs)("div",{children:[(0,i.jsx)(Y.Z,{isOpen:Q.isOpen,maxWidth:"xs",openButtonText:null,title:Q.title,contentText:Q.msg,loading:Q.loading,modalCancelHandlerCB:function(){Q.savesuccess?pe():le()},modalConfirmHandlerCB:function(){Q.savesuccess?pe():oe()}}),(0,i.jsx)(X.Z,{open:O,pdfPreview:re,error:h.error,loading:h.loading,toggleViewerOpen:ae}),(0,i.jsxs)(G.ZP,{container:!0,sx:J.Z.container,children:[(0,i.jsxs)(N.Z,{sx:J.Z.headerText,children:[(0,i.jsxs)(N.Z,{children:[(0,i.jsx)(q.Z,{variant:"h5",children:"Regional Seasonal Climate Outlook and Advisory Crop Recommendations Bulletin"}),(0,i.jsxs)("p",{children:["Create ",(0,i.jsx)("strong",{children:"Seasonal"})," crop recommendations bulletins. Finalized bulletins will be automatically uploaded to the site for public download."]})]}),(0,i.jsx)(N.Z,{children:(0,i.jsx)(L.Z,{"aria-label":"exit",size:"medium",children:(0,i.jsx)(R.default,{href:"/admin/bulletins/crops",passHref:!0,children:(0,i.jsx)(T.Z,{fontSize:"inherit"})})})})]}),(0,i.jsxs)(G.ZP,{item:!0,sx:J.Z.item,xs:12,lg:4,children:[(0,i.jsx)(q.Z,{variant:"h6",children:"Selection Options"}),(0,i.jsx)(I.Z,{disablePortal:!0,id:"province",size:"small",value:h.sel_province,disabled:0===x.length||P,options:x,sx:J.Z.autocomplete,PaperComponent:U.Z,renderInput:function(e){return(0,i.jsx)(W.Z,ee({},e,{label:de()}))},isOptionEqualToValue:function(e,n){return e.label===n},onChange:function(e,n){return ce(e,ee({},n,{from:"province"}))}}),(0,i.jsx)(I.Z,{disablePortal:!0,id:"municipality",size:"small",value:h.sel_municipality,disabled:0===y.length||P,options:y,sx:J.Z.autocomplete,PaperComponent:U.Z,renderInput:function(e){return(0,i.jsx)(W.Z,ee({},e,{label:null===h.sel_municipality?"Select a municipality":"Municipality"}))},isOptionEqualToValue:function(e,n){return e.label===n},onChange:function(e,n){return ce(e,ee({},n,{from:"municipality"}))}}),(0,i.jsx)(I.Z,{disablePortal:!0,id:"crop",size:"small",value:h.sel_crop,disabled:0===_.length||P,options:_,sx:J.Z.autocomplete,PaperComponent:U.Z,renderInput:function(e){return(0,i.jsx)(W.Z,ee({},e,{label:null===h.sel_crop?"Select a crop type":"Crop"}))},isOptionEqualToValue:function(e,n){return e.label===n},getOptionDisabled:function(e){return e.disabled},onChange:function(e,n){return ce(e,ee({},n,{from:"crop"}))}}),(0,i.jsx)(I.Z,{disablePortal:!0,id:"month",size:"small",value:h.sel_month,disabled:0===Z.length||null===h.sel_crop||P,options:Z,sx:J.Z.autocomplete,PaperComponent:U.Z,renderInput:function(e){return(0,i.jsx)(W.Z,ee({},e,{label:null===h.sel_month?"Select a Month":"Month"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},getOptionDisabled:function(e){return e.disabled},onChange:function(e,n){ce(e,ee({},n,{from:"month"})),s(!1)}}),(0,i.jsxs)(z.Z,{disableElevation:!0,size:"small","aria-label":"outlined button controls group",disabled:k||null===h.sel_municipality||null===h.sel_crop||null===h.sel_month,sx:{marginTop:"16px",float:"right"},children:[(0,i.jsx)(M.Z,{variant:"outlined",disabled:P||k,onClick:ue,children:"Reset"}),(0,i.jsx)(M.Z,{variant:"contained",onClick:function(){return s((function(e){return!e}))},disabled:P||null===h.sel_month||o,children:"Generate"})]})]}),(0,i.jsx)(G.ZP,{item:!0,sx:J.Z.item,xs:12,lg:8,children:(0,i.jsx)(K.Z,{selecteditems:h,farmoperations:j.map((function(e){return e.label})).toString().split(",").join(", "),loading:P})})]}),(0,i.jsxs)(G.ZP,{container:!0,sx:J.Z.container,gap:3,style:{marginTop:"24px"},children:[(0,i.jsxs)(G.ZP,{item:!0,sx:J.Z.item,xs:12,lg:12,children:[(0,i.jsxs)(N.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)(q.Z,{variant:"h6",children:"Crop Recommendations"}),(0,i.jsx)(B.Z,{size:24,color:"primary",sx:{display:P?"block":"none"}})]}),null!==h.sel_crop&&null!==h.sel_month&&o&&(0,i.jsxs)(N.Z,{children:[(0,i.jsxs)(N.Z,{sx:{display:{md:"block",lg:"flex"}},children:[(0,i.jsxs)(q.Z,{variant:"h5",sx:{display:"block",flexGrow:{xs:12,sm:3}},children:[h.sel_crop," Recommendations"]}),(0,i.jsx)(N.Z,{sx:{flexGrow:{xs:12,sm:1}},children:null!==h.sel_month&&(0,i.jsxs)(N.Z,{sx:J.Z.conditionLegend,style:{color:[w.MW.ABOVE_NORMAL.label,w.MW.WAY_BELOW_NORMAL.label].includes(S.forecast)?"#fff":"#000",backgroundColor:w.tN[S.forecast]},children:[(0,i.jsx)(q.Z,{variant:"subtitle2",children:"Rainfall Condition"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{children:h.sel_month.label})," \xa0",(0,i.jsxs)("span",{children:[S.label," ","(",S.value,"%)"]})]})]})})]}),(0,i.jsxs)(N.Z,{sx:{width:"100%",marginTop:{xs:"85px",lg:"0px"},"& hr":{marginBottom:"32px"}},children:[(0,i.jsx)(N.Z,{sx:{borderBottom:1,borderColor:"divider","& hr":{color:"red"}},children:(0,i.jsxs)(V.Z,{value:m,onChange:function(e,n){g(n)},"aria-label":"basic tabs example",children:[(0,i.jsx)(H.Z,ee({label:"PDF FORM"},t(0))),(0,i.jsx)(H.Z,ee({label:"SMS FORM"},t(1)))]})}),(0,i.jsxs)(n,{value:m,index:0,children:[(0,i.jsxs)(N.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[(0,i.jsx)(q.Z,{variant:"h4",children:"Impact Outlooks"}),(0,i.jsx)(F.Z,{size:"medium",variant:"outlined",label:E?"English":"Tagalog",onClick:function(){return se()},sx:{width:"90px"}})]}),(0,i.jsx)(N.Z,{sx:J.Z.recSeasonal,children:(0,i.jsx)($.Z,{recommendations:v,title:"",subtitle:"",titleFontSize:"h6",recommendationsEng:"impact",recommendationsTag:"impact_tagalog",isTagalog:E,isShowTitle:!1})}),(0,i.jsx)("hr",{}),(0,i.jsx)(q.Z,{variant:"h4",children:"Practices"}),Object.keys(b).map((function(e){return Object.keys(b[e]).map((function(n,t){return(0,i.jsxs)(N.Z,{sx:J.Z.recSeasonal,children:[(0,i.jsxs)(q.Z,{variant:"h6",children:[e," - ",n]}),(0,i.jsx)($.Z,{recommendations:b[e][n],title:"",subtitle:"",titleFontSize:"h6",recommendationsEng:"practice",recommendationsTag:"practice_tagalog",isTagalog:E})]},"rec-".concat(t))}))}))]}),(0,i.jsx)(n,{value:m,index:1,children:te})]})]})]}),(0,i.jsxs)(N.Z,{sx:{marginBottom:"16px",width:"100%",display:o&&Object.keys(b).length>0?"block":"none"},children:[(0,i.jsx)("br",{}),(0,i.jsx)(D.Z,{}),(0,i.jsx)("br",{}),""!==h.error&&(0,i.jsxs)(q.Z,{variant:"caption",sx:{color:"red"},children:["Error: ",h.error]}),(0,i.jsxs)(z.Z,{size:"large","aria-label":"large button group",disabled:k,sx:{display:"flex",justifyContent:"flex-end",marginTop:"8px"},children:[(0,i.jsx)(R.default,{href:"/admin/bulletins/crops",passHref:!0,children:(0,i.jsx)(M.Z,{disabled:h.loading,children:"Cancel"})}),(0,i.jsxs)(M.Z,{disabled:h.loading,onClick:ie,children:[(0,i.jsx)("span",{style:{display:k?"none":"block"},children:"Preview"})," ","\xa0",(0,i.jsx)(B.Z,{size:24,color:"secondary",sx:{display:k?"block":"none"}})]}),(0,i.jsx)(M.Z,{variant:"contained",onClick:le,disableElevation:!0,disabled:h.loading,children:"Save"})]})]})]})]})}te.propTypes={optsprovinces:A().array,optsmunicipalities:A().array,optscrops:A().array,optsmonths:A().array,optsactivities:A().array,sel_options:A().object,monthForecast:A().object,recommendations:A().object,recommendationsImpacts:A().array,loading:A().bool,isloadingreport:A().bool,open:A().bool,isTagalog:A().bool,message:A().object,smstext:A().string,pdfPreview:A().object,onSelectItemChange:A().func,handlePreview:A().func,handleSave:A().func,toggleViewerOpen:A().func,toggleGlobalLanguage:A().func,resetSelections:A().func,togglePrompt:A().func};var re=te,oe=t(66383),ie=t(87661);function le(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function ae(e,n,t,r,o,i,l){try{var a=e[i](l),s=a.value}catch(c){return void t(c)}a.done?n(s):Promise.resolve(s).then(r,o)}function se(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function l(e){ae(i,r,o,l,a,"next",e)}function a(e){ae(i,r,o,l,a,"throw",e)}l(void 0)}))}}function ce(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ue(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){ce(e,n,t[n])}))}return e}function pe(e){return function(e){if(Array.isArray(e))return le(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return le(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return le(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var de=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};var fe={sel_province:null,sel_municipality:null,sel_crop:null,sel_stage:null,sel_activity:[],sel_month:null,sel_condition:{id:0,from:"weather_condition",label:w.MW.WAY_BELOW_NORMAL.label},loading:!1,error:"",success:""},me={url:"",filename:""};var ge=!0,he=(0,P.Z)((function(e){var n=e.provinces,t=void 0===n?[]:n,r=e.user,y=e.onBtnLogoutClick,P=e.loading,C=(0,l.useState)(fe),k=C[0],A=C[1],T=(0,l.useState)({}),L=T[0],R=T[1],I=(0,l.useState)({}),N=I[0],B=I[1],M=(0,l.useState)([]),z=M[0],F=M[1],D=(0,l.useState)([]),G=D[0],W=D[1],q=(0,l.useState)([]),V=q[0],H=q[1],U=(0,l.useState)(null),Y=U[0],X=U[1],$=(0,l.useState)(!0),K=$[0],J=$[1],Q=(0,l.useState)(!1),ee=Q[0],ne=Q[1],te=(0,l.useRef)(!1),le=(0,g.Z)(k.sel_province,t),ae=(0,u.m$)(s.M.WEATHER_FORECASTS,"bicol",s.M.SUB_SEASONAL,"name"),ge=ae.documents,he=ae.loading,be=ae.error,ve=(0,_.Z)(N,k.sel_month).forecast,xe=(0,v.Z)(k.sel_province),ye=xe.cropcalendar,je=xe.loading,_e=xe.error,Ze=(0,h.Z)(ye,k.sel_municipality),Se=(0,b.Z)(L,z,k.sel_crop),Oe=Se.months,we=Se.uniquecropstages,Ee=Se.error,Pe=(0,x.Z)(Y,ve,O.q.SEASONAL,!0),Ce=Pe.recommendations,ke=Pe.farmoperations,Ae=Pe.loading,Te=Pe.error,Le=(0,Z.Z)(Ce),Re=Le.group,Ie=Le.error,Ne=j(Ce),Be=Ne.group,Me=Ne.error,ze=(0,l.useState)(me),Fe=ze[0],De=ze[1],Ge=(0,l.useState)(!1),We=Ge[0],qe=Ge[1],Ve=(0,l.useState)(E.BF),He=Ve[0],Ue=Ve[1],Ye=(0,l.useState)(""),Xe=Ye[0],$e=Ye[1],Ke=(0,a.v9)((function(e){return e.dashboard.reportType})),Je=(0,a.I0)(),Qe=(0,a.v9)((function(e){return e.reports})),en=Qe.report,nn=Qe.status,tn=Qe.error;(0,l.useEffect)((function(){return te.current=!0,function(){te.current=!1}}),[]),(0,l.useEffect)((function(){Je((0,d.s_)())}),[Je]),(0,l.useEffect)((function(){t.length>0&&!he&&!P&&(H((0,m.m)(t)),F(ge[0].mos.reduce((function(e,n){return pe(e).concat([{id:w.re[n.toUpperCase()].code,label:w.re[n.toUpperCase()].format,disabled:!1}])}),[])))}),[t,ge,he,P]),(0,l.useEffect)((function(){J(P||he||Ae||je)}),[P,he,Ae,je]),(0,l.useEffect)((function(){if(""!==Ee||""!==Te||""!==be||""!==_e||""!==Ie||""!==tn||""!==Me){var e=Ee||Te||be||_e||Ie||tn||Me;A((function(n){return ue({},n,{error:e})}))}else A((function(e){return ue({},e,{error:""})}))}),[Ee,Te,be,_e,Ie,tn,Me]),(0,l.useEffect)((function(){nn===S.G.FULLFILLED&&null!==en&&te.current&&Ue((function(e){return ue({},e,{msg:"Success! Bulletin report created.",loading:!1,savesuccess:!0,docId:en.id})}))}),[nn,en]);var rn=function(){var e=se(o().mark((function e(){var n,t,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object.values(w.re).find((function(e){return e.format===k.sel_month.label})).code,Ue(ue({},He,{loading:!0,msg:"Saving report..."}));try{t={region:"bicol",province:k.sel_province,municipality:k.sel_municipality,crop:k.sel_crop,month:n,stages:Y.split(","),operation:"create",language:ee?"tag":"en"},Je((0,f.Br)(t)).unwrap().then((function(){Ke!==E.Ry.SEASONAL&&(Je((0,p.uq)(E.Ry.SEASONAL)),Je((0,f.RC)({uid:r.uid,type:E.Ry.SEASONAL})))})).catch((function(e){te.current&&Ue((function(n){return ue({},n,{msg:e.message,loading:!1,savesuccess:!1,docId:null})}))}))}catch(o){i="",void 0!==o.response&&(i=void 0!==o.response.data&&"[object Blob]"===de(o.response.data)?o.response.data:""),""===i&&(i=o.message)}case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),on=function(){var e=se(o().mark((function e(){var n,t,r,i,l,a,s,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===Fe.url){e.next=4;break}return qe(!0),e.abrupt("return");case 4:return A((function(e){return ue({},e,{loading:!0,error:"",success:""})})),r=null!==(t=null===(n=k.sel_month)||void 0===n?void 0:n.id)&&void 0!==t?t:"-",e.prev=7,i={region:"bicol",province:k.sel_province,municipality:k.sel_municipality,crop:k.sel_crop,month:r,stages:Y.split(","),operation:"preview",language:ee?"tag":"en"},qe(!0),A((function(e){return ue({},e,{loading:!0,error:""})})),e.next=13,(0,c.pl)(i);case 13:l=e.sent,a=new Blob([l],{type:"application/pdf"}),(s={}).href=URL.createObjectURL(a),s.download="".concat(k.sel_province,"_").concat(k.sel_municipality,"-").concat(k.sel_crop,".pdf"),De((function(e){return ue({},e,{url:s.href,filename:s.download})})),A((function(e){return ue({},e,{loading:!1,success:"Bulletin preview created."})})),e.next=28;break;case 22:e.prev=22,e.t0=e.catch(7),u="",void 0!==e.t0.response&&(u=void 0!==e.t0.response.data&&"[object Blob]"===de(e.t0.response.data)?e.t0.response.data:""),""===u&&(u=e.t0.message),A((function(e){return ue({},e,{loading:!1,error:u})}));case 28:case"end":return e.stop()}}),e,null,[[7,22]])})));return function(){return e.apply(this,arguments)}}();return(0,i.jsx)(oe.Z,{loading:P,user:r,onBtnLogoutClick:y,accLevel:w.DW.ADMIN,children:(0,i.jsx)(re,{optsprovinces:V,optsmunicipalities:le,optscrops:Ze,optsmonths:Oe,optsactivities:ke,sel_options:k,monthForecast:ve,recommendations:Re,recommendationsImpacts:Be,loading:K,isloadingreport:nn===S.G.PENDING,open:We,isTagalog:ee,message:He,smstext:Xe,pdfPreview:Fe,onSelectItemChange:function(e,n){var t=n.from,r=n.label,o=n.id;if(De(me),G.length>0&&W([]),Object.keys(n).includes("id"))switch(t){case"province":X(null),B(ge.find((function(e){return e.name===r}))),A(ue({},fe,{sel_province:r}));break;case"municipality":X(null),A(ue({},k,{sel_municipality:r,sel_crop:null,sel_month:null,sel_stage:null,sel_activity:null}));break;case"crop":R(ye.find((function(e){return e.municipality===k.sel_municipality&&e.crop===r}))),A(ue({},k,{sel_crop:r,sel_month:null,sel_stage:null,sel_activity:null}));break;case"month":var i=we[o].map((function(e){return e.code})).toString(),l=we[o].map((function(e){return e.label})).toString();X(i),$e((function(e){return(0,ie.smsWriter)({type:ie.SMS_TYPE.SEASONAL,replacements:ce({},ie.REPLACE_KEYS.SEASONAL.MONTH,ie.MONTHS_TAGALOG[n.id])})})),A(ue({},k,{sel_month:n,sel_stage:l,sel_activity:null}))}else"province"===t?(A(fe),X(null)):"municipality"===t?(A(ue({},k,{sel_municipality:null,sel_crop:null,sel_month:null,sel_stage:null,sel_activity:null})),X(null)):"crop"===t?(A(ue({},k,{sel_crop:null,sel_month:null,sel_stage:null,sel_activity:null})),X(null)):"month"===t&&(A(ue({},k,{sel_month:null,sel_stage:null,sel_activity:null})),X(null))},handlePreview:on,handleSave:rn,toggleViewerOpen:function(){qe((function(e){return!e}))},toggleGlobalLanguage:function(){ne((function(e){return!e})),De(me)},resetSelections:function(){A(fe),X(null),W([])},togglePrompt:function(){Ue((function(e){return ue({},E.BF,{isOpen:!e.isOpen})}))}})})}))}},function(e){e.O(0,[6284,2866,9964,9522,1903,6279,6295,4039,2882,6572,1050,3523,7702,3032,9774,2888,179],(function(){return n=40108,e(e.s=n);var n}));var n=e.O();_N_E=n}]);
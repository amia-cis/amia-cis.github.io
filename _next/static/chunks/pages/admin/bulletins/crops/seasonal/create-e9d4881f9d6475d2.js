(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7970],{37645:function(e,n,t){"use strict";var r=t(87462),o=t(63366),i=t(67294),l=t(86010),a=t(27192),s=t(15861),c=t(11496),u=t(33616),p=t(4472),d=t(34182),f=t(85893);const m=["className","id"],g=(0,c.ZP)(s.Z,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,n)=>n.root})({padding:"16px 24px",flex:"0 0 auto"}),h=i.forwardRef((function(e,n){const t=(0,u.Z)({props:e,name:"MuiDialogTitle"}),{className:s,id:c}=t,h=(0,o.Z)(t,m),b=t,x=(e=>{const{classes:n}=e;return(0,a.Z)({root:["root"]},p.a,n)})(b),{titleId:v=c}=i.useContext(d.Z);return(0,f.jsx)(g,(0,r.Z)({component:"h2",className:(0,l.Z)(x.root,s),ownerState:b,ref:n,variant:"h6",id:v},h))}));n.Z=h},40108:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/bulletins/crops/seasonal/create",function(){return t(83931)}])},83931:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return he}});var r=t(34051),o=t.n(r),i=t(85893),l=t(67294),a=t(9473),s=t(16327),c=t(30560),u=t(87006),p=t(87682),d=t(53063),f=t(12671),m=t(61690),g=t(59111),h=t(87784),b=t(23766),x=t(76490),v=t(15113),y=t(33050),j=t(68193);function _(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Z(e){var n=(0,l.useState)([]),t=n[0],r=n[1],o=(0,l.useState)(""),i=o[0],a=o[1];(0,l.useEffect)((function(){if(a(""),e.length>0)try{var n=e.map((function(e){return{impact:e.impact,impact_tagalog:e.impact_tagalog}})).filter((function(e){return""!==e.impact&&""!==e.impact_tagalog}));return n=c(n),void r([{impact:s(n.impact),impact_tagalog:s(n.impact_tagalog)}])}catch(t){a(t)}else r([])}),[e]);var s=function(e){var n="-",t=e.reduce((function(e,t){return t.includes("<p>")?("list"===n&&(e+="</ul>"),e+=t,n="p"):(["-","p"].includes(n)&&(e+="<ul>"),e+=t,n="list"),e}),"");return"list"===n&&(t+="</ul>"),t},c=function(e){var n=[];return e.reduce((function(e,t){return Object.keys(e).forEach((function(r){var o=t[r].replace(/<ul>/g,"");(o=(o=o.replace(/<\/ul>/g,"")).replace(/<li>/g,"")).split("</li>").forEach((function(t){t.includes("<p>")?t.replace(/<p>/g,"").split("</p>").forEach((function(t){n.includes(t)||""===t||(n.push(t),e[r].push("<p>".concat(t,"</p>")))})):n.includes(t)||""===t||(n.push(t),e[r].push("<li>".concat(t,"</li>")))}))})),function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){_(e,n,t[n])}))}return e}({},e)}),{impact:[],impact_tagalog:[]})};return{group:t,error:i}}var S=t(99306),O=t(41375),w=t(901),E=t(16013),P=t(47426),C=t(27392),k=t(95243),A=t(11163),T=t(45697),L=t.n(T),R=t(21023),I=t(93946),N=t(41664),B=t(76295),M=t(87357),D=t(98456),z=t(11057),F=t(56863),G=t(87918),W=t(67720),q=t(86886),V=t(61903),H=t(15861),U=t(88409),Y=t(40044),$=t(11829),X=t(19227),K=t(22094),J=t(27692),Q=t(79316),ee=t(22757);function ne(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function te(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){ne(e,n,t[n])}))}return e}function re(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function oe(e){var n=function(e){var n=e.children,t=e.value,r=e.index,o=re(e,["children","value","index"]);return(0,i.jsx)("div",te({role:"tabpanel",hidden:t!==r,id:"simple-tabpanel-".concat(r),"aria-labelledby":"simple-tab-".concat(r)},o,{children:t===r&&(0,i.jsx)(M.Z,{sx:{p:3},children:n})}))},t=function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}},r=(0,l.useState)(!1),o=r[0],s=r[1],c=(0,l.useRef)(!0),u=(0,A.useRouter)(),p=(0,a.I0)(),d=(0,l.useState)(0),m=d[0],g=d[1],b=e.sel_options,x=e.recommendations,v=e.recommendationsImpacts,y=e.optsprovinces,j=e.optsmunicipalities,_=e.optsactivities,Z=e.optscrops,S=e.optsmonths,O=e.monthForecast,w=e.open,E=e.isTagalog,C=e.loading,k=e.isloadingreport,T=e.message,ne=e.smstext,oe=e.pdfPreview,ie=e.handleSave,le=e.handlePreview,ae=e.togglePrompt,se=e.toggleViewerOpen,ce=e.toggleGlobalLanguage,ue=e.onSelectItemChange,pe=e.resetSelections;(0,l.useEffect)((function(){return c.current=!0,function(){c.current=!1}}),[]),(0,l.useEffect)((function(){null===b.sel_month&&!0===o&&s(!1)}),[b.sel_month,o]);var de=function(){p((0,f.s_)()),u.push("/admin/bulletins/crops/report/view/?docId=".concat(T.docId))},fe=function(){var e="Loading...";return y.length>0&&(e=null===b.sel_province?"Select a province":"Province"),e};return n.propTypes={children:L().node,index:L().number.isRequired,value:L().number.isRequired},(0,i.jsxs)("div",{children:[(0,i.jsx)(X.Z,{isOpen:T.isOpen,maxWidth:"xs",openButtonText:null,title:T.title,contentText:T.msg,loading:T.loading,modalCancelHandlerCB:function(){T.savesuccess?de():ae()},modalConfirmHandlerCB:function(){T.savesuccess?de():ie()}}),(0,i.jsx)(K.Z,{open:w,pdfPreview:oe,error:b.error,loading:b.loading,toggleViewerOpen:se}),(0,i.jsxs)(q.ZP,{container:!0,sx:ee.Z.container,children:[(0,i.jsxs)(M.Z,{sx:ee.Z.headerText,children:[(0,i.jsxs)(M.Z,{children:[(0,i.jsx)(H.Z,{variant:"h5",children:"Regional Seasonal Climate Outlook and Advisory Crop Recommendations Bulletin"}),(0,i.jsxs)("p",{children:["Create ",(0,i.jsx)("strong",{children:"Seasonal"})," crop recommendations bulletins. Finalized bulletins will be automatically uploaded to the site for public download."]})]}),(0,i.jsx)(M.Z,{children:(0,i.jsx)(I.Z,{"aria-label":"exit",size:"medium",children:(0,i.jsx)(N.default,{href:"/admin/bulletins/crops",passHref:!0,children:(0,i.jsx)(R.Z,{fontSize:"inherit"})})})})]}),(0,i.jsxs)(q.ZP,{item:!0,sx:ee.Z.item,xs:12,lg:4,children:[(0,i.jsx)(H.Z,{variant:"h6",children:"Selection Options"}),(0,i.jsx)(B.Z,{disablePortal:!0,id:"province",size:"small",value:b.sel_province,disabled:0===y.length||C,options:y,sx:ee.Z.autocomplete,PaperComponent:$.Z,renderInput:function(e){return(0,i.jsx)(V.Z,te({},e,{label:fe()}))},isOptionEqualToValue:function(e,n){return e.label===n},onChange:function(e,n){return ue(e,te({},n,{from:"province"}))}}),(0,i.jsx)(B.Z,{disablePortal:!0,id:"municipality",size:"small",value:b.sel_municipality,disabled:0===j.length||C,options:j,sx:ee.Z.autocomplete,PaperComponent:$.Z,renderInput:function(e){return(0,i.jsx)(V.Z,te({},e,{label:null===b.sel_municipality?"Select a municipality":"Municipality"}))},getOptionDisabled:function(e){return e.disabled||void 0!==e.iscalendar},isOptionEqualToValue:function(e,n){return e.label===n},onChange:function(e,n){return ue(e,te({},n,{from:"municipality"}))}}),(0,i.jsx)(B.Z,{disablePortal:!0,id:"crop",size:"small",value:b.sel_crop,disabled:0===Z.length||C,options:Z,sx:ee.Z.autocomplete,PaperComponent:$.Z,renderInput:function(e){return(0,i.jsx)(V.Z,te({},e,{label:null===b.sel_crop?"Select a crop type":"Crop"}))},isOptionEqualToValue:function(e,n){return e.label===n},getOptionDisabled:function(e){return e.disabled},onChange:function(e,n){return ue(e,te({},n,{from:"crop"}))}}),(0,i.jsx)(B.Z,{disablePortal:!0,id:"month",size:"small",value:b.sel_month,disabled:0===S.length||null===b.sel_crop||C,options:S,sx:ee.Z.autocomplete,PaperComponent:$.Z,renderInput:function(e){return(0,i.jsx)(V.Z,te({},e,{label:null===b.sel_month?"Select a Month":"Month"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},getOptionDisabled:function(e){return e.disabled},onChange:function(e,n){ue(e,te({},n,{from:"month"})),s(!1)}}),(0,i.jsxs)(F.Z,{disableElevation:!0,size:"small","aria-label":"outlined button controls group",disabled:k||null===b.sel_municipality||null===b.sel_crop||null===b.sel_month,sx:{marginTop:"16px",float:"right"},children:[(0,i.jsx)(z.Z,{variant:"outlined",disabled:C||k,onClick:pe,children:"Reset"}),(0,i.jsx)(z.Z,{variant:"contained",onClick:function(){return s((function(e){return!e}))},disabled:C||null===b.sel_month||o,children:"Generate"})]})]}),(0,i.jsx)(q.ZP,{item:!0,sx:ee.Z.item,xs:12,lg:8,children:(0,i.jsx)(Q.Z,{selecteditems:b,farmoperations:_.map((function(e){return e.label})).toString().split(",").join(", "),loading:C})})]}),(0,i.jsxs)(q.ZP,{container:!0,sx:ee.Z.container,gap:3,style:{marginTop:"24px"},children:[(0,i.jsxs)(q.ZP,{item:!0,sx:ee.Z.item,xs:12,lg:12,children:[(0,i.jsxs)(M.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)(H.Z,{variant:"h6",children:"Crop Recommendations"}),(0,i.jsx)(D.Z,{size:24,color:"primary",sx:{display:C?"block":"none"}})]}),null!==b.sel_crop&&null!==b.sel_month&&o&&(0,i.jsxs)(M.Z,{children:[(0,i.jsxs)(M.Z,{sx:{display:{md:"block",lg:"flex"}},children:[(0,i.jsxs)(H.Z,{variant:"h5",sx:{display:"block",flexGrow:{xs:12,sm:3}},children:[b.sel_crop," Recommendations"]}),(0,i.jsx)(M.Z,{sx:{flexGrow:{xs:12,sm:1}},children:null!==b.sel_month&&(0,i.jsxs)(M.Z,{sx:ee.Z.conditionLegend,style:{color:[P.MW.ABOVE_NORMAL.label,P.MW.WAY_BELOW_NORMAL.label].includes(O.forecast)?"#fff":"#000",backgroundColor:P.tN[O.forecast]},children:[(0,i.jsx)(H.Z,{variant:"subtitle2",children:"Rainfall Condition"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{children:b.sel_month.label})," \xa0",(0,i.jsxs)("span",{children:[O.label," ","(",(0,h.aS)(O.value),"%)"]})]})]})})]}),O.forecast!==P.DD&&(0,i.jsxs)(M.Z,{sx:{width:"100%",marginTop:{xs:"85px",lg:"0px"},"& hr":{marginBottom:"32px"}},children:[(0,i.jsx)(M.Z,{sx:{borderBottom:1,borderColor:"divider","& hr":{color:"red"}},children:(0,i.jsxs)(U.Z,{value:m,onChange:function(e,n){g(n)},"aria-label":"basic tabs example",children:[(0,i.jsx)(Y.Z,te({label:"PDF FORM"},t(0))),(0,i.jsx)(Y.Z,te({label:"SMS FORM"},t(1)))]})}),(0,i.jsxs)(n,{value:m,index:0,children:[(0,i.jsxs)(M.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[(0,i.jsx)(H.Z,{variant:"h4",children:"Impact Outlooks"}),(0,i.jsx)(G.Z,{size:"medium",variant:"outlined",label:E?"English":"Tagalog",onClick:function(){return ce()},sx:{width:"90px"}})]}),(0,i.jsx)(M.Z,{sx:ee.Z.recSeasonal,children:(0,i.jsx)(J.Z,{recommendations:v,title:"",subtitle:"",titleFontSize:"h6",recommendationsEng:"impact",recommendationsTag:"impact_tagalog",isTagalog:E,isShowTitle:!1})}),(0,i.jsx)("hr",{}),(0,i.jsx)(H.Z,{variant:"h4",children:"Practices"}),Object.keys(x).map((function(e){return Object.keys(x[e]).map((function(n,t){return(0,i.jsxs)(M.Z,{sx:ee.Z.recSeasonal,children:[(0,i.jsxs)(H.Z,{variant:"h6",children:[e," - ",n]}),(0,i.jsx)(J.Z,{recommendations:x[e][n],title:"",subtitle:"",titleFontSize:"h6",recommendationsEng:"practice",recommendationsTag:"practice_tagalog",isTagalog:E})]},"rec-".concat(t))}))}))]}),(0,i.jsx)(n,{value:m,index:1,children:ne})]})]})]}),(0,i.jsxs)(M.Z,{sx:{marginBottom:"16px",width:"100%",display:o?"block":"none"},children:[(0,i.jsx)("br",{}),(0,i.jsx)(W.Z,{}),(0,i.jsx)("br",{}),""!==b.error&&(0,i.jsxs)(H.Z,{variant:"caption",sx:{color:"red"},children:["Error: ",b.error]}),(0,i.jsxs)(F.Z,{size:"large","aria-label":"large button group",disabled:k||O.forecast===P.DD,sx:{display:"flex",justifyContent:"flex-end",marginTop:"8px"},children:[(0,i.jsx)(N.default,{href:"/admin/bulletins/crops",passHref:!0,children:(0,i.jsx)(z.Z,{disabled:b.loading,children:"Cancel"})}),(0,i.jsxs)(z.Z,{disabled:b.loading,onClick:le,children:[(0,i.jsx)("span",{style:{display:k?"none":"block"},children:"Preview"})," ","\xa0",(0,i.jsx)(D.Z,{size:24,color:"secondary",sx:{display:k?"block":"none"}})]}),(0,i.jsx)(z.Z,{variant:"contained",onClick:ae,disableElevation:!0,disabled:b.loading,children:"Save"})]})]})]})]})}oe.propTypes={optsprovinces:L().array,optsmunicipalities:L().array,optscrops:L().array,optsmonths:L().array,optsactivities:L().array,sel_options:L().object,monthForecast:L().object,recommendations:L().object,recommendationsImpacts:L().array,loading:L().bool,isloadingreport:L().bool,open:L().bool,isTagalog:L().bool,message:L().object,smstext:L().string,pdfPreview:L().object,onSelectItemChange:L().func,handlePreview:L().func,handleSave:L().func,toggleViewerOpen:L().func,toggleGlobalLanguage:L().func,resetSelections:L().func,togglePrompt:L().func};var ie=oe,le=t(66383),ae=t(87661);function se(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function ce(e,n,t,r,o,i,l){try{var a=e[i](l),s=a.value}catch(c){return void t(c)}a.done?n(s):Promise.resolve(s).then(r,o)}function ue(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function l(e){ce(i,r,o,l,a,"next",e)}function a(e){ce(i,r,o,l,a,"throw",e)}l(void 0)}))}}function pe(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function de(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){pe(e,n,t[n])}))}return e}function fe(e){return function(e){if(Array.isArray(e))return se(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return se(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return se(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var me={sel_province:null,sel_municipality:null,sel_crop:null,sel_stage:null,sel_activity:[],sel_month:null,sel_condition:{id:0,from:"weather_condition",label:P.MW.WAY_BELOW_NORMAL.label},loading:!1,error:"",success:""},ge={url:"",filename:""};var he=(0,k.Z)((function(e){var n=e.user,t=e.onBtnLogoutClick,r=e.loading,_=(0,l.useState)(me),k=_[0],A=_[1],T=(0,l.useState)({}),L=T[0],R=T[1],I=(0,l.useState)({}),N=I[0],B=I[1],M=(0,l.useState)([]),D=M[0],z=M[1],F=(0,l.useState)([]),G=F[0],W=F[1],q=(0,l.useState)([]),V=q[0],H=q[1],U=(0,l.useState)([]),Y=U[0],$=U[1],X=(0,l.useState)(null),K=X[0],J=X[1],Q=(0,l.useState)(!0),ee=Q[0],ne=Q[1],te=(0,l.useState)(!1),re=te[0],oe=te[1],se=(0,l.useRef)(!1),ce=(0,b.Z)(k.sel_province,Y),he=(0,p.m$)(c.M.WEATHER_FORECASTS,"bicol",c.M.SUB_SEASONAL,"name"),be=he.documents,xe=he.loading,ve=he.error,ye=(0,S.Z)(N,k.sel_month).forecast,je=(0,y.Z)(k.sel_province),_e=je.cropcalendar,Ze=je.loading,Se=je.error,Oe=(0,x.Z)(_e,k.sel_municipality),we=(0,v.Z)(L,D,k.sel_crop),Ee=we.months,Pe=we.uniquecropstages,Ce=we.error,ke=(0,j.Z)(K,ye,E.q.SEASONAL,!0),Ae=ke.recommendations,Te=ke.farmoperations,Le=ke.loading,Re=ke.error,Ie=(0,O.Z)(Ae),Ne=Ie.group,Be=Ie.error,Me=Z(Ae),De=Me.group,ze=Me.error,Fe=(0,l.useState)(ge),Ge=Fe[0],We=Fe[1],qe=(0,l.useState)(!1),Ve=qe[0],He=qe[1],Ue=(0,l.useState)(C.BF),Ye=Ue[0],$e=Ue[1],Xe=(0,l.useState)(""),Ke=Xe[0],Je=Xe[1],Qe=(0,a.v9)((function(e){return e.dashboard.reportType})),en=(0,a.I0)(),nn=(0,a.v9)((function(e){return e.reports})),tn=nn.report,rn=nn.status,on=nn.error;(0,l.useEffect)((function(){se.current=!0;var e=function(){var e=ue(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,s.$m)();case 3:n=e.sent,se&&$(n.data),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return e(),function(){se.current=!1}}),[]),(0,l.useEffect)((function(){en((0,f.s_)())}),[en]),(0,l.useEffect)((function(){Y.length>0&&!xe&&!r&&(H((0,g.m)(Y)),z(be[0].mos.reduce((function(e,n){return fe(e).concat([{id:P.re[n.toUpperCase()].code,label:P.re[n.toUpperCase()].format,disabled:!1}])}),[])))}),[Y,be,xe,r]),(0,l.useEffect)((function(){ne(r||xe||Le||Ze)}),[r,xe,Le,Ze]),(0,l.useEffect)((function(){if(""!==Ce||""!==Re||""!==ve||""!==Se||""!==Be||""!==on||""!==ze){var e=Ce||Re||ve||Se||Be||on||ze;A((function(n){return de({},n,{error:e})}))}else A((function(e){return de({},e,{error:""})}))}),[Ce,Re,ve,Se,Be,on,ze]),(0,l.useEffect)((function(){rn===w.G.FULLFILLED&&null!==tn&&se.current&&$e((function(e){return de({},e,{msg:"Success! Bulletin report created.",loading:!1,savesuccess:!0,docId:tn.id})}))}),[rn,tn]);var ln=function(){var e=ue(o().mark((function e(){var t,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object.values(P.re).find((function(e){return e.format===k.sel_month.label})).code,$e(de({},Ye,{loading:!0,msg:"Saving report..."}));try{r={region:"bicol",province:k.sel_province,municipality:k.sel_municipality,crop:k.sel_crop,month:t,stages:K.split(","),operation:"create",language:re?"tag":"en"},en((0,m.Br)(r)).unwrap().then((function(){Qe!==C.Ry.SEASONAL&&(en((0,d.uq)(C.Ry.SEASONAL)),en((0,m.RC)({uid:n.uid,type:C.Ry.SEASONAL})))})).catch((function(e){se.current&&$e((function(n){return de({},n,{msg:e.message,loading:!1,savesuccess:!1,docId:null})}))}))}catch(l){i="",void 0!==l.response&&(i=void 0!==l.response.data&&"[object Blob]"===((o=l.response.data)&&"undefined"!==typeof Symbol&&o.constructor===Symbol?"symbol":typeof o)?l.response.data:""),""===i&&(i=l.message)}case 3:case"end":return e.stop()}var o}),e)})));return function(){return e.apply(this,arguments)}}(),an=function(){var e=ue(o().mark((function e(){var n,t,r,i,l,a,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===Ge.url){e.next=4;break}return He(!0),e.abrupt("return");case 4:return A((function(e){return de({},e,{loading:!0,error:"",success:""})})),r=null!==(t=null===(n=k.sel_month)||void 0===n?void 0:n.id)&&void 0!==t?t:"-",e.prev=7,i={region:"bicol",province:k.sel_province,municipality:k.sel_municipality,crop:k.sel_crop,month:r,stages:K.split(","),operation:"preview",language:re?"tag":"en"},He(!0),A((function(e){return de({},e,{loading:!0,error:""})})),e.next=13,(0,u.pl)(i);case 13:l=e.sent,a=new Blob([l],{type:"application/pdf"}),(s={}).href=URL.createObjectURL(a),s.download="".concat(k.sel_province,"_").concat(k.sel_municipality,"-").concat(k.sel_crop,".pdf"),We((function(e){return de({},e,{url:s.href,filename:s.download})})),A((function(e){return de({},e,{loading:!1,success:"Bulletin preview created."})})),e.next=28;break;case 22:return e.prev=22,e.t0=e.catch(7),e.next=26,(0,h.fu)(e.t0);case 26:c=e.sent,A((function(e){return de({},e,{loading:!1,error:c})}));case 28:case"end":return e.stop()}}),e,null,[[7,22]])})));return function(){return e.apply(this,arguments)}}();return(0,i.jsx)(le.Z,{loading:r,user:n,onBtnLogoutClick:t,accLevel:P.DW.ADMIN,children:(0,i.jsx)(ie,{optsprovinces:V,optsmunicipalities:ce,optscrops:Oe,optsmonths:Ee,optsactivities:Te,sel_options:k,monthForecast:ye,recommendations:Ne,recommendationsImpacts:De,loading:ee,isloadingreport:rn===w.G.PENDING,open:Ve,isTagalog:re,message:Ye,smstext:Ke,pdfPreview:Ge,onSelectItemChange:function(e,n){var t=n.from,r=n.label,o=n.id;if(We(ge),G.length>0&&W([]),Object.keys(n).includes("id"))switch(t){case"province":J(null),B(be.find((function(e){return e.name===r}))),A(de({},me,{sel_province:r}));break;case"municipality":J(null),A(de({},k,{sel_municipality:r,sel_crop:null,sel_month:null,sel_stage:null,sel_activity:null}));break;case"crop":R(_e.find((function(e){return e.municipality===k.sel_municipality&&e.crop===r}))),A(de({},k,{sel_crop:r,sel_month:null,sel_stage:null,sel_activity:null}));break;case"month":var i=Pe[o].map((function(e){return e.code})).toString(),l=Pe[o].map((function(e){return e.label})).toString();J(i),Je((function(e){return(0,ae.smsWriter)({type:ae.SMS_TYPE.SEASONAL,replacements:pe({},ae.REPLACE_KEYS.SEASONAL.MONTH,ae.MONTHS_TAGALOG[n.id])})})),A(de({},k,{sel_month:n,sel_stage:l,sel_activity:null}))}else"province"===t?(A(me),J(null)):"municipality"===t?(A(de({},k,{sel_municipality:null,sel_crop:null,sel_month:null,sel_stage:null,sel_activity:null})),J(null)):"crop"===t?(A(de({},k,{sel_crop:null,sel_month:null,sel_stage:null,sel_activity:null})),J(null)):"month"===t&&(A(de({},k,{sel_month:null,sel_stage:null,sel_activity:null})),J(null))},handlePreview:an,handleSave:ln,toggleViewerOpen:function(){He((function(e){return!e}))},toggleGlobalLanguage:function(){oe((function(e){return!e})),We(ge)},resetSelections:function(){A(me),J(null),W([])},togglePrompt:function(){$e((function(e){return de({},C.BF,{isOpen:!e.isOpen})}))}})})}))}},function(e){e.O(0,[6284,2866,9964,9522,1903,6279,6295,4039,2882,6572,1050,2944,7702,3032,9774,2888,179],(function(){return n=40108,e(e.s=n);var n}));var n=e.O();_N_E=n}]);
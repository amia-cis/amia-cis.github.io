(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[507],{3926:function(e,n,t){"use strict";var r=t(7294),i=t(67),a=t(3633),o=t(7094),l=t(5893);function c(e){return e.substring(2).toLowerCase()}n.Z=function(e){const{children:n,disableReactTree:t=!1,mouseEvent:s="onClick",onClickAway:u,touchEvent:d="onTouchEnd"}=e,p=r.useRef(!1),f=r.useRef(null),m=r.useRef(!1),b=r.useRef(!1);r.useEffect((()=>(setTimeout((()=>{m.current=!0}),0),()=>{m.current=!1})),[]);const v=(0,i.Z)(n.ref,f),h=(0,a.Z)((e=>{const n=b.current;b.current=!1;const r=(0,o.Z)(f.current);if(!m.current||!f.current||"clientX"in e&&function(e,n){return n.documentElement.clientWidth<e.clientX||n.documentElement.clientHeight<e.clientY}(e,r))return;if(p.current)return void(p.current=!1);let i;i=e.composedPath?e.composedPath().indexOf(f.current)>-1:!r.documentElement.contains(e.target)||f.current.contains(e.target),i||!t&&n||u(e)})),y=e=>t=>{b.current=!0;const r=n.props[e];r&&r(t)},x={ref:v};return!1!==d&&(x[d]=y(d)),r.useEffect((()=>{if(!1!==d){const e=c(d),n=(0,o.Z)(f.current),t=()=>{p.current=!0};return n.addEventListener(e,h),n.addEventListener("touchmove",t),()=>{n.removeEventListener(e,h),n.removeEventListener("touchmove",t)}}}),[h,d]),!1!==s&&(x[s]=y(s)),r.useEffect((()=>{if(!1!==s){const e=c(s),n=(0,o.Z)(f.current);return n.addEventListener(e,h),()=>{n.removeEventListener(e,h)}}}),[h,s]),(0,l.jsx)(r.Fragment,{children:r.cloneElement(n,x)})}},7947:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/bulletins/crops/tenday/create",function(){return t(5081)}])},5322:function(e,n,t){"use strict";var r=t(5893),i=t(7294),a=t(5697),o=t.n(a),l=t(4866),c=t(6901);function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var u=i.forwardRef((function(e,n){return(0,r.jsx)(c.Z,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){s(e,n,t[n])}))}return e}({elevation:6,ref:n,variant:"filled"},e))}));function d(e){var n=e.openSnackbar,t=e.message,a=e.severity,o=e.closeHandlerCB,c=void 0===o?function(){}:o,s=(0,i.useState)(n),d=s[0],p=s[1];(0,i.useEffect)((function(){p(n)}),[n]);var f=function(){p(!1),c()};return(0,r.jsx)(l.Z,{open:d,autoHideDuration:3e3,onClose:f,children:(0,r.jsx)(u,{onClose:f,severity:a,sx:{width:"100%"},children:t})})}d.propTypes={openSnackbar:o().bool,message:o().string,severity:o().string},n.Z=d},5081:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSG:function(){return se},default:function(){return ue}});var r=t(4051),i=t.n(r),a=t(5893),o=t(7294),l=t(9473),c=t(7682),s=t(1163),u=t(1664),d=t(5675),p=t(120),f=t(1023),m=t(6295),b=t(1057),v=t(6863),h=t(7357),y=t(6886),x=t(3946),g=t(1903),j=t(5861),_=t(9758),O=t(8456),w=t(7720),S=t(44),Z=t(8409),E=t(7426),k=t(901),P={container:{padding:"24px",width:"100%",position:"relative",minWidth:"0px",overflowWrap:"break-word",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"16px",borderColor:"#E2E8F0"},welcome:{border:"1px solid #DCEDC8",borderRadius:function(e){return e.spacing(1)},width:"100%",display:"grid",placeContent:"center",padding:"20px",marginTop:function(e){return e.spacing(1)},textAlign:"center","& h6":{lineHeight:"20px"}},summary:{border:"1px solid #DCEDC8",borderRadius:function(e){return e.spacing(1)},marginTop:function(e){return e.spacing(1)},padding:function(e){return e.spacing(3)}},selectionSummary:{minWidth:"100%",paddingLeft:{xs:0,lg:"16px"}},conditionLegend:{borderRadius:function(e){return e.spacing(1)},width:"100%",padding:function(e){return e.spacing(1)},border:"1px solid grey",textAlign:"center",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",float:"left"},autocomplete:{marginTop:function(e){return e.spacing(1)}},recSeasonal:{marginTop:function(e){return e.spacing(1)},"& p, ul":{fontSize:"14px"}},button:{color:"#FFFFFF",textTransform:"capitalize",fontSize:"14px",fontStyle:"normal",fontWeight:"normal",width:"80px",height:{xs:"40px",sm:"50px"}},pdfcontent:{ul:{paddingLeft:3}}};function C(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function R(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){C(e,n,t[n])}))}return e}function L(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var D=function(e){var n=function(e){var n=e.children,t=e.value,r=e.index,i=L(e,["children","value","index"]);return(0,a.jsx)("div",R({role:"tabpanel",hidden:t!==r,id:"simple-tabpanel-".concat(r),"aria-labelledby":"simple-tab-".concat(r)},i,{children:t===r&&(0,a.jsx)(h.Z,{sx:{p:3},children:n})}))},t=function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}},r=e.options,i=e.handleSave,c=e.handlePreview,s=(0,l.v9)((function(e){return e.recommendations})),d=s.status,p=s.filtered_recommendations,f=(0,l.v9)((function(e){return e.reports})),m=f.error,x=f.status,g=(0,l.v9)((function(e){return e.cropcalendar.status})),_=(0,l.v9)((function(e){return e.tendayweather.status})),D=(0,o.useState)({}),N=D[0],A=D[1],I=(0,o.useState)([]),F=I[0],T=I[1],G=(0,o.useState)(0),M=G[0],W=G[1],B=(0,o.useState)(!1),z=B[0],H=B[1];return(0,o.useEffect)((function(){p.length>0&&(A(p.reduce((function(e,n){return void 0===e?e=C({},n.crop,[n]):void 0===e[n.crop]?e[n.crop]=[n]:e[n.crop].push(n),e}),{})),T(p.map((function(e){return e.crop})).filter((function(e,n,t){return t.indexOf(e)===n}))))}),[p]),(0,o.useEffect)((function(){H(r.loading||x===k.G.PENDING)}),[r.loading,x]),(0,a.jsxs)(y.ZP,{container:!0,sx:P.container,gap:3,style:{marginTop:"24px"},children:[(0,a.jsxs)(y.ZP,{item:!0,sx:P.item,xs:12,lg:12,children:[(0,a.jsxs)(h.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsx)(j.Z,{variant:"h6",children:"Crop Recommendations"}),(0,a.jsx)(O.Z,{size:24,color:"primary",sx:{display:d===k.G.PENDING||g===k.G.PENDING||_===k.G.PENDING?"block":"none"}})]}),p.length>0&&(0,a.jsxs)(h.Z,{children:[(0,a.jsxs)(h.Z,{sx:{display:{md:"block",lg:"flex"}},children:[(0,a.jsx)(j.Z,{variant:"h5",sx:{display:0===r.sel_activity.length?"none":"block",flexGrow:{xs:12,sm:3}},children:"10-Day Farm Weather Outlook and Advisory"}),(0,a.jsx)(h.Z,{sx:{flexGrow:{xs:12,sm:1}},children:null!==r.sel_month&&(0,a.jsxs)(h.Z,{sx:P.conditionLegend,style:{color:[E.MW.ABOVE_NORMAL.label,E.MW.WAY_BELOW_NORMAL.label].includes(r.sel_condition.label)?"#fff":"#000",backgroundColor:E.tN[r.sel_condition.label]},children:[(0,a.jsx)(j.Z,{variant:"subtitle2",children:"10-Day Weather Outlook for Today"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{children:r.sel_condition.current_date})," \xa0",(0,a.jsxs)("span",{children:[r.sel_condition.format," ","(",r.sel_condition.tenday,")"]})]})]})})]}),(0,a.jsxs)(h.Z,{sx:{width:"100%",marginTop:{xs:"85px",lg:"0px"}},children:[(0,a.jsx)(h.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,a.jsxs)(Z.Z,{value:M,onChange:function(e,n){W(n)},"aria-label":"basic tabs example",children:[(0,a.jsx)(S.Z,R({label:"PDF FORM"},t(0))),(0,a.jsx)(S.Z,R({label:"SMS FORM"},t(1)))]})}),(0,a.jsx)(n,{value:M,index:0,children:F.map((function(e,n){return(0,a.jsxs)(h.Z,{sx:P.recSeasonal,children:[(0,a.jsx)(j.Z,{variant:"h5",children:e}),N[e].map((function(e,n){return(0,a.jsxs)(h.Z,{sx:P.recSeasonal,children:[(0,a.jsxs)(j.Z,{variant:"h6",children:[e.stage," - ",e.activity]}),e.recommendations.map((function(e,t){return e.ul?(0,a.jsxs)("ul",{children:[(0,a.jsx)("li",{children:e.id}),e.subs.length>0&&(0,a.jsx)("ul",{children:e.subs.map((function(e,t){return(0,a.jsx)("li",{children:e},"sub-".concat(n,"-").concat(t))}))})]},"main-".concat(n,"-").concat(t)):(0,a.jsx)("p",{children:e.id},"main-".concat(n,"-").concat(t))}))]},"rec-".concat(n))})),n<F.length-1&&(0,a.jsx)(w.Z,{sx:{margin:"48px 0 48px 0"}})]},"rec-".concat(n))}))}),(0,a.jsx)(n,{value:M,index:1,children:p.reduce((function(e,n){return e+=n.smsRecommendations+" "}),"")})]})]})]}),(0,a.jsxs)(h.Z,{sx:{marginBottom:"16px",width:"100%",display:p.length>0?"block":"none"},children:[(0,a.jsx)("br",{}),(0,a.jsx)(w.Z,{}),(0,a.jsx)("br",{}),""!==m&&(0,a.jsxs)(j.Z,{variant:"caption",sx:{color:"red"},children:["Error: ",m]}),(0,a.jsxs)(v.Z,{size:"large","aria-label":"large button group",sx:{display:"flex",justifyContent:"flex-end",marginTop:"8px"},children:[(0,a.jsx)(u.default,{href:"/admin/bulletins/crops",passHref:!0,children:(0,a.jsx)(b.Z,{disabled:z,children:"Cancel"})}),(0,a.jsxs)(b.Z,{disabled:r.loading,onClick:c,children:[(0,a.jsx)("span",{style:{display:z?"none":"block"},children:"Preview"})," ","\xa0",(0,a.jsx)(O.Z,{size:20,color:"secondary",sx:{display:z?"block":"none"}})]}),(0,a.jsx)(b.Z,{variant:"contained",onClick:i,disableElevation:!0,disabled:z,children:"Save"})]})]})]})},N=t(3501),A=t(5322),I=t(2671),F=t(2757);function T(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function G(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){T(e,n,t[n])}))}return e}var M=[{key:"sel_province",label:"Province"},{key:"sel_municipality",label:"Municipality"},{key:"sel_crop",label:"Crop"},{key:"sel_month",label:"Date"},{key:"sel_stage",label:"Crop Stages"},{key:"sel_activity",label:"Activities"}];var W=function(e){var n=(0,s.useRouter)(),t=(0,l.I0)(),r=e.sel_options,i=e.provinces,o=e.optsmunicipalities,c=e.error,O=e.open,w=e.loading,S=e.onSelectItemChange,Z=e.handlePreview,E=e.toggleViewerOpen,P=e.pdfPreview,C=e.resetSelections,R=e.generateRecommendations,L=e.handleSave,T=(0,l.v9)((function(e){return e.reports})),W=T.report,B=T.status,z=function(){W&&(t((0,I.s_)()),n.push("/admin/bulletins/crops/report/view/?docId=".concat(W.id)))},H=function(){var e="Loading...";return i.length>0&&(e=null===r.sel_province?"Select a province":"Province"),e};return(0,a.jsxs)("div",{children:[(0,a.jsx)(N.Z,{isOpen:O.savesuccess,maxWidth:"xs",openButtonText:null,title:"Success",contentText:"Success! Bulletin report created.",modalConfirmHandlerCB:z,modalCancelHandlerCB:z}),(0,a.jsx)(A.Z,{openSnackbar:""!==c,message:c,severity:"warning"}),(0,a.jsxs)(y.ZP,{container:!0,sx:F.Z.container,children:[(0,a.jsxs)(h.Z,{sx:F.Z.headerText,children:[(0,a.jsxs)(h.Z,{children:[(0,a.jsx)(j.Z,{variant:"h5",children:"10-Day Farm Weather Outlook and Advisory Bulletin"}),(0,a.jsxs)("p",{children:["Create ",(0,a.jsx)("strong",{children:"10-Day Farm Weather Outlook and Advisory"})," crop recommendations bulletins. Finalized bulletins will be automatically uploaded to the site for public download."]})]}),(0,a.jsx)(h.Z,{children:(0,a.jsx)(x.Z,{"aria-label":"exit",size:"medium",children:(0,a.jsx)(u.default,{href:"/admin/bulletins/crops",passHref:!0,children:(0,a.jsx)(f.Z,{fontSize:"inherit"})})})})]}),(0,a.jsxs)(y.ZP,{item:!0,sx:F.Z.item,xs:12,lg:4,children:[(0,a.jsx)(j.Z,{variant:"h6",children:"Selection Options"}),(0,a.jsx)(m.Z,{disablePortal:!0,id:"province",value:r.sel_province,disabled:0===i.length||w||B===k.G.PENDING,options:i,sx:F.Z.autocomplete,size:"small",PaperComponent:_.Z,renderInput:function(e){return(0,a.jsx)(g.Z,G({},e,{label:H()}))},isOptionEqualToValue:function(e,n){return e.label===n.label},onChange:function(e,n){return S(e,G({},n,{from:"province"}))}}),(0,a.jsx)(m.Z,{disablePortal:!0,id:"municipality",value:r.sel_municipality,disabled:0===o.length||w||B===k.G.PENDING,options:o,sx:F.Z.autocomplete,size:"small",PaperComponent:_.Z,renderInput:function(e){return(0,a.jsx)(g.Z,G({},e,{label:null===r.sel_municipality?"Select a municipality":"Municipality"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},onChange:function(e,n){return S(e,G({},n,{from:"municipality"}))}}),(0,a.jsxs)(v.Z,{disableElevation:!0,size:"small","aria-label":"outlined button controls group",disabled:B===k.G.PENDING||0===i.length||null===r.sel_municipality||"-"===r.sel_crop,sx:{marginTop:"16px",float:"right"},children:[(0,a.jsx)(b.Z,{variant:"outlined",onClick:C,children:"Reset"}),(0,a.jsx)(b.Z,{variant:"contained",onClick:R,children:"Generate"})]})]}),(0,a.jsx)(y.ZP,{item:!0,sx:F.Z.item,xs:12,lg:8,children:(0,a.jsxs)(h.Z,{sx:F.Z.selectionSummary,children:[(0,a.jsx)(j.Z,{variant:"h6",children:"Selection Summary"}),null===r.sel_province?(0,a.jsxs)(h.Z,{sx:F.Z.welcome,children:[(0,a.jsx)(d.default,{unoptimized:!0,src:(0,p.assetPrefixer)("images/icons/finance.svg"),height:85,width:85,loader:p.imageLoader,alt:"Empty data"}),(0,a.jsxs)(h.Z,{sx:{marginTop:"16px"},children:[(0,a.jsx)(j.Z,{variant:"subtitle2",children:"Crop Recommendations PDF Bulletins Creator"}),(0,a.jsx)(j.Z,{variant:"subtitle2",children:"Please select a province to start."})]})]}):(0,a.jsx)(h.Z,{sx:F.Z.summary,children:M.map((function(e,n){return(0,a.jsxs)("div",{children:[(0,a.jsxs)(j.Z,{variant:"subtitle2",style:{display:"inline-block"},children:[e.label,": \xa0"]}),(0,a.jsx)(j.Z,{variant:"body2",style:{display:"inline-block"},children:null!==r[e.key]?["sel_stage","sel_crop","sel_activity","sel_month"].includes(e.key)?r[e.key]:r[e.key].label:""})]},"selected-".concat(n))}))}),""!==c&&(0,a.jsx)(j.Z,{variant:"caption",sx:{color:"red"},children:c})]})})]}),(0,a.jsx)(D,{options:r,handlePreview:Z,toggleViewerOpen:E,pdfPreview:P,handleSave:L})]})},B=t(2530),z=t(3059),H=t(1690),V=t(4680),Y=t(6375),U=t(7599),K=t(6867),J=t(7246),X=t(3063);function q(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function $(e,n,t,r,i,a,o){try{var l=e[a](o),c=l.value}catch(s){return void t(s)}l.done?n(c):Promise.resolve(c).then(r,i)}function Q(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){$(a,r,i,o,l,"next",e)}function l(e){$(a,r,i,o,l,"throw",e)}o(void 0)}))}}function ee(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ne(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){ee(e,n,t[n])}))}return e}function te(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,a=[],o=!0,l=!1;try{for(t=t.call(e);!(o=(r=t.next()).done)&&(a.push(r.value),!n||a.length!==n);o=!0);}catch(c){l=!0,i=c}finally{try{o||null==t.return||t.return()}finally{if(l)throw i}}return a}}(e,n)||ie(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e){return function(e){if(Array.isArray(e))return q(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ie(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ie(e,n){if(e){if("string"===typeof e)return q(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?q(e,n):void 0}}var ae={sel_province:null,sel_municipality:null,sel_crop:"-",sel_stage:"-",sel_activity:"-",sel_month:"-",processed:!1,loading:!1,error:"",success:"",sel_condition:{id:0,from:"weather_condition",label:E.MW.WAY_BELOW_NORMAL.label}},oe={url:"",filename:""},le={preview:!1,savesuccess:!1,docId:""},ce={province:"",municipality:"",rainfall:"",date_range:"",day_format:"",date_now:(new Date).toDateString()};var se=!0,ue=(0,z.Z)((function(e){var n=te((0,c.ky)(V.o.STATIC_RECOMMENDATIONS,"data"),2),t=n[0],r=n[1],s=(0,l.v9)((function(e){return e.cropcalendar})),u=s.entities,d=s.error,p=s.status,f=(0,l.v9)((function(e){return e.recommendations})),m=f.entities,b=f.error,v=f.status,h=(0,l.v9)((function(e){return e.tendayweather})),y=h.entities,x=h.error,g=h.status,j=(0,l.v9)((function(e){return e.reports})),_=j.status,O=j.report,w=(0,l.v9)((function(e){return e.dashboard.reportType})),S=(0,o.useState)([]),Z=S[0],P=S[1],C=(0,o.useState)({}),R=C[0],L=C[1],D=(0,o.useState)(ae),N=D[0],A=D[1],F=(0,o.useState)([]),T=F[0],G=F[1],M=(0,o.useState)(ce),z=M[0],q=M[1],$=(0,o.useState)(oe),ie=$[0],se=($[1],(0,o.useState)("")),ue=se[0],de=se[1],pe=(0,o.useState)(le),fe=pe[0],me=pe[1],be=(0,o.useState)(!1),ve=(be[0],be[1]),he=(0,l.I0)();(0,o.useEffect)((function(){he((0,J.Km)([])),he((0,I.s_)())}),[he]),(0,o.useEffect)((function(){de((function(e){return x||b||d}))}),[x,b,d]),(0,o.useEffect)((function(){ve((function(e){return g||v||p}))}),[g,v,p]),(0,o.useEffect)((function(){_===k.G.FULLFILLED&&null!==O&&me(ne({},le,{savesuccess:!0,docId:O.id}))}),[_,O]),(0,o.useEffect)((function(){if(e.municipalities.length>0&&!r){var n={};P(e.municipalities.reduce((function(e,t){return-1===e.findIndex((function(e){return e.label===t.province}))?(e=re(e).concat([{id:e.length,label:t.province}]),n[t.province]=[{id:0,label:t.name}]):n[t.province].push({id:n[t.province].length,label:t.name}),e}),[])),L(n)}}),[e.municipalities,r]),(0,o.useEffect)((function(){if(g===k.G.FULLFILLED&&null!==N.sel_municipality){if(0===Object.values(y).length)return void de("Weather data is currently not available.");var e=Object.values(y).find((function(e){return e.municipality===N.sel_municipality.label})),n=JSON.parse(e.data).find((function(e){return e.day_format===function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=(new Date).toDateString();return e?n:n.substring(0,n.length-5)}(!1)}));if(!n)return void de("Weather data for the current date is not available at the moment.");var t=new Date(1e3*n.date_start.seconds),r=je(t),i=Object.values(E.MW).find((function(e){return e.tenday===n.rainfall}));q((function(e){return ne({},e,{province:n.province,municipality:n.municipality,rainfall:n.rainfall,date_range:n.date_range,day_format:n.day_format,condition:i.label||"",condition_acap:i.label_acap,format:i.sync,format_tenday:i.tenday,percentage:i.content,months:r})}))}}),[g,y,N.sel_municipality]);var ye=(0,o.useCallback)((function(e){switch(z.condition){case E.MW.BELOW_NORMAL.label:case E.MW.NEAR_NORMAL.label:return JSON.parse(e.normal).map((function(e){return{id:t.mains.find((function(n){return n.id===e.id})).description,ul:e.ul,subs:e.subs.map((function(e){return t.subs.find((function(n){return n.id===e})).description}))}}));case E.MW.ABOVE_NORMAL.label:return JSON.parse(e.wetter).map((function(e){return{id:t.mains.find((function(n){return n.id===e.id})).description,ul:e.ul,subs:e.subs.map((function(e){return t.subs.find((function(n){return n.id===e})).description}))}}));case E.MW.WAY_BELOW_NORMAL.label:return JSON.parse(e.drier).map((function(e){return{id:t.mains.find((function(n){return n.id===e.id})).description,ul:e.ul,subs:e.subs.map((function(e){return t.subs.find((function(n){return n.id===e})).description}))}}))}}),[z,t]),xe=(0,o.useCallback)((function(e){var n="".concat(z.condition_acap,"_sms");return void 0!==e[n]?t.sms.find((function(t){return t.id===e[n]})).description:""}),[z,t]);(0,o.useEffect)((function(){if(p===k.G.FULLFILLED&&v===k.G.FULLFILLED&&null!==N.sel_municipality&&!N.processed&&""!==z.rainfall){var e=Object.values(m).map((function(e){return e.crop})).filter((function(e,n,t){return t.indexOf(e)===n}));(e.includes("Rainfed Rice")||e.includes("Irrigated Rice"))&&e.push("Rice");var n=Object.keys(z.months),t=[],r=[];Object.values(u).filter((function(i){var a=[];return n.forEach((function(n){if(""!==i[n]){var o=z.months[n],l=i[n].split(",");if(0===l.length)return;if(!e.includes(i.crop))return;if(o===E.Vs.FIRST_HALF)t.includes(l[0])||t.push(l[0]);else if(o===E.Vs.SECOND_HALF){var c="";1===l.length&&(c=l[0]),2===l.length&&(c=""!==l[1]?l[1]:l[0]),t.includes(c)||t.push(c)}r.includes(i.crop)||r.push(i.crop)}a.push(""!==i[n])})),a.includes(!0)}));var i=t.map((function(e){return E.MZ[e.toUpperCase()]})),a=Object.values(m).filter((function(e){return r.includes("Rice")&&["Irrigated Rice","Rainfed Rice"].includes(e.crop)?e.province===N.sel_province.label&&e.municipality===N.sel_municipality.label&&i.includes(e.stage):e.province===N.sel_province.label&&e.municipality===N.sel_municipality.label&&i.includes(e.stage)&&r.includes(e.crop)})).map((function(e){return e.activity})).filter((function(e,n,t){return t.indexOf(e)===n})).toString().split(",").join(", ");A((function(e){return ne({},e,{processed:!0,sel_month:z.date_range,sel_crop:r.length>0?r.toString().split(",").join(", "):"-",sel_stage:t.length>0?t.map((function(e){return E.MZ[e.toUpperCase()]})).toString().split(",").join(", "):"-",sel_activity:a.length>0?a:"-",sel_condition:{label:z.condition,format:z.format,tenday:z.format_tenday,current_date:z.day_format}})}))}}),[p,v,u,m,z,N,ye,xe,he]);var ge=function(){var e=Q(i().mark((function e(n,t){var r,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.from,a=t.label,n&&n.preventDefault(),!a){e.next=19;break}e.t0=r,e.next="province"===e.t0?6:"municipality"===e.t0?12:16;break;case 6:return A(ne({},ae,{sel_province:t})),de(""),G(R[a]),he((0,K.R)(a)),he((0,J.Km)([])),e.abrupt("break",17);case 12:de(""),A(ne({},N,{sel_municipality:t,processed:!1,sel_crop:"-",sel_stage:"-",sel_activity:"-",sel_month:"-",error:""}));try{he((0,Y.a)({province:N.sel_province.label,municipality:a})),he((0,U.A)({province:N.sel_province.label,municipality:a})),he((0,J.Km)([]))}catch(i){A((function(e){return ne({},e,{loading:!1,error:i.message})}))}return e.abrupt("break",17);case 16:return e.abrupt("break",17);case 17:e.next=28;break;case 19:e.t1=r,e.next="province"===e.t1?22:"municipality"===e.t1?24:27;break;case 22:return Oe(),e.abrupt("break",28);case 24:return A(ne({},N,{sel_municipality:null,processed:!1,sel_crop:"-",sel_stage:"-",sel_activity:"-",sel_month:"-"})),he((0,J.Km)([])),e.abrupt("break",28);case 27:return e.abrupt("break",28);case 28:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),je=function(e){var n=e.getMonth(),t=Object.values(E.re).find((function(e){return e.num===n})).code,r=e.getDate(),i=function(e,n){return new Date(e,n+1,0).getDate()}(e.getFullYear(),n),a=ee({},t,r>Math.floor(i/2)?E.Vs.SECOND_HALF:E.Vs.FIRST_HALF);r+10>i&&(a[Object.values(E.re).find((function(e){return e.num===n+1})).code]=E.Vs.FIRST_HALF);return a},_e=function(){var e=Q(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Oe=function(){A(ae),G([]),he((0,J.Km)([]))},we=function(){var n=Q(i().mark((function n(){var t,r;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:try{t={region:"bicol",province:N.sel_province.label,municipality:N.sel_municipality.label,operation:"create"},he((0,H.a0)(t)).unwrap().then((function(){w!==E.Ry.TEN_DAY&&(he((0,X.u)(E.Ry.TEN_DAY)),he((0,H.RC)({uid:e.user.uid,type:E.Ry.TEN_DAY})))}))}catch(a){r="",void 0!==a.response&&(r=void 0!==a.response.data&&"[object Blob]"===((i=a.response.data)&&"undefined"!==typeof Symbol&&i.constructor===Symbol?"symbol":typeof i)?a.response.data:""),""===r&&(r=a.message),A((function(e){return ne({},e,{loading:!1,error:r})}))}case 1:case"end":return n.stop()}var i}),n)})));return function(){return n.apply(this,arguments)}}();return(0,a.jsx)(B.Z,{loading:e.loading,user:e.user,onBtnLogoutClick:e.onBtnLogoutClick,accLevel:E.DW.ADMIN,children:(0,a.jsx)(W,{sel_options:N,provinces:Z,loading:r||g===k.G.PENDING||v===k.G.PENDING||p===k.G.PENDING,optsmunicipalities:T,onSelectItemChange:ge,handlePreview:_e,toggleViewerOpen:function(){},pdfPreview:ie,resetSelections:Oe,generateRecommendations:function(){var e=N.sel_crop.split(", "),n=N.sel_stage.split(", "),t=Object.values(m).filter((function(t){return e.includes("Rice")&&["Irrigated Rice","Rainfed Rice"].includes(t.crop)?t.province===N.sel_province.label&&t.municipality===N.sel_municipality.label&&n.includes(t.stage):t.province===N.sel_province.label&&t.municipality===N.sel_municipality.label&&n.includes(t.stage)&&e.includes(t.crop)}));he((0,J.Km)(t.map((function(e){return ne({},e,{recommendations:ye(e),smsRecommendations:xe(e)})}))))},handleSave:we,error:ue,open:fe})})}))}},function(e){e.O(0,[135,203,572,433,728,448,774,888,179],(function(){return n=7947,e(e.s=n);var n}));var n=e.O();_N_E=n}]);
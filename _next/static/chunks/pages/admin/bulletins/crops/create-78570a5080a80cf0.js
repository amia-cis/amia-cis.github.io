(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[755],{5326:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/bulletins/crops/create",function(){return t(5674)}])},7513:function(e,n){"use strict";n.Z={container:{padding:"24px",width:"100%",position:"relative",minWidth:"0px",overflowWrap:"break-word",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"16px",margin:"auto",borderColor:"#E2E8F0"},welcome:{display:"grid",placeContent:"center",marginTop:function(e){return e.spacing(10)},textAlign:"center","& h5":{marginTop:function(e){return e.spacing(2)}}},conditionLegend:{maxWidth:{md:"100%",lg:"270px"},padding:function(e){return e.spacing(1)},borderRadius:"4px",border:"1px solid grey",textAlign:"center",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px"},autocomplete:{marginTop:function(e){return e.spacing(1)}},recSeasonal:{marginTop:function(e){return e.spacing(5)},"& p, ul":{fontSize:"14px"}},datagrid:{background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"8px","& .MuiDataGrid-main":{borderRadius:2},"& .MuiDataGrid-virtualScrollerRenderZone":{"& .MuiDataGrid-row":{"&:nth-of-type(2n)":{backgroundColor:"rgba(235, 235, 235, .7)"}}},"& .MuiDataGrid-columnHeader:focus-within":{outline:"none !important"},"& .MuiDataGrid-columnHeaders":{color:function(e){return e.palette.primary.dark},fontSize:16}},gridContainer:{marginTop:"24px",minHeight:500,width:1,"& .normal":{backgroundColor:"yellow"},"& .drier":{backgroundColor:"red"},"& .wetter":{backgroundColor:"blue"}},item:{}}},5674:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSG:function(){return oe},default:function(){return ae}});var r=t(4051),i=t.n(r),o=t(5893),a=t(7294),l=t(1163),c=t(3835),s=t(2848),u=t(1652),p=t(4680),d=t(560),f=new(t(4823).P),b=f.createReport.bind(f),h=t(7682),m=t(7426),v=[{label:"Select a province",description:"Select a province within the Bicol region.",opt_name:"sel_province"},{label:"Select a municipality",description:"Select a municipality included in the province you have selected on step no. 1.",opt_name:"sel_municipality"},{label:"Select a crop type",description:"Listed below are available crops for your selected province and municipality.",opt_name:"sel_crop"},{label:"Select a month",description:"Select a target month from the current Seasonal Weather Forecast.",opt_name:"sel_month"},{label:"Select crop stages",description:"Listed below are the available crop stages for your selected crop on the target month.",opt_name:"sel_stage"},{label:"Select activities",description:"Here are available activities for the previously-selected parameters.",opt_name:"sel_activity"}],g=t(1664),y=t(5675),x=t(6295),_=t(7357),j=t(9368),S=t(8456),Z=t(1057),O=t(6863),w=t(657),C=t(1425),R=t(6580),k=t(8951),E=t(7645),P=t(7720),T=t(6886),A=t(5113),I=t(6624),D=t(4472),F=t(3578),M=t(6229),N=t(1903),B=t(5861),L=t(120),W=t(1033),U=t(7702),z=t(9794),q=t(9628),G=t(7171),H=t(7513);function K(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function V(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){K(e,n,t[n])}))}return e}var J=["sel_province","sel_municipality","sel_crop","sel_month","sel_stage","sel_activity"];var $=function(e){var n=(0,a.useState)(0),t=n[0],r=n[1],i=(0,a.useRef)(!0),c=(0,l.useRouter)(),s=(0,a.useState)(!0),u=s[0],p=s[1],d=e.sel_options,f=e.provinces,b=e.recommendations,h=e.onSelectItemChange,v=e.optsmunicipalities,K=e.optscrops,$=e.optscropstages,X=e.optsactivities,Q=e.optsmonths,Y=e.open,ee=e.steps,ne=e.getStepLabel,te=e.isContinueDisabled,re=e.handleSave,ie=(0,o.jsx)(q.Z,{fontSize:"small"}),oe=(0,o.jsx)(G.Z,{fontSize:"small"});(0,a.useEffect)((function(){return i.current=!0,function(){i.current=!1}}),[]);var ae=function(){p(!1),setTimeout((function(){(i.current=!0)&&p(!0)}),500),r((function(e){return e+1}))},le=function(){r((function(e){return e-1}))},ce=function(){var e="Loading...";return f.length>0&&(e=null===d.sel_province?"Select a province":"Province"),e};return(0,o.jsxs)(U.Z,{loading:e.loading,user:e.user,onBtnLogoutClick:e.onBtnClick,children:[(0,o.jsxs)(w.Z,{open:Y,"aria-labelledby":"data-saved-success","aria-describedby":"alert-dialog-description",children:[(0,o.jsx)(E.Z,{id:"data-saved-success",children:"Success"}),(0,o.jsx)(R.Z,{children:(0,o.jsx)(k.Z,{id:"alert-dialog-description",children:"Success! Bulletin report created."})}),(0,o.jsx)(C.Z,{children:(0,o.jsx)(Z.Z,{onClick:function(){c.push("/admin/bulletins/crops")},autoFocus:!0,children:"OK"})})]}),(0,o.jsxs)(T.ZP,{container:!0,sx:H.Z.container,children:[(0,o.jsxs)(_.Z,{sx:{marginBottom:"32px"},children:[(0,o.jsx)(B.Z,{variant:"h5",children:"Create Crop Recommendations Bulletins"}),(0,o.jsxs)("p",{children:["Create ",(0,o.jsx)("strong",{children:"Seasonal"})," crop recommendations bulletins. Finalized bulletins will be automatically uploaded to the site for public download."]})]}),(0,o.jsxs)(T.ZP,{item:!0,sx:H.Z.item,xs:12,lg:4,children:[(0,o.jsxs)(_.Z,{sx:{minWidth:"100%",paddingRight:function(e){return e.spacing(2)}},children:[(0,o.jsx)(B.Z,{variant:"h6",children:"Selection Options"}),(0,o.jsx)(I.Z,{activeStep:t,orientation:"vertical",children:ee.map((function(e,n){return(0,o.jsxs)(D.Z,{children:[(0,o.jsx)(F.Z,{optional:5===n?(0,o.jsx)(B.Z,{variant:"caption",children:"Last step"}):null,children:ne(n)}),(0,o.jsxs)(M.Z,{children:[(0,o.jsx)(B.Z,{variant:"subtitle",children:e.description}),0===n&&(0,o.jsx)(x.Z,{disablePortal:!0,id:"province",value:d.sel_province,disabled:0===f.length,options:f,sx:H.Z.autocomplete,renderInput:function(e){return(0,o.jsx)(N.Z,V({},e,{label:ce()}))},isOptionEqualToValue:function(e,n){return e.label===n.label},onChange:function(e,n){return h(e,V({},n,{from:"province"}))}}),1===n&&(0,o.jsx)(x.Z,{disablePortal:!0,id:"municipality",value:d.sel_municipality,disabled:0===v.length||d.loading,options:v,sx:H.Z.autocomplete,renderInput:function(e){return(0,o.jsx)(N.Z,V({},e,{label:null===d.sel_municipality?"Select a municipality":"Municipality"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},onChange:function(e,n){return h(e,V({},n,{from:"municipality"}))}}),2===n&&(0,o.jsx)(x.Z,{disablePortal:!0,id:"crop",value:d.sel_crop,disabled:0===K.length,options:K,sx:H.Z.autocomplete,renderInput:function(e){return(0,o.jsx)(N.Z,V({},e,{label:null===d.sel_crop?"Select a crop type":"Crop"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},getOptionDisabled:function(e){return e.disabled},onChange:function(e,n){return h(e,V({},n,{from:"crop"}))}}),3===n&&(0,o.jsx)(x.Z,{disablePortal:!0,id:"month",value:d.sel_month,disabled:0===Q.length||null===d.sel_crop,options:Q,sx:H.Z.autocomplete,renderInput:function(e){return(0,o.jsx)(N.Z,V({},e,{label:null===d.sel_month?"Select a Month":"Month"}))},isOptionEqualToValue:function(e,n){return e.label===n.label},getOptionDisabled:function(e){return e.disabled},onChange:function(e,n){return h(e,V({},n,{from:"month"}))}}),4===n&&(0,o.jsx)(x.Z,{disablePortal:!0,id:"cropstage",multiple:!0,disableCloseOnSelect:!0,limitTags:1,value:d.sel_stage,disabled:0===$.length,options:$,sx:H.Z.autocomplete,renderInput:function(e){return(0,o.jsx)(N.Z,V({},e,{label:0===d.sel_stage.length?"Select crop stages":"Crop Stages"}))},getOptionDisabled:function(e){return e.disabled},onChange:function(e,n){return h(e,V({},n,{from:"cropstage"}))},renderOption:function(e,n,t){var r=t.selected;return(0,o.jsxs)("li",V({},e,{children:[(0,o.jsx)(j.Z,{id:"cropstage",icon:ie,checkedIcon:oe,style:{marginRight:8},checked:r}),n.label]}))}}),5===n&&(0,o.jsx)(x.Z,{disablePortal:!0,id:"activity",multiple:!0,disableCloseOnSelect:!0,limitTags:1,value:d.sel_activity,disabled:0===X.length,options:X.sort((function(e,n){return n.stage.localeCompare(e.stage)})),groupBy:function(e){return e.stage},sx:H.Z.autocomplete,renderInput:function(e){return(0,o.jsx)(N.Z,V({},e,{label:0===d.sel_activity.length?"Select activities":"Activities"}))},getOptionDisabled:function(e){return e.disabled},onChange:function(e,n){return h(e,V({},n,{from:"activity"}))},renderOption:function(e,n,t){var r=t.selected;return(0,o.jsxs)("li",V({},e,{children:[(0,o.jsx)(j.Z,{id:"activity",icon:ie,checkedIcon:oe,style:{marginRight:8},checked:r}),n.label]}))}}),""!==d.error&&(0,o.jsx)(B.Z,{variant:"caption",sx:{color:"red"},children:d.error}),(0,o.jsx)(_.Z,{sx:{mb:2,marginTop:"24px"},children:(0,o.jsxs)("div",{children:[(0,o.jsx)(Z.Z,{variant:"contained",disabled:te(n)||d.loading||!u,onClick:ae,children:n===ee.length-1?"Finish":"Continue"}),(0,o.jsx)(Z.Z,{disabled:d.loading||!u||0===n,onClick:le,children:"Back"})]})})]})]},e.label)}))}),t===ee.length&&(0,o.jsxs)(A.Z,{square:!0,elevation:0,sx:{p:3},children:[(0,o.jsx)(B.Z,{children:"All steps completed"}),(0,o.jsx)(Z.Z,{onClick:function(){r(0),h(null,{from:"province"})},sx:{mt:1,mr:1},children:"Restart"}),(0,o.jsx)(Z.Z,{onClick:le,sx:{mt:1,mr:1},children:"Back"})]})]}),null!==d.sel_month&&(0,o.jsxs)(_.Z,{sx:H.Z.conditionLegend,style:{backgroundColor:m.tN[d.sel_condition.label]},children:[(0,o.jsx)(B.Z,{variant:"subtitle2",children:"Seasonal Weather Condition"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("span",{children:d.sel_month.label})," \xa0",(0,o.jsxs)("span",{children:["".concat(d.sel_condition.label.charAt(0).toUpperCase()).concat(d.sel_condition.label.slice(1))," (",d.sel_condition.id,"%)"]})]})]})]}),(0,o.jsx)(T.ZP,{item:!0,sx:H.Z.item,xs:12,lg:8,children:null!==d.sel_crop&&null!==d.sel_activity&&6===t?(0,o.jsxs)("div",{children:[null!==d.sel_crop&&null!==d.sel_activity&&(0,o.jsxs)("div",{children:[(0,o.jsxs)(B.Z,{variant:"h4",sx:{display:0===d.sel_activity.length?"none":"flex"},children:[d.sel_crop.label," Recommendations"]}),(0,o.jsx)(B.Z,{variant:"h5",children:"".concat(d.sel_condition.label.charAt(0).toUpperCase()).concat(d.sel_condition.label.slice(1)," Condition")})]}),b.length>0?b.map((function(e,n){var t="Rice"===d.sel_crop.label?"(".concat(e.crop,")"):"";return(0,o.jsxs)(_.Z,{sx:H.Z.recSeasonal,children:[(0,o.jsxs)(B.Z,{variant:"h5",children:[e.stage," - ",e.activity," ",t]}),e.recommendations().map((function(e,t){return e.ul?(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:e.id}),e.subs.length>0&&(0,o.jsx)("ul",{children:e.subs.map((function(e,t){return(0,o.jsx)("li",{children:e},"sub-".concat(n,"-").concat(t))}))})]},"main-".concat(n,"-").concat(t)):(0,o.jsx)("p",{children:e.id},"main-".concat(n,"-").concat(t))}))]},"rec-".concat(n))})):(0,o.jsx)(W.Z,{message:"We cannot find recommendations for your selected options."})]}):Object.values(d).filter((function(e){return e})).length>3?(0,o.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:J.map((function(e,n){var t=["sel_stage","sel_activity"].includes(e)?d[e].length>0&&"weather_condition"!==d[e].from:null!==d[e]&&void 0!==d[e]&&void 0!==d[e].from&&"weather_condition"!==d[e].from,r=["sel_stage","sel_activity"].includes(e)?{from:{sel_stage:"cropstage",sel_activity:"activity"}[e],label:d[e].map((function(e){return e.label})).toString().split(",").join(", ")}:d[e];return t?(0,o.jsx)(z.Z,{info:r,show:n<J.length-1},"card-opt-".concat(n)):(0,o.jsx)("div",{},"card-opt-".concat(n))}))}):(0,o.jsxs)(_.Z,{sx:H.Z.welcome,children:[(0,o.jsx)(y.default,{unoptimized:!0,src:(0,L.assetPrefixer)("images/icons/finance.svg"),height:120,width:120,loader:L.imageLoader,alt:"Empty data"}),(0,o.jsx)(B.Z,{variant:"h5",children:"Crop Recommendations PDF Bulletins Creator"}),(0,o.jsx)(B.Z,{variant:"p",children:"Please select a province to start."})]})}),(0,o.jsxs)(_.Z,{sx:{marginBottom:"16px",width:"100%",display:6===t?"block":"none"},children:[(0,o.jsx)("br",{}),(0,o.jsx)(P.Z,{}),(0,o.jsx)("br",{}),""!==d.error&&(0,o.jsxs)(B.Z,{variant:"caption",sx:{color:"red"},children:["Error: ",d.error]}),(0,o.jsxs)(O.Z,{size:"large","aria-label":"large button group",sx:{display:"flex",justifyContent:"flex-end",marginTop:"8px"},children:[(0,o.jsx)(g.default,{href:"/admin/bulletins/crops",passHref:!0,children:(0,o.jsx)(Z.Z,{disabled:d.loading,children:"Cancel"})}),(0,o.jsx)(Z.Z,{disabled:d.loading,children:"Preview"}),(0,o.jsxs)(Z.Z,{variant:"contained",disableElevation:!0,onClick:re,disabled:d.loading,children:[(0,o.jsx)("span",{style:{display:d.loading?"none":"block"},children:"Save"})," \xa0",(0,o.jsx)(S.Z,{size:20,color:"secondary",sx:{display:d.loading?"block":"none"}})]})]})]})]})]})};function X(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Q(e,n,t,r,i,o,a){try{var l=e[o](a),c=l.value}catch(s){return void t(s)}l.done?n(c):Promise.resolve(c).then(r,i)}function Y(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var o=e.apply(n,t);function a(e){Q(o,r,i,a,l,"next",e)}function l(e){Q(o,r,i,a,l,"throw",e)}a(void 0)}))}}function ee(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ne(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){ee(e,n,t[n])}))}return e}function te(e){return function(e){if(Array.isArray(e))return X(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return X(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return X(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var re={sel_province:null,sel_municipality:null,sel_crop:null,sel_stage:[],sel_activity:[],sel_month:null,sel_condition:{id:0,from:"weather_condition",label:m.MW.DRIER},loading:!1,error:"",success:""};function ie(e){var n=e.municipalities,t=void 0===n?[]:n,r=(0,c.aC)(),f=(0,l.useRouter)(),g=(0,h.Kx)(p.o.CROP_REC_LIST_RECS_MAIN,"id"),y=g.documents,x=g.loading,_=(0,h.Kx)(p.o.CROP_REC_LIST_RECS_SUB,"id"),j=_.documents,S=_.loading,Z=(0,h.m$)(d.M.WEATHER_FORECASTS,"bicol",d.M.SUB_SEASONAL,"name"),O=Z.documents,w=Z.loading,C=(0,a.useState)([]),R=C[0],k=C[1],E=(0,a.useState)([]),P=E[0],T=E[1],A=(0,a.useState)([]),I=A[0],D=A[1],F=(0,a.useState)([]),M=F[0],N=F[1],B=(0,a.useState)([]),L=B[0],W=B[1],U=(0,a.useState)({}),z=U[0],q=U[1],G=(0,a.useState)(re),H=G[0],K=G[1],V=(0,a.useState)([]),J=V[0],X=V[1],Q=(0,a.useState)([]),ee=Q[0],ie=Q[1],oe=(0,a.useState)([]),ae=oe[0],le=oe[1],ce=(0,a.useState)([]),se=ce[0],ue=ce[1],pe=(0,a.useState)([]),de=pe[0],fe=pe[1],be=(0,a.useState)(!1),he=be[0],me=be[1],ve=(0,a.useRef)(!1);(0,a.useEffect)((function(){return ve.current=!0,function(){ve.current=!1}}),[]),(0,a.useEffect)((function(){r.loading||r.user||f.push("/admin/login")}),[r.user,r.loading,f]),(0,a.useEffect)((function(){if(t.length>0&&!x&&!S&&!w){var e={};O.forEach((function(n){var t=n.name.split("_").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" ");e[t]={},n.months.forEach((function(n){e[t][n.mo]={label:n.con,val:n.val}}))}));var n=[];O[0].mos.forEach((function(e){n.push({id:m.re[e.toUpperCase()].code,label:m.re[e.toUpperCase()].format,disabled:!1})}));var r={},i=[];t.forEach((function(e,n){void 0===r[e.province]?(i.push({id:n,label:e.province}),r[e.province]=[{id:0,label:e.name}]):r[e.province].push({id:r[e.province].length,label:e.name})})),ve.current&&(T(r),k(i),fe(n),q(e))}}),[t,O,x,S,w]);var ge=function(){var e=Y(i().mark((function e(n,t){var r,o,a,l,c,p,d,f,b,h,v,g,x,_,S,Z,O,w,C,R,k,E,T,A,F;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.from,o=t.label,n&&n.preventDefault(),W([]),!(["cropstage","activity"].includes(r)?Object.keys(t).length>1:Object.keys(t).includes("id"))){e.next=92;break}e.t0=r,e.next="province"===e.t0?8:"municipality"===e.t0?14:"crop"===e.t0?47:"month"===e.t0?56:"cropstage"===e.t0?66:"activity"===e.t0?76:89;break;case 8:return K(ne({},H,{sel_province:t,sel_municipality:null,sel_crop:null,sel_stage:[],sel_activity:[],sel_month:null})),X(P[o]),ie([]),le([]),ue([]),e.abrupt("break",90);case 14:return le([]),ue([]),a=[],e.prev=17,K(ne({},H,{loading:!0,error:""})),e.next=21,(0,u.$K)(H.sel_province.label,o);case 21:l=e.sent,((a=l.map((function(e){return e.crop})).filter((function(e,n,t){return t.indexOf(e)===n}))).includes("Rainfed Rice")||a.includes("Irrigated Rice"))&&a.push("Rice"),ve.current&&D((function(e){return l})),e.next=30;break;case 27:e.prev=27,e.t1=e.catch(17),K((function(n){return ne({},n,{loading:!1,error:e.t1.message})}));case 30:if(0!==a.length){e.next=33;break}return K((function(e){return ne({},e,{loading:!1,error:"There was an error loading data."})})),e.abrupt("return");case 33:return e.prev=33,e.next=36,(0,s.OP)(H.sel_province.label,o);case 36:c=e.sent,p=[],(d=c.map((function(e){return e.crop})).filter((function(e,n,t){return t.indexOf(e)===n}))).forEach((function(e,n){p.push({id:n,label:e,disabled:!a.includes(e)})})),ve.current&&(f=0===d.length?{id:"novalues",label:"No crop types for ".concat(o)}:null,K(ne({},H,{sel_municipality:t,sel_crop:f,sel_stage:[],sel_activity:[],sel_month:null,loading:!1,error:""})),le(p),ie((function(e){return p})),N((function(e){return c}))),e.next=46;break;case 43:e.prev=43,e.t2=e.catch(33),K((function(n){return ne({},n,{loading:!1,error:e.t2.message})}));case 46:return e.abrupt("break",90);case 47:return le([]),ue([]),K(ne({},H,{sel_crop:t,sel_stage:[],sel_activity:[],sel_month:null})),b=[],M.filter((function(e){return e.crop===o&&e.province===H.sel_province.label&&e.municipality===H.sel_municipality.label})).forEach((function(e){de.forEach((function(n){""===e[n.id]||b.includes(n.id)||b.push(n.id)}))})),h=te(de),de.forEach((function(e,n){h[n].disabled=!b.includes(e.id)})),fe(h),e.abrupt("break",90);case 56:return v=z[H.sel_province.label][t.id].label,g=z[H.sel_province.label][t.id].val,ue([]),x=[],_=[],M.forEach((function(e,n){var r=Object.values(m.re).find((function(e){return e.format===t.label})).code;if(""!==e[r]&&e.crop===H.sel_crop.label)for(var i=function(e){if(o[e].length>0&&!x.includes(o[e])){x.push(o[e]);var n=I.filter((function(n){return n.stage===m.MZ[o[e].toUpperCase()]&&("Rice"===H.sel_crop.label?["Irrigated Rice","Rainfed Rice"].includes(n.crop):n.crop===H.sel_crop.label)})).map((function(e){return e.activity})).filter((function(e,n,t){return t.indexOf(e)==n}));_.push({id:_.length,label:m.MZ[o[e].toUpperCase()],disabled:0===n.length})}},o=e[r].split(","),a=0;a<o.length;a+=1)i(a)})),S=0===_.length?[{id:"novalues",label:"No crop stage for ".concat(o)}]:[],le(_),K(ne({},H,{sel_month:t,sel_stage:S,sel_activity:[],sel_condition:{label:v,id:g}})),e.abrupt("break",90);case 66:for(O in Z=[],t)"from"!==O&&Z.push(t[O]);return w=[],C=I.filter((function(e){return Z.map((function(e){return e.label})).includes(e.stage)&&("Rice"===H.sel_crop.label?["Irrigated Rice","Rainfed Rice"].includes(e.crop):e.crop===H.sel_crop.label)})).map((function(e){return{activity:e.activity,stage:e.stage}})).filter((function(e,n,t){return t.map((function(e){return e.activity})).indexOf(e.activity)===n})),R=0===C.length?[{id:"novalues",label:"No activities for selected options"}]:[],K(ne({},H,{sel_stage:te(Z),sel_activity:te(R)})),k=[],C.forEach((function(e,n){k.includes(e.activity)||(w.push({id:n,label:e.activity,stage:e.stage}),k.push(e.activity))})),ue((function(e){return w})),e.abrupt("break",90);case 76:e.t3=regeneratorRuntime.keys(H);case 77:if((e.t4=e.t3()).done){e.next=83;break}if(E=e.t4.value,null!==H[E]||"sel_activity"===E){e.next=81;break}return e.abrupt("return");case 81:e.next=77;break;case 83:for(A in T=[],t)"from"!==A&&T.push(t[A]);return F=I.filter((function(e){return T.map((function(e){return e.label})).includes(e.activity)&&H.sel_stage.map((function(e){return e.label})).includes(e.stage)&&("Rice"===H.sel_crop.label?["Irrigated Rice","Rainfed Rice"].includes(e.crop):e.crop===H.sel_crop.label)})).map((function(e){return{province:e.province,municipality:e.municipality,crop:e.crop,stage:e.stage,activity:e.activity,recommendations:function(){switch(H.sel_condition.label){case m.MW.NORMAL:return JSON.parse(e.normal).map((function(e){return{id:y.find((function(n){return n.id===e.id})).description,ul:e.ul,subs:e.subs.map((function(e){return j.find((function(n){return n.id===e})).description}))}}));case m.MW.WETTER:return JSON.parse(e.wetter).map((function(e){return{id:y.find((function(n){return n.id===e.id})).description,ul:e.ul,subs:e.subs.map((function(e){return j.find((function(n){return n.id===e})).description}))}}));case m.MW.DRIER:return JSON.parse(e.drier).map((function(e){return{id:y.find((function(n){return n.id===e.id})).description,ul:e.ul,subs:e.subs.map((function(e){return j.find((function(n){return n.id===e})).description}))}}))}}}})),K(ne({},H,{sel_activity:te(T)})),W(F),e.abrupt("break",90);case 89:return e.abrupt("break",90);case 90:e.next=93;break;case 92:"province"===r?(K(re),X([]),ie([]),le([]),ue([])):"municipality"===r?(K(ne({},H,{sel_municipality:null,sel_crop:null,sel_stage:[],sel_activity:[],sel_month:null})),ie([]),le([]),ue([])):"crop"===r?(K(ne({},H,{sel_crop:null,sel_stage:[],sel_activity:[],sel_month:null})),le([]),ue([])):"month"===r?(K(ne({},H,{sel_month:null,sel_stage:[],sel_activity:[]})),le([]),ue([])):"cropstage"===r?(K(ne({},H,{sel_stage:[],sel_activity:[]})),ue([])):"activity"===r&&K(ne({},H,{sel_activity:[]}));case 93:case"end":return e.stop()}}),e,null,[[17,27],[33,43]])})));return function(n,t){return e.apply(this,arguments)}}(),ye=function(){var e=Y(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.logOut();case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),xe=function(){var e=Y(i().mark((function e(){var n,t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K((function(e){return ne({},e,{loading:!0,error:"",success:""})})),n=Object.values(m.re).find((function(e){return e.format===H.sel_month.label})).code,e.prev=2,t={region:"bicol",province:H.sel_province.label,municipality:H.sel_municipality.label,crop:H.sel_crop.label,month:n,stages:H.sel_stage.map((function(e){return e.label})),activities:H.sel_activity.map((function(e){return e.label}))},e.next=6,b(t);case 6:K((function(e){return ne({},e,{loading:!1,success:"Report created."})})),me(!0),e.next=16;break;case 10:e.prev=10,e.t0=e.catch(2),r="",void 0!==e.t0.response&&(r=void 0!==e.t0.response.data?e.t0.response.data:""),""===r&&(r=e.t0.message),K((function(e){return ne({},e,{loading:!1,error:r})}));case 16:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}();return(0,o.jsx)($,{loading:r.loading,user:r.user,onBtnClick:ye,sel_options:H,open:he,provinces:R,recommendations:L,optsmunicipalities:J,optscrops:ee,optscropstages:ae,optsactivities:se,optsmonths:de,steps:v,conditions:[{id:"norm",label:"Normal Conditions"},{id:"wet",label:"Wetter than Normal Conditions"},{id:"dry",label:"Drier than Normal Conditions"}],onSelectItemChange:ge,getStepLabel:function(e){var n=v[e].opt_name,t=["sel_stage","sel_activity"],r=t.includes(n)?0===H[n].length?v[e].label:"".concat(v[e].label,": ").concat(H[n].map((function(e){return e.label})).toString()):null===H[n]?v[e].label:"".concat(v[e].label,": ").concat(H[n].label);return t.includes(n)?0===H[n].length?v[e].label:r:null!==H[n]&&"novalues"===H[n].id?v[e].label:r},isContinueDisabled:function(e){switch(e){case 0:return null===H.sel_province;case 1:return null===H.sel_municipality;case 2:return null===H.sel_crop||"novalues"===H.sel_crop.id;case 3:return null===H.sel_month;case 4:return 0===H.sel_stage.length;case 5:return 0===H.sel_activity.length;default:return!1}},handleSave:xe})}ie.customLayout=!0,ie.adminPage=!0;var oe=!0,ae=ie},4823:function(e,n,t){"use strict";t.d(n,{u:function(){return g},P:function(){return y}});var r=t(4051),i=t.n(r),o=t(9669),a=t.n(o),l=t(9431);function c(e,n,t,r,i,o,a){try{var l=e[o](a),c=l.value}catch(s){return void t(s)}l.done?n(c):Promise.resolve(c).then(r,i)}function s(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function u(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function f(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){p(e,n,t[n])}))}return e}function b(e,n){return!n||"object"!==m(n)&&"function"!==typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):n}function h(e,n){return h=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},h(e,n)}var m=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function v(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=d(e);if(n){var i=d(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return b(this,t)}}var g={BASE_API_URL:"https://amia-cis.herokuapp.com/api",CREATE_REPORT:"".concat("https://amia-cis.herokuapp.com/api","/bulletins/seasonal/crops"),REPORTS_CROPS:"reports_crops"},y=function(e){!function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&h(e,n)}(l,e);var n,t,r,o=v(l);function l(){return s(this,l),o.apply(this,arguments)}return n=l,t=[{key:"createReport",value:function(e){var n,t=this;return(n=i().mark((function n(){var r,o;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.createRequestObject({body:e});case 2:return r=n.sent,n.next=5,a()(f({},r,{url:g.CREATE_REPORT,method:"POST"}));case 5:return o=n.sent,n.abrupt("return",o.data);case 7:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(r,i){var o=n.apply(e,t);function a(e){c(o,r,i,a,l,"next",e)}function l(e){c(o,r,i,a,l,"throw",e)}a(void 0)}))})()}}],t&&u(n.prototype,t),r&&u(n,r),l}(l.Z)}},function(e){e.O(0,[369,295,531,669,864,27,498,328,899,642,774,888,179],(function(){return n=5326,e(e.s=n);var n}));var n=e.O();_N_E=n}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[406],{3622:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/bulletins/crops",function(){return n(1995)}])},7513:function(e,t){"use strict";t.Z={container:{padding:"24px",width:"100%",position:"relative",minWidth:"0px",overflowWrap:"break-word",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"16px",margin:"auto",borderColor:"#E2E8F0"},welcome:{display:"grid",placeContent:"center",marginTop:function(e){return e.spacing(10)},textAlign:"center","& h5":{marginTop:function(e){return e.spacing(2)}}},conditionLegend:{maxWidth:{md:"100%",lg:"270px"},padding:function(e){return e.spacing(1)},borderRadius:"4px",border:"1px solid grey",textAlign:"center",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px"},autocomplete:{marginTop:function(e){return e.spacing(1)}},recSeasonal:{marginTop:function(e){return e.spacing(5)},"& p, ul":{fontSize:"14px"}},datagrid:{background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"8px","& .MuiDataGrid-main":{borderRadius:2},"& .MuiDataGrid-virtualScrollerRenderZone":{"& .MuiDataGrid-row":{"&:nth-of-type(2n)":{backgroundColor:"rgba(235, 235, 235, .7)"}}},"& .MuiDataGrid-columnHeader:focus-within":{outline:"none !important"},"& .MuiDataGrid-columnHeaders":{color:function(e){return e.palette.primary.dark},fontSize:16}},gridContainer:{marginTop:"24px",minHeight:500,width:1,"& .normal":{backgroundColor:"yellow"},"& .drier":{backgroundColor:"red"},"& .wetter":{backgroundColor:"blue"}},item:{}}},1995:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return W}});var r=n(4051),o=n.n(r),a=n(5893),i=n(7294),c=n(1163),u=n(3835),l=n(7682),s=n(4823),p=n(1664),d=n(5861),f=n(7357),b=n(1057),m=n(7462),h=n(3366),v=n(6010),g=n(1496),y=n(7192),x=n(3490),w=n(8836);const P=["className","children"],O=(0,g.ZP)("div",{name:"MuiDataGrid",slot:"ToolbarContainer",overridesResolver:(e,t)=>t.toolbarContainer})((({theme:e})=>({display:"flex",alignItems:"center",padding:e.spacing(.5,.5,0)}))),j=i.forwardRef((function(e,t){const{className:n,children:r}=e,o=(0,h.Z)(e,P),i=(e=>{const{classes:t}=e;return(0,y.Z)({root:["toolbarContainer"]},x.d,t)})({classes:(0,w.B)().classes});return r?(0,a.jsx)(O,(0,m.Z)({ref:t,className:(0,v.Z)(n,i.root)},o,{children:r})):null}));var S=n(4696),C=n(269),R=n(7476),k=n(9630);const _=["onClick"],T=i.forwardRef((function(e,t){var n;const{onClick:r}=e,o=(0,h.Z)(e,_),i=(0,k.l)(),c=(0,w.B)(),{open:u,openedPanelValue:l}=(0,S.P)(i,C.e);return c.disableColumnSelector?null:(0,a.jsx)(c.components.BaseButton,(0,m.Z)({ref:t,size:"small",color:"primary","aria-label":i.current.getLocaleText("toolbarColumnsLabel"),startIcon:(0,a.jsx)(c.components.ColumnSelectorIcon,{})},o,{onClick:e=>{u&&l===R.y.columns?i.current.hidePreferences():i.current.showPreferences(R.y.columns),null==r||r(e)}},null==(n=c.componentsProps)?void 0:n.baseButton,{children:i.current.getLocaleText("toolbarColumns")}))}));var F=n(8082),E=n(8216),Z=n(198),L=n(1207);const B=["componentsProps"],D=(0,g.ZP)("ul",{name:"MuiDataGrid",slot:"ToolbarFilterList",overridesResolver:(e,t)=>t.toolbarFilterList})((({theme:e})=>({margin:e.spacing(1,1,.5),padding:e.spacing(0,1)}))),I=i.forwardRef((function(e,t){var n,r;const{componentsProps:o={}}=e,c=(0,h.Z)(e,B),u=o.button||{},l=(0,k.l)(),s=(0,w.B)(),p=(0,S.P)(l,L.DY),d=(0,S.P)(l,Z.WH),f=(0,S.P)(l,C.e),b=(e=>{const{classes:t}=e;return(0,y.Z)({root:["toolbarFilterList"]},x.d,t)})({classes:s.classes}),v=i.useMemo((()=>{if(f.open)return l.current.getLocaleText("toolbarFiltersTooltipHide");if(0===p.length)return l.current.getLocaleText("toolbarFiltersTooltipShow");const e=e=>d[e.columnField].filterOperators.find((t=>t.value===e.operatorValue)).label||l.current.getLocaleText(`filterOperator${(0,E.Z)(e.operatorValue)}`).toString();return(0,a.jsxs)("div",{children:[l.current.getLocaleText("toolbarFiltersTooltipActive")(p.length),(0,a.jsx)(D,{className:b.root,children:p.map(((t,n)=>(0,m.Z)({},d[t.columnField]&&(0,a.jsx)("li",{children:`${d[t.columnField].headerName||t.columnField}\n                  ${e(t)}\n                  ${t.value}`},n))))})]})}),[l,f.open,p,d,b]);return s.disableColumnFilter?null:(0,a.jsx)(s.components.BaseTooltip,(0,m.Z)({title:v,enterDelay:1e3},c,null==(n=s.componentsProps)?void 0:n.baseTooltip,{children:(0,a.jsx)(s.components.BaseButton,(0,m.Z)({ref:t,size:"small",color:"primary","aria-label":l.current.getLocaleText("toolbarFiltersLabel"),startIcon:(0,a.jsx)(F.Z,{badgeContent:p.length,color:"primary",children:(0,a.jsx)(s.components.OpenFilterButtonIcon,{})})},u,{onClick:e=>{var t;const{open:n,openedPanelValue:r}=f;n&&r===R.y.filters?l.current.hideFilterPanel():l.current.showFilterPanel(),null==(t=u.onClick)||t.call(u,e)}},null==(r=s.componentsProps)?void 0:r.baseButton,{children:l.current.getLocaleText("toolbarFilters")}))}))}));var M=n(9208),N=n(7702),A=n(7513);function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function H(e){return(0,a.jsxs)(j,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){G(e,t,n[t])}))}return e}({},e,{children:[(0,a.jsx)(T,{}),(0,a.jsx)(I,{})]}))}var z=function(e){var t=e.rows,n=e.columns,r=e.loading,o=e.loadingReports,i=e.user,u=e.onBtnClick,l=(0,c.useRouter)();return(0,a.jsxs)(N.Z,{loading:r,user:i,onBtnLogoutClick:u,children:[(0,a.jsx)(d.Z,{variant:"h5",children:"Crop Recommendations"}),(0,a.jsxs)("p",{children:["Create and preview ",(0,a.jsx)("strong",{children:"10-Day"})," and ",(0,a.jsx)("strong",{children:"Seasonal"})," crop bulletins. Finalized bulletins will be automatically uploaded to the site for public download."]}),(0,a.jsx)(p.default,{href:"/admin/bulletins/crops/create",passHref:!0,children:(0,a.jsx)(b.Z,{variant:"contained",children:"Create Bulletin"})}),(0,a.jsx)(f.Z,{sx:A.Z.gridContainer,style:{height:t.length<5?"500px":"unset"},children:(0,a.jsx)(M._,{rows:t,columns:n,sx:A.Z.datagrid,autoHeight:t.length>5,disableDensitySelector:!0,rowsPerPageOptions:[15,30,100],components:{Toolbar:H},loading:o,initialState:{columns:{columnVisibilityModel:{rowId:!1}}},onRowClick:function(e){l.push({pathname:"/admin/bulletins/crops/view",query:{docId:e.row.docId}})}})})]})};function V(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,o)}function $(){var e=(0,u.aC)(),t=(0,c.useRouter)(),n=(0,l.Kx)(s.u.REPORTS_CROPS,"date_created"),r=n.documents,p=n.loading,d=(0,i.useState)([]),f=d[0],b=d[1],m=(0,i.useState)([]),h=m[0],v=m[1];(0,i.useEffect)((function(){if(r.length>0){var e={crop:"Crop",province:"Province",municipality:"Municipality",updated_by:"Updated by",date_created:"Date Created"},t=[];["crop","province","municipality","updated_by","date_created"].forEach((function(n){t.push({field:n,headerName:e[n],width:200,editable:!1,sortable:!1,disableColumnMenu:!0})}));var n=r.map((function(e,t){return{id:t,docId:e.id,crop:e.crop,province:e.province,municipality:e.municipality,updated_by:e.updated_by,date_created:e.date_created.toDate().toDateString()}}));b(n),v(t)}}),[r]),(0,i.useEffect)((function(){e.loading||e.user||t.push("/admin/login")}),[e.user,e.loading,t]);var g=function(){var t,n=(t=o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.logOut();case 3:t.next=7;break;case 5:t.prev=5,t.t0=t.catch(0);case 7:case"end":return t.stop()}}),t,null,[[0,5]])})),function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(e){V(a,r,o,i,c,"next",e)}function c(e){V(a,r,o,i,c,"throw",e)}i(void 0)}))});return function(){return n.apply(this,arguments)}}();return(0,a.jsx)(z,{loading:e.loading,user:e.user,rows:f,columns:h,loadingReports:p,onBtnClick:g})}$.customLayout=!0,$.adminPage=!0;var W=$},7682:function(e,t,n){"use strict";n.d(t,{ky:function(){return d},Kx:function(){return f},m$:function(){return b}});var r=n(4051),o=n.n(r),a=n(7294),i=n(5321),c=n(4768);function u(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){u(a,r,o,i,c,"next",e)}function c(e){u(a,r,o,i,c,"throw",e)}i(void 0)}))}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){s(e,t,n[t])}))}return e}function d(e,t){var n=(0,a.useState)(null),r=n[0],u=n[1],s=(0,a.useState)(!0),p=s[0],d=s[1],f=(0,a.useState)(""),b=f[0],m=f[1],h=(0,a.useRef)(!0);return(0,a.useEffect)((function(){var n=function(){var n=l(o().mark((function n(){var r,a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r=(0,i.JU)(c.db,e,t),n.next=4,(0,i.QT)(r);case 4:(a=n.sent).exists()&&h.current&&(u(a.data()),d(!1)),n.next=12;break;case 8:n.prev=8,n.t0=n.catch(0),m(n.t0.message),d(!1);case 12:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}();return n(),function(){return h.current=!1}}),[e,t]),[r,p,b]}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=(0,a.useState)([]),u=r[0],s=r[1],d=(0,a.useState)(!0),f=d[0],b=d[1],m=(0,a.useState)(""),h=m[0],v=m[1],g=(0,a.useRef)(!0);return(0,a.useEffect)((function(){var r=function(){var r=l(o().mark((function r(){var a,u,l;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,a=(0,i.hJ)(c.db,e),u=n||(0,i.IO)(a,(0,i.Xo)(t,"asc")),r.next=5,(0,i.PL)(u);case 5:l=r.sent,g.current&&(s(l.docs.map((function(e){return p({},e.data())}))),b(!1)),r.next=13;break;case 9:r.prev=9,r.t0=r.catch(0),v(r.t0.message),b(!1);case 13:case"end":return r.stop()}}),r,null,[[0,9]])})));return function(){return r.apply(this,arguments)}}();return r(),function(){return g.current=!1}}),[e,t,n]),{documents:u,loading:f,error:h}}function b(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",u=(0,a.useState)([]),s=u[0],d=u[1],f=(0,a.useState)(!0),b=f[0],m=f[1],h=(0,a.useState)(""),v=h[0],g=h[1],y=(0,a.useRef)(!0);return(0,a.useEffect)((function(){var a=function(){var a=l(o().mark((function a(){var u,l;return o().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,u=(0,i.IO)((0,i.hJ)(c.db,e,t,n),(0,i.Xo)(r)),o.next=4,(0,i.PL)(u);case 4:l=o.sent,y.current&&(d(l.docs.map((function(e){return p({},e.data())}))),m(!1)),o.next=12;break;case 8:o.prev=8,o.t0=o.catch(0),g(o.t0.message),m(!1);case 12:case"end":return o.stop()}}),a,null,[[0,8]])})));return function(){return a.apply(this,arguments)}}();return a(),function(){return y.current=!1}}),[e,t,n,r]),{documents:s,loading:b,error:v}}},4823:function(e,t,n){"use strict";n.d(t,{u:function(){return g},P:function(){return y}});var r=n(4051),o=n.n(r),a=n(9669),i=n.n(a),c=n(9431);function u(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,o)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){p(e,t,n[t])}))}return e}function b(e,t){return!t||"object"!==h(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}var h=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var o=d(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return b(this,n)}}var g={BASE_API_URL:"https://amia-cis.herokuapp.com/api",CREATE_REPORT:"".concat("https://amia-cis.herokuapp.com/api","/bulletins/seasonal/crops"),REPORTS_CROPS:"reports_crops"},y=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(c,e);var t,n,r,a=v(c);function c(){return l(this,c),a.apply(this,arguments)}return t=c,n=[{key:"createReport",value:function(e){var t,n=this;return(t=o().mark((function t(){var r,a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.createRequestObject({body:e});case 2:return r=t.sent,t.next=5,i()(f({},r,{url:g.CREATE_REPORT,method:"POST"}));case 5:return a=t.sent,t.abrupt("return",a.data);case 7:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(e){u(a,r,o,i,c,"next",e)}function c(e){u(a,r,o,i,c,"throw",e)}i(void 0)}))})()}}],n&&s(t.prototype,n),r&&s(t,r),c}(c.Z)}},function(e){e.O(0,[369,295,531,669,208,899,774,888,179],(function(){return t=3622,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
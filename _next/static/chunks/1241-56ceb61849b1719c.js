"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1241],{55688:function(e,n,t){var r=t(85893),i=t(67294),o=t(45697),a=t.n(o),l=t(14866),s=t(46901);function c(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var u=i.forwardRef((function(e,n){return(0,r.jsx)(s.Z,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){c(e,n,t[n])}))}return e}({elevation:6,ref:n,variant:"filled"},e))}));function d(e){var n=e.openSnackbar,t=e.message,o=e.severity,a=e.closeHandlerCB,s=void 0===a?function(){}:a,c=(0,i.useState)(n),d=c[0],p=c[1];(0,i.useEffect)((function(){p(n)}),[n]);var f=function(){p(!1),s()};return(0,r.jsx)(l.Z,{open:d,autoHideDuration:3e3,onClose:f,children:(0,r.jsx)(u,{onClose:f,severity:o,sx:{width:"100%"},children:t})})}d.propTypes={openSnackbar:a().bool,message:a().string,severity:a().string},n.Z=d},30340:function(e,n,t){t.d(n,{Z:function(){return V}});var r=t(85893),i=t(67294),o=t(9473),a=t(11163),l=t(45697),s=t.n(l),c=t(41664),u=t(21023),d=t(76295),p=t(11057),f=t(56863),g=t(87357),b=t(86886),m=t(93946),x=t(61903),h=t(15861),v=t(11829),y=t(19227),j=t(22094),w=t(98456),S=t(87918),Z=t(67720),O=t(40044),C=t(88409),E=t(53063),P=t(47426),_=t(901),T=t(27692),k={container:{padding:"24px",width:"100%",position:"relative",minWidth:"0px",overflowWrap:"break-word",background:"#FFFFFF",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",borderRadius:"16px",borderColor:"#E2E8F0"},welcome:{border:"1px solid #DCEDC8",borderRadius:function(e){return e.spacing(1)},width:"100%",display:"grid",placeContent:"center",padding:"20px",marginTop:function(e){return e.spacing(1)},textAlign:"center","& h6":{lineHeight:"20px"}},summary:{border:"1px solid #DCEDC8",borderRadius:function(e){return e.spacing(1)},marginTop:function(e){return e.spacing(1)},padding:function(e){return e.spacing(3)}},selectionSummary:{minWidth:"100%",paddingLeft:{xs:0,lg:"16px"}},conditionLegend:{borderRadius:function(e){return e.spacing(1)},width:"100%",padding:function(e){return e.spacing(1)},border:"1px solid grey",textAlign:"center",boxShadow:"rgb(0 0 0 / 2%) 0px 3.5px 5.5px",float:"left"},autocomplete:{marginTop:function(e){return e.spacing(1)}},recSeasonal:{marginTop:function(e){return e.spacing(1)},"& p, ul, ol":{fontSize:"14px"}},button:{color:"#FFFFFF",textTransform:"capitalize",fontSize:"14px",fontStyle:"normal",fontWeight:"normal",width:"80px",height:{xs:"40px",sm:"50px"}},pdfcontent:{ul:{paddingLeft:3}}};function D(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function I(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){D(e,n,t[n])}))}return e}function A(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}function F(e){var n=function(e){var n=e.children,t=e.value,i=e.index,o=A(e,["children","value","index"]);return(0,r.jsx)("div",I({role:"tabpanel",hidden:t!==i,id:"simple-tabpanel-".concat(i),"aria-labelledby":"simple-tab-".concat(i)},o,{children:t===i&&(0,r.jsx)(g.Z,{sx:{p:3,whiteSpace:e.smsstyle},children:n})}))},t=function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}},a=e.options,l=e.smstext,s=e.loading,u=e.handleSave,d=e.handlePreview,m=e.show,x=void 0===m||m,v=e.isCreateDisabled,y=void 0!==v&&v,j=e.keyEng,D=void 0===j?"practice":j,F=e.keyTag,L=void 0===F?"practice_tag":F,R=e.reportType,M=void 0===R?"seasonal":R,z=e.formTitle,H=void 0===z?"":z,B=(0,o.I0)(),N=(0,o.v9)((function(e){return e.recommendations})).filtered_recommendations,W=(0,o.v9)((function(e){return e.reports})),V=W.error,G=W.status,q=(0,o.v9)((function(e){return e.dashboard.isEnglish})),U=(0,i.useState)(0),$=U[0],J=U[1],X=(0,i.useState)(!1),Y=X[0],K=X[1];(0,i.useEffect)((function(){K(a.loading||G===_.G.PENDING)}),[a.loading,G]);return(0,r.jsxs)(b.ZP,{container:!0,sx:k.container,gap:3,style:{marginTop:"24px"},children:[(0,r.jsxs)(b.ZP,{item:!0,sx:k.item,xs:12,lg:12,children:[(0,r.jsxs)(g.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsx)(h.Z,{variant:"h6",children:"Crop Recommendations"}),(0,r.jsx)(w.Z,{size:24,color:"primary",sx:{display:s?"block":"none"}})]}),null!==N&&x&&(0,r.jsxs)(g.Z,{children:[(0,r.jsxs)(g.Z,{sx:{display:{md:"block",lg:"flex"}},children:[(0,r.jsx)(h.Z,{variant:"h5",sx:{flexGrow:{xs:12,sm:3}},children:H}),(0,r.jsx)(g.Z,{sx:{flexGrow:{xs:12,sm:1}},children:(0,r.jsxs)(g.Z,{sx:k.conditionLegend,style:{visibility:null!==a.sel_month&&x&&"tenday"===M?"hidden":"block",color:[P.MW.ABOVE_NORMAL.label,P.MW.WAY_BELOW_NORMAL.label].includes(a.sel_condition.label)?"#fff":"#000",backgroundColor:P.tN[a.sel_condition.label]},children:[(0,r.jsx)(h.Z,{variant:"subtitle2",children:"Rainfall Intensity"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:a.sel_condition.current_date})," \xa0",(0,r.jsxs)("span",{children:[a.sel_condition.format," ","(",a.sel_condition.tenday,")"]})]})]})})]}),(0,r.jsxs)(g.Z,{sx:{width:"100%",marginTop:{xs:"85px",lg:"0px"}},children:[(0,r.jsx)(g.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,r.jsxs)(C.Z,{value:$,onChange:function(e,n){J(n)},"aria-label":"basic tabs example",children:[(0,r.jsx)(O.Z,I({label:"PDF FORM"},t(0))),(0,r.jsx)(O.Z,I({label:"SMS FORM"},t(1)))]})}),(0,r.jsxs)(n,{value:$,index:0,smsstyle:"normal",children:[(0,r.jsxs)(g.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[(0,r.jsx)(h.Z,{variant:"h4",children:"Practices"}),(0,r.jsx)(S.Z,{size:"medium",variant:"outlined",label:q?"Tagalog":"English",onClick:function(){return B((0,E.cX)())},sx:{width:"90px"}})]}),Object.keys(N).map((function(e){return Object.keys(N[e]).map((function(n,t){return(0,r.jsxs)(g.Z,{sx:k.recSeasonal,children:[(0,r.jsxs)(h.Z,{variant:"h6",children:[e," - ",n]}),(0,r.jsx)(T.Z,{recommendations:N[e][n],title:"",subtitle:"",titleFontSize:"h6",recommendationsEng:D,recommendationsTag:L,isTagalog:!q})]},"rec-".concat(t))}))}))]}),(0,r.jsx)(n,{value:$,index:1,smsstyle:"pre-wrap",children:l})]})]})]}),(0,r.jsxs)(g.Z,{sx:{marginBottom:"16px",width:"100%",display:null!==N&&x?"block":"none"},children:[(0,r.jsx)("br",{}),(0,r.jsx)(Z.Z,{}),(0,r.jsx)("br",{}),""!==V&&(0,r.jsxs)(h.Z,{variant:"caption",sx:{color:"red"},children:["Error: ",V]}),(0,r.jsxs)(f.Z,{size:"large","aria-label":"large button group",sx:{display:"flex",justifyContent:"flex-end",marginTop:"8px"},children:[(0,r.jsx)(c.default,{href:"/admin/bulletins/crops",passHref:!0,children:(0,r.jsx)(p.Z,{disabled:Y,children:"Cancel"})}),(0,r.jsxs)(p.Z,{onClick:d,disabled:Y,children:[(0,r.jsx)("span",{style:{display:Y?"none":"block"},children:"Preview"})," ","\xa0",(0,r.jsx)(w.Z,{size:20,color:"secondary",sx:{display:Y?"block":"none"}})]}),(0,r.jsx)(p.Z,{variant:"contained",onClick:u,disableElevation:!0,disabled:Y||y,children:"Save"})]})]})]})}F.propTypes={options:s().object,smstext:s().string,keyEng:s().string,keyTag:s().string,formTitle:s().string,isCreateDisabled:s().bool,show:s().bool,loading:s().bool,handleSave:s().func,handlePreview:s().func};var L=F,R=t(79316),M=t(55688),z=t(12671),H=t(22757);function B(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){B(e,n,t[n])}))}return e}function W(e){var n=(0,i.useState)(!1),t=n[0],l=n[1],s=(0,a.useRouter)(),w=(0,o.I0)(),S=e.open,Z=e.loading,O=e.isloadingreport,C=e.isdisabled,E=e.optsprovinces,P=e.optsmunicipalities,_=e.optscropstages,T=e.optsactivities,k=e.sel_options,D=e.message,I=e.smstext,A=e.pageTitle,F=void 0===A?"":A,B=e.pageDescription,W=void 0===B?"":B,V=e.pdfPreview,G=e.handlePreview,q=e.handleSave,U=e.resetSelections,$=e.togglePrompt,J=e.toggleViewerOpen,X=e.onSelectItemChange,Y=(0,o.v9)((function(e){return e.reports})).report;(0,i.useEffect)((function(){null===k.sel_municipality&&!0===t&&l(!1)}),[k.sel_municipality,t]);var K=function(){Y&&(w((0,z.s_)()),s.push("/admin/bulletins/crops/report/view/?docId=".concat(Y.id)))},Q=function(){var e="Loading...";return E.length>0&&(e=null===k.sel_province?"Select a province":"Province"),e};return(0,r.jsxs)("div",{children:[(0,r.jsx)(y.Z,{isOpen:D.isOpen,maxWidth:"xs",openButtonText:null,title:D.title,contentText:D.msg,loading:D.loading,modalCancelHandlerCB:function(){D.savesuccess?K():$()},modalConfirmHandlerCB:function(){D.savesuccess?K():q()}}),(0,r.jsx)(j.Z,{open:S,pdfPreview:V,error:k.error,loading:k.loading,toggleViewerOpen:J}),(0,r.jsx)(M.Z,{openSnackbar:""!==k.error,message:k.error,severity:"warning"}),(0,r.jsxs)(b.ZP,{container:!0,sx:H.Z.container,children:[(0,r.jsxs)(g.Z,{sx:H.Z.headerText,children:[(0,r.jsxs)(g.Z,{children:[(0,r.jsx)(h.Z,{variant:"h5",children:F}),(0,r.jsx)("p",{dangerouslySetInnerHTML:{__html:W}})]}),(0,r.jsx)(g.Z,{children:(0,r.jsx)(m.Z,{"aria-label":"exit",size:"medium",children:(0,r.jsx)(c.default,{href:"/admin/bulletins/crops",passHref:!0,children:(0,r.jsx)(u.Z,{fontSize:"inherit"})})})})]}),(0,r.jsxs)(b.ZP,{item:!0,sx:H.Z.item,xs:12,lg:4,children:[(0,r.jsx)(h.Z,{variant:"h6",children:"Selection Options"}),(0,r.jsx)(d.Z,{disablePortal:!0,id:"province",size:"small",value:k.sel_province,disabled:0===E.length||Z,options:E,sx:H.Z.autocomplete,PaperComponent:v.Z,renderInput:function(e){return(0,r.jsx)(x.Z,N({},e,{label:Q()}))},getOptionDisabled:function(e){return e.disabled},isOptionEqualToValue:function(e,n){return e.label===n},onChange:function(e,n){return X(e,N({},n,{from:"province"}))}}),(0,r.jsx)(d.Z,{disablePortal:!0,id:"municipality",size:"small",value:k.sel_municipality,disabled:0===P.length||Z,options:P,sx:H.Z.autocomplete,PaperComponent:v.Z,renderInput:function(e){return(0,r.jsx)(x.Z,N({},e,{label:null===k.sel_municipality?"Select a municipality":"Municipality"}))},getOptionDisabled:function(e){return e.disabled||void 0!==e.iscalendar},isOptionEqualToValue:function(e,n){return e.label===n},onChange:function(e,n){X(e,N({},n,{from:"municipality"})),l(!1)}}),(0,r.jsxs)(f.Z,{disableElevation:!0,size:"small","aria-label":"outlined button controls group",disabled:O||null===k.sel_municipality||"-"===k.sel_crop,sx:{marginTop:"16px",float:"right"},children:[(0,r.jsx)(p.Z,{variant:"outlined",disabled:Z||O,onClick:U,children:"Reset"}),(0,r.jsx)(p.Z,{variant:"contained",onClick:function(){return l((function(e){return!e}))},disabled:Z||null===k.sel_month||0===_.length||t,children:"Generate"})]})]}),(0,r.jsx)(b.ZP,{item:!0,sx:H.Z.item,xs:12,lg:8,children:(0,r.jsx)(R.Z,{selecteditems:k,cropstages:_.map((function(e){return e.label})).toString().split(",").join(", "),farmoperations:T.map((function(e){return e.label})).toString().split(",").join(", "),loading:Z,reportType:"tenday"})})]}),(0,r.jsx)(L,{show:t,loading:Z,keyEng:"practice",keyTag:"practice_tagalog",formTitle:F,reportType:"tenday",options:k,smstext:I,isCreateDisabled:C,handlePreview:G,toggleViewerOpen:J,pdfPreview:V,handleSave:$})]})}W.propTypes={optsprovinces:s().array,optsmunicipalities:s().array,optscrops:s().array,optscropstages:s().array,optsactivities:s().array,sel_options:s().object,loading:s().bool,isloadingreport:s().bool,isdisabled:s().bool,open:s().bool,message:s().object,smstext:s().string,pageTitle:s().string,pageDescription:s().string,pdfPreview:s().object,onSelectItemChange:s().func,handlePreview:s().func,handleSave:s().func,toggleViewerOpen:s().func,resetSelections:s().func,togglePrompt:s().func};var V=W},4463:function(e,n,t){t.d(n,{Z:function(){return s}});var r=t(67294),i=t(77715),o=t(27179);function a(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function l(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return a(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return a(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=(0,r.useState)([]),c=s[0],u=s[1],d=(0,r.useState)(null),p=d[0],f=d[1],g=(0,r.useState)([]),b=g[0],m=g[1],x=(0,r.useState)(""),h=x[0],v=x[1],y=(0,r.useState)(""),j=y[0],w=y[1],S=function(e,n){return e.findIndex((function(e){return e.code===n}))>=0},Z=function(){u([]),m([]),f(null),v("")};return(0,r.useEffect)((function(){if(w(""),e&&n&&t.length>0&&e.length>0){var r=e[0].municipality;if(r===h)return;var s=l(t),c=new Date(n),d=(0,i.Mn)(c,a);try{var p={},g=[];s.forEach((function(n){void 0===p[n.label]&&(p[n.label]=[]);var t=0,r=0;Object.keys(d).forEach((function(i){var a=e.find((function(e){return e.crop===n.label}));if(!a)throw new Error("Cannot find cropping calendar for ".concat(n.label));var l=a[i];if(void 0===l||""===l)throw new Error("Crop stages data for ".concat(i," does not exist."));for(var s=l.split(","),c=0;c<d[i].length;c+=1)if(d[i][c]===o.Vs.FIRST_HALF)if(r+=1,s[0]!==o.HB){var u={id:p[n.label].length,label:o.ax[s[0]],code:s[0],municipality:a.municipality};p[n.label].push(u),S(g,s[0])||g.push(u)}else t+=1;else if(d[i][c]===o.Vs.SECOND_HALF)if(r+=1,s[1]!==o.HB){var f={id:p[n.label].length,label:o.ax[s[1]],code:s[1],municipality:a.municipality};p[n.label].push(f),S(g,s[1])||g.push(f)}else t+=1})),n.disabled=t===r})),v(r),f(p),u(s),m(g)}catch(b){Z(),w(b.message)}}0===e.length&&Z()}),[e,n,t,h,a]),{cropslist:c,cropstagesbycrop:p,uniquecropstages:b,error:j}}},94640:function(e,n,t){t.d(n,{Z:function(){return d}});var r=t(67294),i=t(9473),o=t(47426),a=t(56867),l=t(77715),s=t(901);function c(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function u(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return c(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return c(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,n){var t=(0,r.useState)([]),c=t[0],d=t[1],p=(0,r.useState)(null),f=p[0],g=p[1],b=(0,r.useState)(""),m=b[0],x=b[1],h=(0,r.useState)(""),v=h[0],y=h[1],j=(0,r.useState)(!1),w=j[0],S=j[1],Z=(0,i.I0)(),O=(0,i.v9)((function(e){return e.tendayweather})),C=O.ids,E=O.status,P=O.entities,_=O.error;return(0,r.useEffect)((function(){null!==e&&(x(""),y(""),Z((0,a.R)(e)))}),[e,Z]),(0,r.useEffect)((function(){x(_)}),[_]),(0,r.useEffect)((function(){S(E===s.G.PENDING)}),[E]),(0,r.useEffect)((function(){if(x(""),y(""),E===s.G.FULLFILLED&&C.length>0&&""===_&&null!==n){var e=Object.values(P).find((function(e){return e.municipality===n}));if(void 0!==e){var t,r,i=JSON.parse(e.data),a=Object.values(o.MW);d(i.reduce((function(e,n,o){var s,c,d;return u(e).concat([{id:o,label:n.day_format,label_full:null===(s=(0,l.Ay)(n.day_format,i[9].day_format))||void 0===s?void 0:s.toDateString(),rainfall:n.rainfall,forecast:null!==(t=null===(c=a.find((function(e){return e.tenday===n.rainfall})))||void 0===c?void 0:c.sync)&&void 0!==t?t:"-",code:null!==(r=null===(d=a.find((function(e){return e.tenday===n.rainfall})))||void 0===d?void 0:d.label)&&void 0!==r?r:"-"}])}),[]));var c=new Date(1e3*i[0].date_start.seconds),p=(0,l.Mn)(c);g({months:p,date_start:c,date_range:i[0].date_range})}else{var f=_||"Weather data for the municipality is not available at the moment, however, you can continue viewing recommendations. Please verify that the municipality name is present in the 10-Day weather forecast.";_?(d([]),g(null),x(f)):y(f)}}}),[n,P,C,E,_]),{days:c,summary:f,loading:w,error:m,warning:v}}}}]);